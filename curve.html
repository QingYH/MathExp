<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>空间解析几何曲面展示</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: url('https://example.com/math-bg.jpg') no-repeat center fixed;
            background-size: cover;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
        }
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }
        select, input, button {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        button:hover {
            background-color: #2980b9;
        }
        .canvas-container {
            position: relative;
            width: 100%;
            height: 600px;
            border: 2px solid #7f8c8d;
            border-radius: 8px;
            overflow: hidden;
        }
        canvas {
            display: block;
            background-color: #ecf0f1;
        }
        .instructions {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 5px solid #3498db;
        }
        .back-btn {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #e74c3c;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .back-btn:hover {
            background-color: #c0392b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>空间解析几何曲面交互展示</h1>
        
        <div class="control-panel">
            <div class="control-group">
                <label for="surface-type">曲面类型</label>
                <select id="surface-type">
                    <option value="sphere">球面</option>
                    <option value="cylinder">圆柱面</option>
                    <option value="cone">圆锥面</option>
                    <option value="hyperboloid">双曲面</option>
                    <option value="paraboloid">抛物面</option>
                    <option value="torus">环面</option>
                </select>
            </div>
            
            <div class="control-group" id="param-group">
                <!-- 动态生成的参数控件 -->
            </div>
            
            <div class="control-group">
                <label for="color">曲面颜色</label>
                <input type="color" id="color" value="#3498db">
                
                <label for="wireframe">显示网格</label>
                <select id="wireframe">
                    <option value="true">是</option>
                    <option value="false" selected>否</option>
                </select>
                
                <button id="draw-btn">绘制曲面</button>
            </div>
        </div>
        
        <div class="canvas-container">
            <canvas id="canvas"></canvas>
        </div>
        
        <div class="instructions">
            <h3>操作说明：</h3>
            <ul>
                <li><strong>旋转视图</strong>：鼠标左键拖动</li>
                <li><strong>缩放视图</strong>：鼠标滚轮</li>
                <li><strong>平移视图</strong>：鼠标右键拖动</li>
                <li><strong>重置视图</strong>：双击画布</li>
            </ul>
            <p>每个曲面都有可调整的参数，选择不同曲面类型后会出现相应的参数控件。</p>
        </div>
        
        <a href="javascript:history.back()" class="back-btn">返回上一页</a>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script>
        // 初始化Three.js场景
        const canvas = document.getElementById('canvas');
        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(canvas.parentElement.clientWidth, canvas.parentElement.clientHeight);
        renderer.setClearColor(0xecf0f1);
        
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
        camera.position.z = 5;
        
        const controls = new THREE.OrbitControls(camera, canvas);
        controls.enableDamping = true;
        controls.dampingFactor = 0.25;
        
        // 添加坐标轴辅助
        const axesHelper = new THREE.AxesHelper(3);
        scene.add(axesHelper);
        
        // 添加光源
        const ambientLight = new THREE.AmbientLight(0x404040);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);
        
        // 当前曲面对象
        let currentSurface = null;
        
        // 曲面参数控件模板
        const paramTemplates = {
            sphere: [
                { id: 'radius', label: '半径', type: 'range', min: 0.5, max: 5, step: 0.1, value: 2 }
            ],
            cylinder: [
                { id: 'radius', label: '底面半径', type: 'range', min: 0.5, max: 3, step: 0.1, value: 1 },
                { id: 'height', label: '高度', type: 'range', min: 1, max: 5, step: 0.1, value: 3 }
            ],
            cone: [
                { id: 'radius', label: '底面半径', type: 'range', min: 0.5, max: 3, step: 0.1, value: 1.5 },
                { id: 'height', label: '高度', type: 'range', min: 1, max: 5, step: 0.1, value: 3 }
            ],
            hyperboloid: [
                { id: 'a', label: '参数a', type: 'range', min: 0.5, max: 2, step: 0.1, value: 1 },
                { id: 'b', label: '参数b', type: 'range', min: 0.5, max: 2, step: 0.1, value: 1 },
                { id: 'c', label: '参数c', type: 'range', min: 0.5, max: 2, step: 0.1, value: 1 }
            ],
            paraboloid: [
                { id: 'a', label: '参数a', type: 'range', min: 0.1, max: 1, step: 0.05, value: 0.5 },
                { id: 'b', label: '参数b', type: 'range', min: 0.1, max: 1, step: 0.05, value: 0.5 }
            ],
            torus: [
                { id: 'radius', label: '主半径', type: 'range', min: 1, max: 3, step: 0.1, value: 2 },
                { id: 'tube', label: '管半径', type: 'range', min: 0.1, max: 1, step: 0.05, value: 0.5 }
            ]
        };
        
        // 曲面方程描述
        const surfaceEquations = {
            sphere: '球面方程: (x-x₀)² + (y-y₀)² + (z-z₀)² = r²',
            cylinder: '圆柱面方程: (x-x₀)² + (y-y₀)² = r²',
            cone: '圆锥面方程: z² = a²(x² + y²)',
            hyperboloid: '双曲面方程: x²/a² + y²/b² - z²/c² = 1',
            paraboloid: '抛物面方程: z = a x² + b y²',
            torus: '环面方程: (√(x² + y²) - R)² + z² = r²'
        };
        
        // 更新参数控件
        function updateParamControls() {
            const surfaceType = document.getElementById('surface-type').value;
            const paramGroup = document.getElementById('param-group');
            paramGroup.innerHTML = '<h3>曲面参数</h3>';
            
            paramTemplates[surfaceType].forEach(param => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <label for="${param.id}">${param.label}</label>
                    <input type="${param.type}" id="${param.id}" 
                           min="${param.min}" max="${param.max}" 
                           step="${param.step}" value="${param.value}">
                `;
                paramGroup.appendChild(div);
            });
            
            // 添加方程描述
            const eqDiv = document.createElement('div');
            eqDiv.style.marginTop = '10px';
            eqDiv.style.fontStyle = 'italic';
            eqDiv.textContent = surfaceEquations[surfaceType];
            paramGroup.appendChild(eqDiv);
        }
        
        // 绘制曲面
        function drawSurface() {
            const surfaceType = document.getElementById('surface-type').value;
            const color = document.getElementById('color').value;
            const wireframe = document.getElementById('wireframe').value === 'true';
            
            // 移除现有曲面
            if (currentSurface) {
                scene.remove(currentSurface);
            }
            
            // 创建材质
            const material = new THREE.MeshPhongMaterial({
                color: new THREE.Color(color),
                wireframe: wireframe,
                side: THREE.DoubleSide,
                shininess: 100
            });
            
            // 根据类型创建几何体
            let geometry;
            const params = {};
            paramTemplates[surfaceType].forEach(param => {
                params[param.id] = parseFloat(document.getElementById(param.id).value);
            });
            
            switch (surfaceType) {
                case 'sphere':
                    geometry = new THREE.SphereGeometry(params.radius, 32, 32);
                    break;
                case 'cylinder':
                    geometry = new THREE.CylinderGeometry(params.radius, params.radius, params.height, 32);
                    break;
                case 'cone':
                    geometry = new THREE.ConeGeometry(params.radius, params.height, 32);
                    break;
                case 'hyperboloid':
                    geometry = createHyperboloidGeometry(params.a, params.b, params.c);
                    break;
                case 'paraboloid':
                    geometry = createParaboloidGeometry(params.a, params.b);
                    break;
                case 'torus':
                    geometry = new THREE.TorusGeometry(params.radius, params.tube, 16, 32);
                    break;
            }
            
            currentSurface = new THREE.Mesh(geometry, material);
            scene.add(currentSurface);
        }
        
        // 创建双曲面几何体
        function createHyperboloidGeometry(a, b, c) {
            const geometry = new THREE.ParametricGeometry((u, v, target) => {
                u = u * Math.PI * 2;
                v = (v - 0.5) * Math.PI;
                
                const x = a * Math.cosh(v) * Math.cos(u);
                const y = b * Math.cosh(v) * Math.sin(u);
                const z = c * Math.sinh(v);
                
                target.set(x, y, z);
            }, 50, 50);
            
            return geometry;
        }
        
        // 创建抛物面几何体
        function createParaboloidGeometry(a, b) {
            const geometry = new THREE.ParametricGeometry((u, v, target) => {
                u = (u - 0.5) * 4;
                v = (v - 0.5) * 4;
                
                const x = u;
                const y = v;
                const z = a * u * u + b * v * v;
                
                target.set(x, y, z);
            }, 50, 50);
            
            return geometry;
        }
        
        // 窗口大小调整
        window.addEventListener('resize', () => {
            const width = canvas.parentElement.clientWidth;
            const height = canvas.parentElement.clientHeight;
            
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        });
        
        // 双击重置视图
        canvas.addEventListener('dblclick', () => {
            controls.reset();
        });
        
        // 初始化控件
        document.getElementById('surface-type').addEventListener('change', updateParamControls);
        document.getElementById('draw-btn').addEventListener('click', drawSurface);
        
        // 初始状态
        updateParamControls();
        drawSurface();
        
        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        
        animate();
    </script>
</body>
</html>

