<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ•°ç¬¬ä¸€ç« ï¼šæé™ä¸è¿ç»­ - å®Œæ•´äº¤äº’å¼å­¦ä¹ ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #4285f4;
            --secondary: #0f9d58;
            --accent: #ff4081;
            --dark: #202124;
            --light: #f8f9fa;
            --gray: #6c757d;
            --warning: #ff9800;
            --danger: #dc3545;
            --success: #28a745;
            --info: #17a2b8;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, #673ab7 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .math-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            font-size: 2.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            pointer-events: none;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .emoji {
            font-size: 2rem;
            vertical-align: middle;
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }
        
        /* ä¸»è¦å†…å®¹åŒº */
        .main-content {
            flex: 1;
            min-width: 0; /* é˜²æ­¢å†…å®¹æº¢å‡º */
        }
        
        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 320px;
            flex-shrink: 0;
        }
        
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
        }
        
        /* çŸ¥è¯†ç‚¹ç« èŠ‚æ ·å¼ */
        .graph-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-left: 5px solid var(--primary);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .graph-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
        }
        
        .graph-section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .marker-anchor {
            position: relative;
            top: -80px;
            visibility: hidden;
        }
        
        /* çŸ¥è¯†å¡ç‰‡ */
        .knowledge-card {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid var(--secondary);
        }
        
        .knowledge-card h3 {
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .formula-box {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            font-family: 'Cambria Math', serif;
            overflow-x: auto;
        }
        
        /* å›¾å½¢å®¹å™¨ */
        .graph-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid #dee2e6;
        }
        
        .graph-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .graph-display-area {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .graph-canvas-container {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        }
        
        canvas {
            display: block;
            border-radius: 5px;
            background: white;
            width: 100%;
            height: 250px;
        }
        
        .graph-info {
            flex: 0 0 200px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .info-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .info-label {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        /* æ»‘å—æ§ä»¶ */
        .slider-container {
            margin-bottom: 20px;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #dee2e6;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .graph-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .control-btn, .animation-btn, .link-btn, .game-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .control-btn {
            background: linear-gradient(135deg, var(--primary) 0%, #3367d6 100%);
            color: white;
            flex: 1;
            min-width: 150px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }
        
        .animation-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, #0b8043 100%);
            color: white;
            flex: 2;
        }
        
        .animation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(15, 157, 88, 0.3);
        }
        
        /* ä¾§è¾¹æ ç»„ä»¶ */
        .progress-container, .quick-links, .game-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .progress-title, .quick-links-title, .game-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--secondary), var(--primary));
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .links-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .link-btn {
            background: #f8f9fa;
            color: var(--dark);
            border: 1px solid #dee2e6;
        }
        
        .link-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        .game-btn {
            background: linear-gradient(135deg, var(--warning) 0%, #f57c00 100%);
            color: white;
            width: 100%;
        }
        
        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }
        
        .game-exit-btn {
            background: var(--danger);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        /* æ¸¸æˆæ¨¡æ€æ¡† */
        .game-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .game-modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        /* è¾…åŠ©ç±» */
        .highlight {
            color: var(--accent);
            font-weight: bold;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .graph-display-area {
                flex-direction: column;
            }
            
            .graph-info {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .info-item {
                flex: 1;
                min-width: 120px;
            }
            
            .graph-controls {
                flex-direction: column;
            }
            
            .control-btn, .animation-btn {
                min-width: 100%;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .graph-section h2 {
                font-size: 1.5rem;
            }
        }
        
        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #3367d6;
        }
    </style>
</head>
<body onload="init()">
    <header>
        <div class="math-bg" id="mathBg">
            lim âˆ« âˆ‘ âˆ âˆš âˆ Ï€ Îµ Î´ âˆ‚ âˆ‡ â†’ â† â†‘ â†“ â†” âˆ´ âˆµ âˆ€ âˆƒ âˆˆ âˆ‰ âŠ‚ âŠƒ âˆª âˆ© âˆ…
        </div>
        <h1>é«˜ç­‰æ•°å­¦ç¬¬ä¸€ç« ï¼šæé™ä¸è¿ç»­ <span class="emoji">ğŸš€</span></h1>
        <p class="subtitle">äº¤äº’å¼å­¦ä¹ ç³»ç»Ÿ - ä»å…¥é—¨åˆ°ç²¾é€š</p>
        <p style="margin-top:15px; font-size:1rem; opacity:0.9; max-width:800px; margin-left:auto; margin-right:auto;">
            é€šè¿‡åŠ¨æ€å›¾å½¢ã€äº¤äº’ç»ƒä¹ å’Œæ¸¸æˆåŒ–å­¦ä¹ ï¼Œè®©æŠ½è±¡çš„é«˜æ•°æ¦‚å¿µå˜å¾—ç›´è§‚æ˜“æ‡‚
        </p>
    </header>
    
    <div class="container">
        <main class="main-content">
            <!-- å¯¼èˆªèœå• -->
            <div class="graph-section" style="text-align: center;">
                <h2><i class="fas fa-compass"></i> çŸ¥è¯†ç‚¹å¯¼èˆª</h2>
                <div class="graph-controls" style="background: transparent; border: none; padding: 0;">
                    <button class="control-btn" onclick="scrollToSection('mapping-function')">
                        <i class="fas fa-project-diagram"></i> æ˜ å°„ä¸å‡½æ•°
                    </button>
                    <button class="control-btn" onclick="scrollToSection('sequence-limit')">
                        <i class="fas fa-sort-numeric-down"></i> æ•°åˆ—æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('function-limit')">
                        <i class="fas fa-bullseye"></i> å‡½æ•°æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('limit-criteria')">
                        <i class="fas fa-filter"></i> æé™å‡†åˆ™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('limit-operations')">
                        <i class="fas fa-calculator"></i> æé™è¿ç®—
                    </button>
                    <button class="control-btn" onclick="scrollToSection('important-limits')">
                        <i class="fas fa-star"></i> é‡è¦æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('infinitesimal-comparison')">
                        <i class="fas fa-balance-scale-left"></i> æ— ç©·å°æ¯”è¾ƒ
                    </button>
                    <button class="control-btn" onclick="scrollToSection('continuity')">
                        <i class="fas fa-link"></i> è¿ç»­æ€§
                    </button>
                    <button class="control-btn" onclick="scrollToSection('continuous-operations')">
                        <i class="fas fa-cogs"></i> è¿ç»­è¿ç®—
                    </button>
                    <button class="control-btn" onclick="scrollToSection('closed-interval')">
                        <i class="fas fa-expand-arrows-alt"></i> é—­åŒºé—´æ€§è´¨
                    </button>
                </div>
            </div>
            
            <!-- ä¸€ã€æ˜ å°„ä¸å‡½æ•° -->
            <section id="mapping-function" class="graph-section">
                <div class="marker-anchor" id="mapping-function-anchor"></div>
                <h2><i class="fas fa-project-diagram"></i> ä¸€ã€æ˜ å°„ä¸å‡½æ•°</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>æ˜ å°„ï¼š</strong>è®¾Xã€Yæ˜¯ä¸¤ä¸ªéç©ºé›†åˆï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ³•åˆ™fï¼Œä½¿å¾—å¯¹Xä¸­æ¯ä¸ªå…ƒç´ xï¼ŒæŒ‰æ³•åˆ™fï¼Œåœ¨Yä¸­æœ‰å”¯ä¸€ç¡®å®šçš„å…ƒç´ yä¸ä¹‹å¯¹åº”ï¼Œåˆ™ç§°fä¸ºä»Xåˆ°Yçš„æ˜ å°„ã€‚</p>
                    <p><strong>å‡½æ•°ï¼š</strong>å®šä¹‰åŸŸå’Œå€¼åŸŸéƒ½æ˜¯å®æ•°é›†çš„æ˜ å°„ç§°ä¸ºå‡½æ•°ã€‚</p>
                    
                    <div class="formula-box">
                        $$ f: X \rightarrow Y, \quad x \mapsto y = f(x) $$
                        $$ \text{å®šä¹‰åŸŸ: } D_f = X, \quad \text{å€¼åŸŸ: } R_f = \{f(x) | x \in X\} $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¯ å‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="domainCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueDomain">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="funcValueDomain">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">åœ¨å®šä¹‰åŸŸå†…ï¼Ÿ</div>
                                <div class="info-value" id="inDomain">æ˜¯</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å®šä¹‰åŸŸèŒƒå›´</div>
                                <div class="info-value" id="domainRange">[-2,1)âˆª(1,âˆ)</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xSliderValue">0.0</span></span>
                            <span>å½“å‰å‡½æ•°: <span id="currentFunction">f(x)=âˆš(x+2)/(x-1)</span></span>
                        </div>
                        <input type="range" min="-30" max="30" value="0" class="slider" id="domainSlider" oninput="updateDomainGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeDomainFunction(1)">
                            <i class="fas fa-chart-line"></i> f(x)=âˆš(x+2)/(x-1)
                        </button>
                        <button class="control-btn" onclick="changeDomainFunction(2)">
                            <i class="fas fa-chart-line"></i> f(x)=1/(x-2)
                        </button>
                        <button class="control-btn" onclick="changeDomainFunction(3)">
                            <i class="fas fa-chart-line"></i> f(x)=ln(x)
                        </button>
                        <button class="animation-btn" onclick="startDomainAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºå®šä¹‰åŸŸ
                        </button>
                    </div>
                </div>
                
                <!-- å‡½æ•°ç±»å‹ç¤ºä¾‹ -->
                <div class="knowledge-card">
                    <h3><i class="fas fa-bezier-curve"></i> å‡½æ•°ç±»å‹</h3>
                    <p><strong>å¥‡å¶æ€§ï¼š</strong>å¥‡å‡½æ•° f(-x) = -f(x)ï¼Œå¶å‡½æ•° f(-x) = f(x)</p>
                    <p><strong>å‘¨æœŸæ€§ï¼š</strong>å­˜åœ¨Tâ‰ 0ä½¿å¾—f(x+T)=f(x)</p>
                    <p><strong>å•è°ƒæ€§ï¼š</strong>åœ¨åŒºé—´Iä¸Šå•è°ƒé€’å¢æˆ–é€’å‡</p>
                    
                    <div class="formula-box">
                        $$ \text{å¥‡å‡½æ•°: } f(-x) = -f(x), \quad \text{å¶å‡½æ•°: } f(-x) = f(x) $$
                        $$ \text{å‘¨æœŸå‡½æ•°: } \exists T \neq 0, f(x+T) = f(x) \quad \forall x $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°ç±»å‹å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“Š å‡½æ•°ç±»å‹å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="functionTypeCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å‡½æ•°ç±»å‹</div>
                                <div class="info-value" id="functionTypeName">å¥‡å‡½æ•°</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="funcValueType">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(-x)å€¼</div>
                                <div class="info-value" id="funcNegValue">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å¥‡å¶éªŒè¯</div>
                                <div class="info-value" id="parityCheck">é€šè¿‡</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xTypeSliderValue">0.0</span></span>
                            <span>å‚ç›´æµ‹è¯•: <span id="verticalTestStatus">å¼€å¯</span></span>
                        </div>
                        <input type="range" min="-30" max="30" value="0" class="slider" id="functionTypeSlider" oninput="updateFunctionTypeGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeFunctionType(1)">
                            <i class="fas fa-sync-alt"></i> f(x)=xÂ³ (å¥‡å‡½æ•°)
                        </button>
                        <button class="control-btn" onclick="changeFunctionType(2)">
                            <i class="fas fa-expand-arrows-alt"></i> f(x)=xÂ² (å¶å‡½æ•°)
                        </button>
                        <button class="control-btn" onclick="changeFunctionType(3)">
                            <i class="fas fa-redo"></i> f(x)=sin(x) (å‘¨æœŸå‡½æ•°)
                        </button>
                        <button class="control-btn" onclick="toggleVerticalTest()">
                            <i class="fas fa-eye"></i> åˆ‡æ¢å‚ç›´æµ‹è¯•
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- äºŒã€æ•°åˆ—æé™ -->
            <section id="sequence-limit" class="graph-section">
                <div class="marker-anchor" id="sequence-limit-anchor"></div>
                <h2><i class="fas fa-sort-numeric-down"></i> äºŒã€æ•°åˆ—æé™</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>æ•°åˆ—æé™ï¼š</strong>å½“næ— é™å¢å¤§æ—¶ï¼Œæ•°åˆ—{aâ‚™}æ— é™æ¥è¿‘äºæŸä¸ªç¡®å®šçš„å¸¸æ•°Aã€‚</p>
                    <p><strong>Îµ-Nè¯­è¨€ï¼š</strong>âˆ€Îµ>0, âˆƒN>0, å½“n>Næ—¶ï¼Œ|aâ‚™-A| < Îµã€‚</p>
                    
                    <div class="formula-box">
                        $$ \lim_{n \to \infty} a_n = A \iff \forall \varepsilon > 0, \exists N > 0, \text{å½“} n > N \text{æ—¶}, |a_n - A| < \varepsilon $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæ•°åˆ—æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“ˆ æ•°åˆ—æé™å¯è§†åŒ–ï¼šaâ‚™ = 1 + 1/n</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="sequenceCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰nå€¼</div>
                                <div class="info-value" id="nValue">1</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">aâ‚™å€¼</div>
                                <div class="info-value" id="anValue">2.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æé™A</div>
                                <div class="info-value" id="limitA">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">|aâ‚™-A|</div>
                                <div class="info-value" id="differenceValue">1.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´nå€¼: <span id="nSliderValue">1</span></span>
                            <span>è°ƒæ•´Îµå€¼: <span id="epsilonValue">0.5</span></span>
                        </div>
                        <input type="range" min="1" max="50" value="1" class="slider" id="sequenceSlider" oninput="updateSequenceGraph()">
                        <input type="range" min="1" max="20" value="5" class="slider" id="epsilonSlider" oninput="updateSequenceGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeSequence(1)">
                            <i class="fas fa-chart-line"></i> aâ‚™ = 1 + 1/n
                        </button>
                        <button class="control-btn" onclick="changeSequence(2)">
                            <i class="fas fa-chart-line"></i> aâ‚™ = (n-1)/n
                        </button>
                        <button class="control-btn" onclick="changeSequence(3)">
                            <i class="fas fa-chart-line"></i> aâ‚™ = (-1)â¿/n
                        </button>
                        <button class="animation-btn" onclick="startSequenceAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºæé™è¿‡ç¨‹
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- ä¸‰ã€å‡½æ•°æé™ -->
            <section id="function-limit" class="graph-section">
                <div class="marker-anchor" id="function-limit-anchor"></div>
                <h2><i class="fas fa-bullseye"></i> ä¸‰ã€å‡½æ•°æé™</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>å‡½æ•°æé™ï¼š</strong>å½“è‡ªå˜é‡xæ— é™æ¥è¿‘äºxâ‚€æ—¶ï¼Œå‡½æ•°å€¼f(x)æ— é™æ¥è¿‘äºæŸä¸ªç¡®å®šçš„å¸¸æ•°Aã€‚</p>
                    <p><strong>Îµ-Î´è¯­è¨€ï¼š</strong>âˆ€Îµ>0, âˆƒÎ´>0, å½“0 < |x-xâ‚€| < Î´æ—¶ï¼Œ|f(x)-A| < Îµã€‚</p>
                    
                    <div class="formula-box">
                        $$ \lim_{x \to x_0} f(x) = A \iff \forall \varepsilon > 0, \exists \delta > 0, \text{å½“} 0 < |x-x_0| < \delta \text{æ—¶}, |f(x) - A| < \varepsilon $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¯ å‡½æ•°æé™å¯è§†åŒ–ï¼šf(x) = xÂ² å½“ xâ†’2</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="functionLimitCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueLimit">2.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fxValueLimit">4.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æé™A</div>
                                <div class="info-value" id="limitValue">4.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">|f(x)-A|</div>
                                <div class="info-value" id="limitDiffValue">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xLimitSliderValue">2.0</span></span>
                            <span>è°ƒæ•´Îµå€¼: <span id="epsilonLimitValue">0.5</span></span>
                        </div>
                        <input type="range" min="0" max="40" value="20" class="slider" id="xLimitSlider" oninput="updateFunctionLimitGraph()">
                        <input type="range" min="1" max="20" value="10" class="slider" id="epsilonLimitSlider" oninput="updateFunctionLimitGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeFunctionLimit(1)">
                            <i class="fas fa-chart-line"></i> f(x) = xÂ² (xâ†’2)
                        </button>
                        <button class="control-btn" onclick="changeFunctionLimit(2)">
                            <i class="fas fa-chart-line"></i> f(x) = (xÂ²-1)/(x-1) (xâ†’1)
                        </button>
                        <button class="control-btn" onclick="changeFunctionLimit(3)">
                            <i class="fas fa-chart-line"></i> f(x) = sin(1/x) (xâ†’0)
                        </button>
                        <button class="animation-btn" onclick="startFunctionLimitAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºæé™è¿‡ç¨‹
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- å››ã€æé™å‡†åˆ™ -->
            <section id="limit-criteria" class="graph-section">
                <div class="marker-anchor" id="limit-criteria-anchor"></div>
                <h2><i class="fas fa-filter"></i> å››ã€æé™å‡†åˆ™</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>å¤¹é€¼å‡†åˆ™ï¼ˆä¸‰æ˜æ²»å®šç†ï¼‰ï¼š</strong>å¦‚æœå‡½æ•°g(x)â‰¤f(x)â‰¤h(x)ï¼Œä¸”lim g(x)=lim h(x)=Aï¼Œåˆ™lim f(x)=Aã€‚</p>
                    <p><strong>å•è°ƒæœ‰ç•Œå‡†åˆ™ï¼š</strong>å•è°ƒæœ‰ç•Œæ•°åˆ—å¿…æœ‰æé™ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{å¤¹é€¼å‡†åˆ™: } g(x) \le f(x) \le h(x) \text{ ä¸” } \lim g(x) = \lim h(x) = A \Rightarrow \lim f(x) = A $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå¤¹é€¼å‡†åˆ™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¥ª å¤¹é€¼å‡†åˆ™å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="squeezeCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueSqueeze">0.5</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">g(x)å€¼</div>
                                <div class="info-value" id="gxValue">0.25</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fxValueSqueeze">0.35</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">h(x)å€¼</div>
                                <div class="info-value" id="hxValue">0.50</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xSqueezeSliderValue">0.5</span></span>
                            <span>æé™å€¼: <span id="squeezeLimit">0</span></span>
                        </div>
                        <input type="range" min="1" max="100" value="50" class="slider" id="squeezeSlider" oninput="updateSqueezeGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeSqueezeFunction(1)">
                            <i class="fas fa-bullseye"></i> x sin(1/x) è¢«å¤¹é€¼
                        </button>
                        <button class="control-btn" onclick="changeSqueezeFunction(2)">
                            <i class="fas fa-bullseye"></i> (xÂ²+1)/(xÂ²+2) è¢«å¤¹é€¼
                        </button>
                        <button class="control-btn" onclick="changeSqueezeFunction(3)">
                            <i class="fas fa-bullseye"></i> sin(x)/x è¢«å¤¹é€¼
                        </button>
                        <button class="animation-btn" onclick="startSqueezeAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºå¤¹é€¼è¿‡ç¨‹
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- äº”ã€æé™è¿ç®— -->
            <section id="limit-operations" class="graph-section">
                <div class="marker-anchor" id="limit-operations-anchor"></div>
                <h2><i class="fas fa-calculator"></i> äº”ã€æé™è¿ç®—</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>å››åˆ™è¿ç®—æ³•åˆ™ï¼š</strong>è‹¥lim f(x)=A, lim g(x)=Bï¼Œåˆ™ï¼š</p>
                    <p>1. lim[f(x)Â±g(x)] = AÂ±B</p>
                    <p>2. lim[f(x)Â·g(x)] = AÂ·B</p>
                    <p>3. lim[f(x)/g(x)] = A/B (Bâ‰ 0)</p>
                    
                    <div class="formula-box">
                        $$ \text{è‹¥ } \lim f(x) = A, \lim g(x) = B \text{ï¼Œåˆ™ï¼š} $$
                        $$ \lim [f(x) \pm g(x)] = A \pm B, \quad \lim [f(x) \cdot g(x)] = A \cdot B, \quad \lim \frac{f(x)}{g(x)} = \frac{A}{B} (B \neq 0) $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæé™è¿ç®—å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ§® æé™è¿ç®—å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="limitOperationsCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">è¿ç®—ç±»å‹</div>
                                <div class="info-value" id="operationType">åŠ æ³•</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim f(x)</div>
                                <div class="info-value" id="limitF">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim g(x)</div>
                                <div class="info-value" id="limitG">0.5</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim [f(x) op g(x)]</div>
                                <div class="info-value" id="limitResult">1.5</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xOpSliderValue">1.0</span></span>
                            <span>è¶‹è¿‘ç‚¹: <span id="approachPoint">xâ†’2</span></span>
                        </div>
                        <input type="range" min="10" max="190" value="100" class="slider" id="limitOpSlider" oninput="updateLimitOperationsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeLimitOperation(1)">
                            <i class="fas fa-plus"></i> åŠ æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(2)">
                            <i class="fas fa-minus"></i> å‡æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(3)">
                            <i class="fas fa-times"></i> ä¹˜æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(4)">
                            <i class="fas fa-divide"></i> é™¤æ³•è¿ç®—
                        </button>
                        <button class="animation-btn" onclick="startLimitOpAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºè¿ç®—è¿‡ç¨‹
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- å…­ã€é‡è¦æé™ -->
            <section id="important-limits" class="graph-section">
                <div class="marker-anchor" id="important-limits-anchor"></div>
                <h2><i class="fas fa-star"></i> å…­ã€é‡è¦æé™</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>ç¬¬ä¸€ä¸ªé‡è¦æé™ï¼š</strong>$$ \lim_{x \to 0} \frac{\sin x}{x} = 1 $$</p>
                    <p><strong>ç¬¬äºŒä¸ªé‡è¦æé™ï¼š</strong>$$ \lim_{x \to \infty} \left(1 + \frac{1}{x}\right)^x = e $$</p>
                    
                    <div class="formula-box">
                        $$ \text{é‡è¦æé™1: } \lim_{x \to 0} \frac{\sin x}{x} = 1 $$
                        $$ \text{é‡è¦æé™2: } \lim_{x \to \infty} \left(1 + \frac{1}{x}\right)^x = e $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šé‡è¦æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">â­ é‡è¦æé™å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="importantLimitsCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">æé™ç±»å‹</div>
                                <div class="info-value" id="importantLimitType">ç¬¬ä¸€ä¸ªé‡è¦æé™</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å½“å‰å€¼</div>
                                <div class="info-value" id="importantLimitValue">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æé™å€¼</div>
                                <div class="info-value" id="importantLimitResult">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å·®å€¼</div>
                                <div class="info-value" id="importantLimitDiff">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xImportantSliderValue">0.1</span></span>
                            <span>æé™å€¼: <span id="importantLimitTarget">1æˆ–e</span></span>
                        </div>
                        <input type="range" min="1" max="100" value="10" class="slider" id="importantLimitsSlider" oninput="updateImportantLimitsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeImportantLimit(1)">
                            <i class="fas fa-sync-alt"></i> lim sin(x)/x = 1
                        </button>
                        <button class="control-btn" onclick="changeImportantLimit(2)">
                            <i class="fas fa-chart-line"></i> lim (1+1/x)Ë£ = e
                        </button>
                        <button class="control-btn" onclick="changeImportantLimit(3)">
                            <i class="fas fa-chart-line"></i> lim (1+x)^{1/x} = e
                        </button>
                        <button class="animation-btn" onclick="startImportantLimitsAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºæé™è¶‹è¿‘
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- ä¸ƒã€æ— ç©·å°æ¯”è¾ƒ -->
            <section id="infinitesimal-comparison" class="graph-section">
                <div class="marker-anchor" id="infinitesimal-comparison-anchor"></div>
                <h2><i class="fas fa-balance-scale-left"></i> ä¸ƒã€æ— ç©·å°æ¯”è¾ƒ</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>æ— ç©·å°çš„é˜¶ï¼š</strong>è®¾Î±,Î²æ˜¯åŒä¸€å˜åŒ–è¿‡ç¨‹ä¸­çš„æ— ç©·å°ï¼š</p>
                    <p>1. å¦‚æœlim Î²/Î± = 0ï¼Œåˆ™Î²æ˜¯Î±çš„é«˜é˜¶æ— ç©·å°</p>
                    <p>2. å¦‚æœlim Î²/Î± = âˆï¼Œåˆ™Î²æ˜¯Î±çš„ä½é˜¶æ— ç©·å°</p>
                    <p>3. å¦‚æœlim Î²/Î± = c â‰  0ï¼Œåˆ™Î²ä¸Î±æ˜¯åŒé˜¶æ— ç©·å°</p>
                    <p>4. å¦‚æœlim Î²/Î± = 1ï¼Œåˆ™Î²ä¸Î±æ˜¯ç­‰ä»·æ— ç©·å°</p>
                    
                    <div class="formula-box">
                        $$ \text{è®¾ } \alpha, \beta \to 0: $$
                        $$ \text{é«˜é˜¶: } \lim \frac{\beta}{\alpha} = 0 \ (\beta = o(\alpha)) $$
                        $$ \text{ç­‰ä»·: } \lim \frac{\beta}{\alpha} = 1 \ (\beta \sim \alpha) $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæ— ç©·å°æ¯”è¾ƒå¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">âš–ï¸ æ— ç©·å°æ¯”è¾ƒå¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="infinitesimalCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueInfinitesimal">0.1</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Î±(x)å€¼</div>
                                <div class="info-value" id="alphaValue">0.100</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Î²(x)å€¼</div>
                                <div class="info-value" id="betaValue">0.010</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Î²/Î±æ¯”å€¼</div>
                                <div class="info-value" id="ratioValue">0.100</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xInfinitesimalSliderValue">0.1</span></span>
                            <span>æ¯”è¾ƒç±»å‹: <span id="comparisonType">é«˜é˜¶æ— ç©·å°</span></span>
                        </div>
                        <input type="range" min="1" max="100" value="10" class="slider" id="infinitesimalSlider" oninput="updateInfinitesimalGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeInfinitesimalComparison(1)">
                            <i class="fas fa-arrow-up"></i> Î² = xÂ² (Î± = xçš„é«˜é˜¶)
                        </button>
                        <button class="control-btn" onclick="changeInfinitesimalComparison(2)">
                            <i class="fas fa-equals"></i> Î² = 3x (Î± = xçš„åŒé˜¶)
                        </button>
                        <button class="control-btn" onclick="changeInfinitesimalComparison(3)">
                            <i class="fas fa-exchange-alt"></i> Î² = sin x (Î± = xçš„ç­‰ä»·)
                        </button>
                        <button class="animation-btn" onclick="startInfinitesimalAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºè¶‹è¿‘è¿‡ç¨‹
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- å…«ã€è¿ç»­æ€§ -->
            <section id="continuity" class="graph-section">
                <div class="marker-anchor" id="continuity-anchor"></div>
                <h2><i class="fas fa-link"></i> å…«ã€è¿ç»­æ€§</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>è¿ç»­çš„å®šä¹‰ï¼š</strong>å‡½æ•°f(x)åœ¨ç‚¹xâ‚€è¿ç»­ â‡” lim f(x) = f(xâ‚€) (xâ†’xâ‚€)</p>
                    <p><strong>é—´æ–­ç‚¹ç±»å‹ï¼š</strong>ç¬¬ä¸€ç±»ï¼ˆå¯å»ã€è·³è·ƒï¼‰å’Œç¬¬äºŒç±»é—´æ–­ç‚¹</p>
                    
                    <div class="formula-box">
                        $$ f(x) \text{ åœ¨ } x_0 \text{ è¿ç»­ } \iff \lim_{x \to x_0} f(x) = f(x_0) $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šè¿ç»­æ€§å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ”— è¿ç»­æ€§å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="continuityCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueContinuity">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fxValueContinuity">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">åœ¨xâ‚€è¿ç»­ï¼Ÿ</div>
                                <div class="info-value" id="isContinuous">æ˜¯</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">é—´æ–­ç‚¹ç±»å‹</div>
                                <div class="info-value" id="discontinuityType">æ— </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xContinuitySliderValue">0.0</span></span>
                            <span>æ£€æŸ¥ç‚¹xâ‚€: <span id="checkPoint">0</span></span>
                        </div>
                        <input type="range" min="-50" max="50" value="0" class="slider" id="continuitySlider" oninput="updateContinuityGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeContinuityFunction(1)">
                            <i class="fas fa-chart-line"></i> f(x)=xÂ² (è¿ç»­)
                        </button>
                        <button class="control-btn" onclick="changeContinuityFunction(2)">
                            <i class="fas fa-chart-line"></i> f(x)=1/x (x=0é—´æ–­)
                        </button>
                        <button class="control-btn" onclick="changeContinuityFunction(3)">
                            <i class="fas fa-chart-line"></i> åˆ†æ®µå‡½æ•° (å¯å»é—´æ–­)
                        </button>
                        <button class="animation-btn" onclick="startContinuityAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºè¿ç»­æ€§
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- ä¹ã€è¿ç»­è¿ç®— -->
            <section id="continuous-operations" class="graph-section">
                <div class="marker-anchor" id="continuous-operations-anchor"></div>
                <h2><i class="fas fa-cogs"></i> ä¹ã€è¿ç»­è¿ç®—</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>è¿ç»­å‡½æ•°çš„è¿ç®—ï¼š</strong></p>
                    <p>1. è¿ç»­å‡½æ•°çš„å’Œã€å·®ã€ç§¯ã€å•†ï¼ˆåˆ†æ¯ä¸ä¸ºé›¶ï¼‰ä»æ˜¯è¿ç»­å‡½æ•°</p>
                    <p>2. è¿ç»­å‡½æ•°çš„å¤åˆå‡½æ•°ä»æ˜¯è¿ç»­å‡½æ•°</p>
                    <p><strong>åˆç­‰å‡½æ•°è¿ç»­æ€§ï¼š</strong>æ‰€æœ‰åˆç­‰å‡½æ•°åœ¨å…¶å®šä¹‰åŒºé—´å†…è¿ç»­ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{è‹¥ } f(x), g(x) \text{ åœ¨ } x_0 \text{ è¿ç»­ï¼Œåˆ™ï¼š} $$
                        $$ f(x) \pm g(x), \quad f(x) \cdot g(x), \quad \frac{f(x)}{g(x)} (g(x_0) \neq 0) \text{ åœ¨ } x_0 \text{ è¿ç»­} $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šè¿ç»­è¿ç®—å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">âš™ï¸ è¿ç»­è¿ç®—å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="continuousOperationsCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">è¿ç®—ç±»å‹</div>
                                <div class="info-value" id="continuousOpType">åŠ æ³•</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fValueContinuous">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">g(x)å€¼</div>
                                <div class="info-value" id="gValueContinuous">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f op gå€¼</div>
                                <div class="info-value" id="resultValueContinuous">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xContinuousSliderValue">0.0</span></span>
                            <span>è¿ç»­ç‚¹: <span id="continuousPoint">x=0</span></span>
                        </div>
                        <input type="range" min="-50" max="50" value="0" class="slider" id="continuousOperationsSlider" oninput="updateContinuousOperationsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeContinuousOperation(1)">
                            <i class="fas fa-plus"></i> è¿ç»­å‡½æ•°ç›¸åŠ 
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(2)">
                            <i class="fas fa-times"></i> è¿ç»­å‡½æ•°ç›¸ä¹˜
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(3)">
                            <i class="fas fa-sitemap"></i> è¿ç»­å‡½æ•°å¤åˆ
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(4)">
                            <i class="fas fa-divide"></i> è¿ç»­å‡½æ•°ç›¸é™¤
                        </button>
                        <button class="animation-btn" onclick="startContinuousOpAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºè¿ç®—
                        </button>
                    </div>
                </div>
                
            </section>
            
            <!-- åã€é—­åŒºé—´æ€§è´¨ -->
            <section id="closed-interval" class="graph-section">
                <div class="marker-anchor" id="closed-interval-anchor"></div>
                <h2><i class="fas fa-expand-arrows-alt"></i> åã€é—­åŒºé—´ä¸Šè¿ç»­å‡½æ•°çš„æ€§è´¨</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <p><strong>æœ‰ç•Œæ€§å®šç†ï¼š</strong>é—­åŒºé—´[a,b]ä¸Šçš„è¿ç»­å‡½æ•°åœ¨è¯¥åŒºé—´ä¸Šæœ‰ç•Œã€‚</p>
                    <p><strong>æœ€å€¼å®šç†ï¼š</strong>é—­åŒºé—´[a,b]ä¸Šçš„è¿ç»­å‡½æ•°åœ¨è¯¥åŒºé—´ä¸Šä¸€å®šèƒ½å–å¾—æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</p>
                    <p><strong>é›¶ç‚¹å®šç†ï¼š</strong>è‹¥f(a)ä¸f(b)å¼‚å·ï¼Œåˆ™å­˜åœ¨câˆˆ(a,b)ä½¿å¾—f(c)=0ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{æœ€å€¼å®šç†: } f \in C[a,b] \Rightarrow \exists x_1, x_2 \in [a,b], f(x_1) = \min_{[a,b]} f, f(x_2) = \max_{[a,b]} f $$
                        $$ \text{é›¶ç‚¹å®šç†: } f \in C[a,b], f(a)f(b) < 0 \Rightarrow \exists c \in (a,b), f(c) = 0 $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šé—­åŒºé—´æ€§è´¨å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“ é—­åŒºé—´æ€§è´¨å¯è§†åŒ–</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="closedIntervalCanvas" width="500" height="250"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">åŒºé—´[a,b]</div>
                                <div class="info-value" id="intervalValue">[0, 2Ï€]</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æœ€å°å€¼</div>
                                <div class="info-value" id="minValue">-1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æœ€å¤§å€¼</div>
                                <div class="info-value" id="maxValue">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">é›¶ç‚¹</div>
                                <div class="info-value" id="zeroPoints">0, Ï€, 2Ï€</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>åŒºé—´å·¦ç«¯ç‚¹a: <span id="intervalASliderValue">0</span></span>
                            <span>åŒºé—´å³ç«¯ç‚¹b: <span id="intervalBSliderValue">6.28</span></span>
                        </div>
                        <input type="range" min="0" max="100" value="0" class="slider" id="intervalASlider" oninput="updateClosedIntervalGraph()">
                        <input type="range" min="0" max="100" value="100" class="slider" id="intervalBSlider" oninput="updateClosedIntervalGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeClosedIntervalFunction(1)">
                            <i class="fas fa-wave-square"></i> f(x)=sin x
                        </button>
                        <button class="control-btn" onclick="changeClosedIntervalFunction(2)">
                            <i class="fas fa-parabola"></i> f(x)=xÂ²-2x+1
                        </button>
                        <button class="control-btn" onclick="changeClosedIntervalFunction(3)">
                            <i class="fas fa-cube"></i> f(x)=xÂ³-3x
                        </button>
                        <button class="animation-btn" onclick="startClosedIntervalAnimation()">
                            <i class="fas fa-play"></i> åŠ¨ç”»æ¼”ç¤ºæ€§è´¨
                        </button>
                    </div>
                </div>
                
            </section>
            
        </main>
        
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <!-- å­¦ä¹ è¿›åº¦ -->
            <div class="progress-container">
                <div class="progress-title">
                    <i class="fas fa-tasks"></i> å­¦ä¹ è¿›åº¦
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 10%"></div>
                </div>
                <div class="progress-text">
                    å·²å­¦ä¹ ï¼š<span id="progressPercent">10%</span> (1/10èŠ‚)
                </div>
                <button class="control-btn" onclick="resetProgress()" style="margin-top:15px; width:100%;">
                    <i class="fas fa-redo"></i> é‡ç½®å­¦ä¹ è¿›åº¦
                </button>
            </div>
            
            <!-- å¿«é€Ÿé“¾æ¥ -->
            <div class="quick-links">
                <div class="quick-links-title">
                    <i class="fas fa-rocket"></i> å¿«é€Ÿé“¾æ¥
                </div>
                <div class="links-grid">
                    <button class="link-btn" onclick="scrollToSection('mapping-function')">
                        <i class="fas fa-project-diagram"></i> æ˜ å°„ä¸å‡½æ•°
                    </button>
                    <button class="link-btn" onclick="scrollToSection('sequence-limit')">
                        <i class="fas fa-sort-numeric-down"></i> æ•°åˆ—æé™
                    </button>
                    <button class="link-btn" onclick="scrollToSection('function-limit')">
                        <i class="fas fa-bullseye"></i> å‡½æ•°æé™
                    </button>
                    <button class="link-btn" onclick="scrollToSection('limit-criteria')">
                        <i class="fas fa-filter"></i> æé™å‡†åˆ™
                    </button>
                    <button class="link-btn" onclick="scrollToSection('limit-operations')">
                        <i class="fas fa-calculator"></i> æé™è¿ç®—
                    </button>
                    <button class="link-btn" onclick="scrollToSection('important-limits')">
                        <i class="fas fa-star"></i> é‡è¦æé™
                    </button>
                    <button class="link-btn" onclick="scrollToSection('infinitesimal-comparison')">
                        <i class="fas fa-balance-scale-left"></i> æ— ç©·å°æ¯”è¾ƒ
                    </button>
                    <button class="link-btn" onclick="scrollToSection('continuity')">
                        <i class="fas fa-link"></i> è¿ç»­æ€§
                    </button>
                    <button class="link-btn" onclick="scrollToSection('continuous-operations')">
                        <i class="fas fa-cogs"></i> è¿ç»­è¿ç®—
                    </button>
                    <button class="link-btn" onclick="scrollToSection('closed-interval')">
                        <i class="fas fa-expand-arrows-alt"></i> é—­åŒºé—´æ€§è´¨
                    </button>
                </div>
            </div>
            
            <!-- æé™æŒ‘æˆ˜æ¸¸æˆ -->
            <div class="game-container">
                <div class="game-title">
                    <i class="fas fa-gamepad"></i> æé™æŒ‘æˆ˜æ¸¸æˆ
                </div>
                <p style="margin-bottom:20px; color:#666;">é€šè¿‡æ¸¸æˆå·©å›ºæé™çŸ¥è¯†ï¼Œçœ‹çœ‹ä½ èƒ½å¾—å¤šå°‘åˆ†ï¼</p>
                <button class="game-btn" onclick="startGame()">
                    <i class="fas fa-play-circle"></i> å¼€å§‹æ¸¸æˆ
                </button>
                <div id="gameScore" style="margin-top:15px; padding:10px; background:white; border-radius:10px; display:none;">
                    <div class="info-label">å½“å‰å¾—åˆ†</div>
                    <div class="info-value" id="currentScore">0</div>
                    <div style="margin-top:10px;">
                        <button class="game-exit-btn" onclick="exitGame()">
                            <i class="fas fa-times"></i> é€€å‡ºæ¸¸æˆ
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- å­¦ä¹ èµ„æº -->
            <div class="quick-links">
                <div class="quick-links-title">
                    <i class="fas fa-download"></i> å­¦ä¹ èµ„æº
                </div>
                <div style="margin-top:15px;">
                    <button class="link-btn" onclick="downloadNotes()">
                        <i class="fas fa-file-pdf"></i> ä¸‹è½½æœ¬ç« ç¬”è®°
                    </button>
                    <button class="link-btn" onclick="viewFormulas()">
                        <i class="fas fa-square-root-alt"></i> æŸ¥çœ‹å…¬å¼å¤§å…¨
                    </button>
                    <button class="link-btn" onclick="showCommonMistakes()">
                        <i class="fas fa-exclamation-triangle"></i> å¸¸è§é”™è¯¯
                    </button>
                    <button class="link-btn" onclick="showExamTips()">
                        <i class="fas fa-graduation-cap"></i> è€ƒè¯•æŠ€å·§
                    </button>
                </div>
            </div>
            
            <!-- å­¦ä¹ è®¡æ—¶å™¨ -->
            <div class="progress-container" style="margin-top:25px;">
                <div class="progress-title">
                    <i class="fas fa-clock"></i> å­¦ä¹ è®¡æ—¶å™¨
                </div>
                <div style="font-size:2rem; font-weight:bold; color:var(--primary); margin:15px 0;" id="studyTimer">
                    00:00:00
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="control-btn" onclick="startTimer()" style="flex:1;">
                        <i class="fas fa-play"></i> å¼€å§‹
                    </button>
                    <button class="control-btn" onclick="pauseTimer()" style="flex:1; background:linear-gradient(135deg, #ff9800 0%, #ff5722 100%);">
                        <i class="fas fa-pause"></i> æš‚åœ
                    </button>
                    <button class="control-btn" onclick="resetTimer()" style="flex:1; background:linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                        <i class="fas fa-stop"></i> é‡ç½®
                    </button>
                </div>
            </div>
        </aside>
    </div>
    
    <!-- æ¸¸æˆæ¨¡æ€æ¡† -->
    <div class="game-modal" id="gameModal">
        <div class="game-modal-content">
            <h2 style="color:#ff9800; margin-bottom:20px;"><i class="fas fa-gamepad"></i> æé™æŒ‘æˆ˜æ¸¸æˆ</h2>
            <div id="gameQuestion" style="margin-bottom:20px; font-size:1.1rem;"></div>
            <div id="gameOptions" style="margin-bottom:20px;"></div>
            <div style="display:flex; justify-content:space-between; margin-top:20px;">
                <button class="game-exit-btn" onclick="exitGameModal()">
                    <i class="fas fa-times"></i> é€€å‡ºæ¸¸æˆ
                </button>
                <button class="control-btn" onclick="submitGameAnswer()">
                    <i class="fas fa-check"></i> æäº¤ç­”æ¡ˆ
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // ==================== å…¨å±€å˜é‡ ====================
        // Canvasä¸Šä¸‹æ–‡
        let domainCtx, functionTypeCtx, sequenceCtx, functionLimitCtx, squeezeCtx;
        let limitOperationsCtx, importantLimitsCtx, infinitesimalCtx;
        let continuityCtx, continuousOperationsCtx, closedIntervalCtx;
        
        // å„å›¾å½¢æ§åˆ¶å˜é‡
        let domainFunctionType = 1;
        let functionType = 1;
        let showVerticalTest = true;
        let sequenceType = 1;
        let functionLimitType = 1;
        let squeezeType = 1;
        let limitOperationType = 1;
        let importantLimitType = 1;
        let infinitesimalType = 1;
        let continuityType = 1;
        let continuousOpType = 1;
        let closedIntervalType = 1;
        
        // ç³»ç»Ÿå˜é‡
        let studyTimer = 0;
        let timerInterval = null;
        let gameActive = false;
        let currentGameQuestion = 0;
        let gameScore = 0;
        let gameQuestions = [];
        let userGameAnswer = null;
        let learnedSections = new Set(['mapping-function']);
        let totalSections = 10;
        
        // ==================== åˆå§‹åŒ–å‡½æ•° ====================
        function init() {
            console.log("åˆå§‹åŒ–ç³»ç»Ÿ...");
            
            // åˆå§‹åŒ–Canvasä¸Šä¸‹æ–‡
            initCanvasContexts();
            
            // åˆå§‹åŒ–æ‰€æœ‰å›¾å½¢
            updateAllGraphs();
            
            // æ›´æ–°å­¦ä¹ è¿›åº¦
            updateProgress();
            
            // åˆå§‹åŒ–æ¸¸æˆé—®é¢˜
            initGameQuestions();
            
            // å¼€å§‹å­¦ä¹ è®¡æ—¶å™¨
            startTimer();
            
            console.log("ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆï¼");
        }
        
        function initCanvasContexts() {
            console.log("åˆå§‹åŒ–Canvasä¸Šä¸‹æ–‡...");
            
            // æ‰€æœ‰Canvaså…ƒç´ 
            const canvases = [
                {id: 'domainCanvas', ctxVar: 'domainCtx'},
                {id: 'functionTypeCanvas', ctxVar: 'functionTypeCtx'},
                {id: 'sequenceCanvas', ctxVar: 'sequenceCtx'},
                {id: 'functionLimitCanvas', ctxVar: 'functionLimitCtx'},
                {id: 'squeezeCanvas', ctxVar: 'squeezeCtx'},
                {id: 'limitOperationsCanvas', ctxVar: 'limitOperationsCtx'},
                {id: 'importantLimitsCanvas', ctxVar: 'importantLimitsCtx'},
                {id: 'infinitesimalCanvas', ctxVar: 'infinitesimalCtx'},
                {id: 'continuityCanvas', ctxVar: 'continuityCtx'},
                {id: 'continuousOperationsCanvas', ctxVar: 'continuousOperationsCtx'},
                {id: 'closedIntervalCanvas', ctxVar: 'closedIntervalCtx'}
            ];
            
            canvases.forEach(canvasInfo => {
                const canvas = document.getElementById(canvasInfo.id);
                if (canvas) {
                    canvas.width = 500;
                    canvas.height = 250;
                    
                    const ctx = canvas.getContext('2d');
                    if (ctx) {
                        // å°†ä¸Šä¸‹æ–‡èµ‹å€¼ç»™å¯¹åº”çš„å…¨å±€å˜é‡
                        eval(`${canvasInfo.ctxVar} = ctx`);
                    } else {
                        console.error(`æ— æ³•è·å–Canvasä¸Šä¸‹æ–‡: ${canvasInfo.id}`);
                    }
                } else {
                    console.error(`Canvaså…ƒç´ æœªæ‰¾åˆ°: ${canvasInfo.id}`);
                }
            });
            
            console.log("Canvasä¸Šä¸‹æ–‡åˆå§‹åŒ–æˆåŠŸï¼");
        }
        
        function updateAllGraphs() {
            updateDomainGraph();
            updateFunctionTypeGraph();
            updateSequenceGraph();
            updateFunctionLimitGraph();
            updateSqueezeGraph();
            updateLimitOperationsGraph();
            updateImportantLimitsGraph();
            updateInfinitesimalGraph();
            updateContinuityGraph();
            updateContinuousOperationsGraph();
            updateClosedIntervalGraph();
        }
        
        // ==================== å‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ– ====================
        function updateDomainGraph() {
            const slider = document.getElementById('domainSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 10;
            if (document.getElementById('xSliderValue')) {
                document.getElementById('xSliderValue').textContent = xValue.toFixed(1);
            }
            if (document.getElementById('xValueDomain')) {
                document.getElementById('xValueDomain').textContent = xValue.toFixed(1);
            }
            
            // è®¡ç®—å‡½æ•°å€¼å’Œå®šä¹‰åŸŸåˆ¤æ–­
            let funcValue, inDomain, domainRange, currentFunction;
            
            switch(domainFunctionType) {
                case 1:
                    if (xValue >= -2 && xValue !== 1) {
                        funcValue = Math.sqrt(xValue + 2) / (xValue - 1);
                        inDomain = "æ˜¯";
                    } else {
                        funcValue = NaN;
                        inDomain = "å¦";
                    }
                    domainRange = "[-2,1)âˆª(1,âˆ)";
                    currentFunction = "f(x)=âˆš(x+2)/(x-1)";
                    break;
                case 2:
                    if (xValue !== 2) {
                        funcValue = 1 / (xValue - 2);
                        inDomain = "æ˜¯";
                    } else {
                        funcValue = NaN;
                        inDomain = "å¦";
                    }
                    domainRange = "(-âˆ,2)âˆª(2,âˆ)";
                    currentFunction = "f(x)=1/(x-2)";
                    break;
                case 3:
                    if (xValue > 0) {
                        funcValue = Math.log(xValue);
                        inDomain = "æ˜¯";
                    } else {
                        funcValue = NaN;
                        inDomain = "å¦";
                    }
                    domainRange = "(0,âˆ)";
                    currentFunction = "f(x)=ln(x)";
                    break;
            }
            
            if (document.getElementById('funcValueDomain')) {
                document.getElementById('funcValueDomain').textContent = isNaN(funcValue) ? "NaN" : funcValue.toFixed(3);
            }
            if (document.getElementById('inDomain')) {
                document.getElementById('inDomain').textContent = inDomain;
            }
            if (document.getElementById('domainRange')) {
                document.getElementById('domainRange').textContent = domainRange;
            }
            if (document.getElementById('currentFunction')) {
                document.getElementById('currentFunction').textContent = currentFunction;
            }
            
            // ç»˜åˆ¶å›¾å½¢
            drawDomainGraph(xValue, funcValue, inDomain);
        }
        
        function drawDomainGraph(xValue, funcValue, inDomain) {
            if (!domainCtx) return;
            
            const canvas = document.getElementById('domainCanvas');
            const ctx = domainCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -5;
            const xMax = 5;
            const yMin = -5;
            const yMax = 5;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            ctx.strokeStyle = '#ff4081';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = (xMax - xMin) / 100;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y, isValid = true;
                
                switch(domainFunctionType) {
                    case 1:
                        if (x >= -2 && x !== 1) {
                            y = Math.sqrt(x + 2) / (x - 1);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                    case 2:
                        if (x !== 2) {
                            y = 1 / (x - 2);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                    case 3:
                        if (x > 0) {
                            y = Math.log(x);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                }
                
                if (isValid && !isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (inDomain === "æ˜¯" && !isNaN(funcValue)) {
                const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height - ((funcValue - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                // ç»˜åˆ¶ç‚¹
                ctx.fillStyle = '#0f9d58';
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function changeDomainFunction(type) {
            domainFunctionType = type;
            updateDomainGraph();
        }
        
        function startDomainAnimation() {
            const slider = document.getElementById('domainSlider');
            let value = -30;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateDomainGraph();
                value += 1;
                
                if (value > 30) {
                    clearInterval(interval);
                    console.log("å®šä¹‰åŸŸåŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== æ•°åˆ—æé™å¯è§†åŒ– ====================
        function updateSequenceGraph() {
            const nSlider = document.getElementById('sequenceSlider');
            const epsilonSlider = document.getElementById('epsilonSlider');
            
            if (!nSlider || !epsilonSlider) return;
            
            const n = parseInt(nSlider.value);
            const epsilon = parseFloat(epsilonSlider.value) / 10;
            
            if (document.getElementById('nSliderValue')) {
                document.getElementById('nSliderValue').textContent = n;
            }
            if (document.getElementById('epsilonValue')) {
                document.getElementById('epsilonValue').textContent = epsilon.toFixed(2);
            }
            
            let an, limitA;
            
            switch(sequenceType) {
                case 1:
                    an = 1 + 1 / n;
                    limitA = 1;
                    break;
                case 2:
                    an = (n - 1) / n;
                    limitA = 1;
                    break;
                case 3:
                    an = Math.pow(-1, n) / n;
                    limitA = 0;
                    break;
            }
            
            const difference = Math.abs(an - limitA);
            
            if (document.getElementById('nValue')) {
                document.getElementById('nValue').textContent = n;
            }
            if (document.getElementById('anValue')) {
                document.getElementById('anValue').textContent = an.toFixed(3);
            }
            if (document.getElementById('limitA')) {
                document.getElementById('limitA').textContent = limitA;
            }
            if (document.getElementById('differenceValue')) {
                document.getElementById('differenceValue').textContent = difference.toFixed(3);
            }
            
            drawSequenceGraph(n, an, limitA, epsilon);
        }
        
        function drawSequenceGraph(n, an, limitA, epsilon) {
            if (!sequenceCtx) return;
            
            const canvas = document.getElementById('sequenceCanvas');
            const ctx = sequenceCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const nMin = 1;
            const nMax = Math.max(20, n * 1.5);
            const aMin = Math.min(limitA - 1, limitA - 2 * epsilon);
            const aMax = Math.max(limitA + 1, limitA + 2 * epsilon);
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, nMin, nMax, aMin, aMax, true);
            
            // ç»˜åˆ¶æé™çº¿
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.7)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            
            const limitY = height - ((limitA - aMin) / (aMax - aMin) * (height - 100) + 50);
            ctx.beginPath();
            ctx.moveTo(50, limitY);
            ctx.lineTo(width - 50, limitY);
            ctx.stroke();
            
            ctx.setLineDash([]);
            
            // ç»˜åˆ¶æ•°åˆ—ç‚¹
            ctx.fillStyle = '#4285f4';
            const maxPoints = Math.min(50, nMax);
            
            for (let i = 1; i <= maxPoints; i++) {
                let currentAn;
                switch(sequenceType) {
                    case 1: currentAn = 1 + 1 / i; break;
                    case 2: currentAn = (i - 1) / i; break;
                    case 3: currentAn = Math.pow(-1, i) / i; break;
                }
                
                const x = (i - nMin) / (nMax - nMin) * (width - 100) + 50;
                const y = height - ((currentAn - aMin) / (aMax - aMin) * (height - 100) + 50);
                
                // ç»˜åˆ¶ç‚¹
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // çªå‡ºæ˜¾ç¤ºå½“å‰nçš„ç‚¹
                if (i === n && i <= maxPoints) {
                    ctx.fillStyle = '#0f9d58';
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.fillStyle = '#4285f4';
            }
        }
        
        function changeSequence(type) {
            sequenceType = type;
            updateSequenceGraph();
        }
        
        function startSequenceAnimation() {
            const slider = document.getElementById('sequenceSlider');
            let value = 1;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateSequenceGraph();
                value += 1;
                
                if (value > 50) {
                    clearInterval(interval);
                    console.log("æ•°åˆ—æé™åŠ¨ç”»å®Œæˆ");
                }
            }, 200);
        }
        
        // ==================== å‡½æ•°æé™å¯è§†åŒ– ====================
        function updateFunctionLimitGraph() {
            const xSlider = document.getElementById('xLimitSlider');
            const epsilonSlider = document.getElementById('epsilonLimitSlider');
            
            if (!xSlider || !epsilonSlider) return;
            
            const xValue = parseFloat(xSlider.value) / 10;
            const epsilon = parseFloat(epsilonSlider.value) / 10;
            
            if (document.getElementById('xLimitSliderValue')) {
                document.getElementById('xLimitSliderValue').textContent = xValue.toFixed(1);
            }
            if (document.getElementById('epsilonLimitValue')) {
                document.getElementById('epsilonLimitValue').textContent = epsilon.toFixed(2);
            }
            
            let fx, limitA, x0;
            
            switch(functionLimitType) {
                case 1:
                    fx = xValue * xValue;
                    limitA = 4;
                    x0 = 2;
                    break;
                case 2:
                    fx = (xValue * xValue - 1) / (xValue - 1);
                    if (Math.abs(xValue - 1) < 0.001) fx = 2;
                    limitA = 2;
                    x0 = 1;
                    break;
                case 3:
                    if (Math.abs(xValue) > 0.001) {
                        fx = Math.sin(1 / xValue);
                    } else {
                        fx = NaN;
                    }
                    limitA = NaN;
                    x0 = 0;
                    break;
            }
            
            const difference = isNaN(fx) || isNaN(limitA) ? NaN : Math.abs(fx - limitA);
            
            if (document.getElementById('xValueLimit')) {
                document.getElementById('xValueLimit').textContent = xValue.toFixed(1);
            }
            if (document.getElementById('fxValueLimit')) {
                document.getElementById('fxValueLimit').textContent = isNaN(fx) ? "NaN" : fx.toFixed(3);
            }
            if (document.getElementById('limitValue')) {
                document.getElementById('limitValue').textContent = isNaN(limitA) ? "ä¸å­˜åœ¨" : limitA.toFixed(1);
            }
            if (document.getElementById('limitDiffValue')) {
                document.getElementById('limitDiffValue').textContent = isNaN(difference) ? "NaN" : difference.toFixed(3);
            }
            
            drawFunctionLimitGraph(xValue, fx, limitA, epsilon, x0);
        }
        
        function drawFunctionLimitGraph(xValue, fx, limitA, epsilon, x0) {
            if (!functionLimitCtx) return;
            
            const canvas = document.getElementById('functionLimitCanvas');
            const ctx = functionLimitCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax;
            switch(functionLimitType) {
                case 1: xMin = -3; xMax = 5; break;
                case 2: xMin = -1; xMax = 3; break;
                case 3: xMin = -2; xMax = 2; break;
            }
            const yMin = -3;
            const yMax = 3;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            ctx.strokeStyle = '#4285f4';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y, isValid = true;
                
                switch(functionLimitType) {
                    case 1:
                        y = x * x;
                        break;
                    case 2:
                        if (Math.abs(x - 1) > 0.01) {
                            y = (x * x - 1) / (x - 1);
                        } else {
                            continue;
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.01) {
                            y = Math.sin(1 / x);
                        } else {
                            continue;
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(fx)) {
                const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height - ((fx - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                ctx.fillStyle = '#0f9d58';
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function changeFunctionLimit(type) {
            functionLimitType = type;
            updateFunctionLimitGraph();
        }
        
        function startFunctionLimitAnimation() {
            const slider = document.getElementById('xLimitSlider');
            let value = 0;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateFunctionLimitGraph();
                value += 1;
                
                if (value > 40) {
                    clearInterval(interval);
                    console.log("å‡½æ•°æé™åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== å¤¹é€¼å‡†åˆ™å¯è§†åŒ– ====================
        function updateSqueezeGraph() {
            const slider = document.getElementById('squeezeSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 100;
            
            if (document.getElementById('xSqueezeSliderValue')) {
                document.getElementById('xSqueezeSliderValue').textContent = xValue.toFixed(2);
            }
            
            let gx, fx, hx, limit;
            
            switch(squeezeType) {
                case 1:
                    // x sin(1/x) è¢«å¤¹é€¼åœ¨ -|x| å’Œ |x| ä¹‹é—´
                    if (Math.abs(xValue) > 0.001) {
                        fx = xValue * Math.sin(1 / xValue);
                    } else {
                        fx = 0;
                    }
                    gx = -Math.abs(xValue);
                    hx = Math.abs(xValue);
                    limit = 0;
                    break;
                case 2:
                    // (xÂ²+1)/(xÂ²+2) è¢«å¤¹é€¼åœ¨ 1/(xÂ²+2) å’Œ 1 ä¹‹é—´
                    fx = (xValue * xValue + 1) / (xValue * xValue + 2);
                    gx = 1 / (xValue * xValue + 2);
                    hx = 1;
                    limit = 1;
                    break;
                case 3:
                    // sin(x)/x è¢«å¤¹é€¼åœ¨ cos(x) å’Œ 1 ä¹‹é—´ï¼ˆx>0ï¼‰
                    if (Math.abs(xValue) > 0.001) {
                        fx = Math.sin(xValue) / xValue;
                    } else {
                        fx = 1;
                    }
                    gx = Math.cos(xValue);
                    hx = 1;
                    limit = 1;
                    break;
            }
            
            if (document.getElementById('xValueSqueeze')) {
                document.getElementById('xValueSqueeze').textContent = xValue.toFixed(2);
            }
            if (document.getElementById('gxValue')) {
                document.getElementById('gxValue').textContent = gx.toFixed(3);
            }
            if (document.getElementById('fxValueSqueeze')) {
                document.getElementById('fxValueSqueeze').textContent = fx.toFixed(3);
            }
            if (document.getElementById('hxValue')) {
                document.getElementById('hxValue').textContent = hx.toFixed(3);
            }
            if (document.getElementById('squeezeLimit')) {
                document.getElementById('squeezeLimit').textContent = limit;
            }
            
            drawSqueezeGraph(xValue, gx, fx, hx, limit);
        }
        
        function drawSqueezeGraph(xValue, gx, fx, hx, limit) {
            if (!squeezeCtx) return;
            
            const canvas = document.getElementById('squeezeCanvas');
            const ctx = squeezeCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 2;
            const yMin = -1;
            const yMax = 2;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            const functions = [
                {color: '#4285f4', value: gx, name: 'g(x)'},
                {color: '#ff4081', value: fx, name: 'f(x)'},
                {color: '#0f9d58', value: hx, name: 'h(x)'}
            ];
            
            functions.forEach(func => {
                ctx.strokeStyle = func.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const step = (xMax - xMin) / 100;
                let firstPoint = true;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(squeezeType) {
                        case 1:
                            if (func.name === 'g(x)') y = -Math.abs(x);
                            else if (func.name === 'f(x)') {
                                if (Math.abs(x) > 0.001) y = x * Math.sin(1 / x);
                                else y = 0;
                            }
                            else if (func.name === 'h(x)') y = Math.abs(x);
                            break;
                        case 2:
                            if (func.name === 'g(x)') y = 1 / (x * x + 2);
                            else if (func.name === 'f(x)') y = (x * x + 1) / (x * x + 2);
                            else if (func.name === 'h(x)') y = 1;
                            break;
                        case 3:
                            if (func.name === 'g(x)') y = Math.cos(x);
                            else if (func.name === 'f(x)') {
                                if (Math.abs(x) > 0.001) y = Math.sin(x) / x;
                                else y = 1;
                            }
                            else if (func.name === 'h(x)') y = 1;
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                        const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                        
                        if (firstPoint) {
                            ctx.moveTo(pixelX, pixelY);
                            firstPoint = false;
                        } else {
                            ctx.lineTo(pixelX, pixelY);
                        }
                    } else {
                        firstPoint = true;
                    }
                }
                ctx.stroke();
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
            
            functions.forEach(func => {
                let y;
                switch(squeezeType) {
                    case 1:
                        if (func.name === 'g(x)') y = -Math.abs(xValue);
                        else if (func.name === 'f(x)') {
                            if (Math.abs(xValue) > 0.001) y = xValue * Math.sin(1 / xValue);
                            else y = 0;
                        }
                        else if (func.name === 'h(x)') y = Math.abs(xValue);
                        break;
                    case 2:
                        if (func.name === 'g(x)') y = 1 / (xValue * xValue + 2);
                        else if (func.name === 'f(x)') y = (xValue * xValue + 1) / (xValue * xValue + 2);
                        else if (func.name === 'h(x)') y = 1;
                        break;
                    case 3:
                        if (func.name === 'g(x)') y = Math.cos(xValue);
                        else if (func.name === 'f(x)') {
                            if (Math.abs(xValue) > 0.001) y = Math.sin(xValue) / xValue;
                            else y = 1;
                        }
                        else if (func.name === 'h(x)') y = 1;
                        break;
                }
                
                const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                ctx.fillStyle = func.color;
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 5, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        function changeSqueezeFunction(type) {
            squeezeType = type;
            updateSqueezeGraph();
        }
        
        function startSqueezeAnimation() {
            const slider = document.getElementById('squeezeSlider');
            let value = 1;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateSqueezeGraph();
                value += 2;
                
                if (value > 100) {
                    clearInterval(interval);
                    console.log("å¤¹é€¼å‡†åˆ™åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== æé™è¿ç®—å¯è§†åŒ– ====================
        function updateLimitOperationsGraph() {
            const slider = document.getElementById('limitOpSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 100 + 1;
            
            if (document.getElementById('xOpSliderValue')) {
                document.getElementById('xOpSliderValue').textContent = xValue.toFixed(2);
            }
            
            let fValue, gValue, result, limitF, limitG, limitResult;
            let approachPoint = "xâ†’2";
            
            switch(limitOperationType) {
                case 1: // åŠ æ³•
                    fValue = xValue * xValue; // f(x) = xÂ²
                    gValue = 2 * xValue;      // g(x) = 2x
                    result = fValue + gValue; // f(x)+g(x) = xÂ²+2x
                    limitF = 4;               // lim f(x) = 4 (xâ†’2)
                    limitG = 4;               // lim g(x) = 4 (xâ†’2)
                    limitResult = 8;          // lim (f+g) = 8
                    break;
                case 2: // å‡æ³•
                    fValue = xValue * xValue; // f(x) = xÂ²
                    gValue = xValue + 1;      // g(x) = x+1
                    result = fValue - gValue; // f(x)-g(x) = xÂ²-x-1
                    limitF = 4;               // lim f(x) = 4 (xâ†’2)
                    limitG = 3;               // lim g(x) = 3 (xâ†’2)
                    limitResult = 1;          // lim (f-g) = 1
                    break;
                case 3: // ä¹˜æ³•
                    fValue = xValue;          // f(x) = x
                    gValue = xValue + 1;      // g(x) = x+1
                    result = fValue * gValue; // f(x)*g(x) = x(x+1)
                    limitF = 2;               // lim f(x) = 2 (xâ†’2)
                    limitG = 3;               // lim g(x) = 3 (xâ†’2)
                    limitResult = 6;          // lim (f*g) = 6
                    break;
                case 4: // é™¤æ³•
                    fValue = xValue * xValue; // f(x) = xÂ²
                    gValue = xValue;          // g(x) = x
                    result = fValue / gValue; // f(x)/g(x) = x
                    limitF = 4;               // lim f(x) = 4 (xâ†’2)
                    limitG = 2;               // lim g(x) = 2 (xâ†’2)
                    limitResult = 2;          // lim (f/g) = 2
                    break;
            }
            
            // æ›´æ–°æ˜¾ç¤º
            const operationTypes = ["åŠ æ³•", "å‡æ³•", "ä¹˜æ³•", "é™¤æ³•"];
            if (document.getElementById('operationType')) {
                document.getElementById('operationType').textContent = operationTypes[limitOperationType-1];
            }
            if (document.getElementById('limitF')) {
                document.getElementById('limitF').textContent = limitF.toFixed(1);
            }
            if (document.getElementById('limitG')) {
                document.getElementById('limitG').textContent = limitG.toFixed(1);
            }
            if (document.getElementById('limitResult')) {
                document.getElementById('limitResult').textContent = limitResult.toFixed(1);
            }
            if (document.getElementById('approachPoint')) {
                document.getElementById('approachPoint').textContent = approachPoint;
            }
            
            drawLimitOperationsGraph(xValue, fValue, gValue, result, limitOperationType);
        }
        
        function drawLimitOperationsGraph(xValue, fValue, gValue, result, operationType) {
            if (!limitOperationsCtx) return;
            
            const canvas = document.getElementById('limitOperationsCanvas');
            const ctx = limitOperationsCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 4;
            const yMin = 0;
            const yMax = 10;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // å®šä¹‰ä¸‰ç§é¢œè‰²
            const colors = ['#4285f4', '#0f9d58', '#ff4081'];
            const functionNames = ['f(x)', 'g(x)', 'f(x) op g(x)'];
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            for (let i = 0; i < 3; i++) {
                ctx.strokeStyle = colors[i];
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const step = (xMax - xMin) / 100;
                let firstPoint = true;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(operationType) {
                        case 1: // åŠ æ³•
                            if (i === 0) y = x * x;               // f(x) = xÂ²
                            else if (i === 1) y = 2 * x;          // g(x) = 2x
                            else y = x * x + 2 * x;               // f+g = xÂ²+2x
                            break;
                        case 2: // å‡æ³•
                            if (i === 0) y = x * x;               // f(x) = xÂ²
                            else if (i === 1) y = x + 1;          // g(x) = x+1
                            else y = x * x - (x + 1);             // f-g = xÂ²-x-1
                            break;
                        case 3: // ä¹˜æ³•
                            if (i === 0) y = x;                   // f(x) = x
                            else if (i === 1) y = x + 1;          // g(x) = x+1
                            else y = x * (x + 1);                 // f*g = x(x+1)
                            break;
                        case 4: // é™¤æ³•
                            if (i === 0) y = x * x;               // f(x) = xÂ²
                            else if (i === 1) y = x;              // g(x) = x
                            else y = x;                           // f/g = x (xâ‰ 0)
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                        const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                        
                        if (firstPoint) {
                            ctx.moveTo(pixelX, pixelY);
                            firstPoint = false;
                        } else {
                            ctx.lineTo(pixelX, pixelY);
                        }
                    } else {
                        firstPoint = true;
                    }
                }
                ctx.stroke();
                
                // æ·»åŠ å‡½æ•°æ ‡ç­¾
                ctx.fillStyle = colors[i];
                ctx.font = 'bold 12px Arial';
                ctx.fillText(functionNames[i], width - 80, 30 + i * 20);
            }
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [fValue, gValue, result];
            const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
            
            for (let i = 0; i < 3; i++) {
                const y = values[i];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    ctx.fillStyle = colors[i];
                    ctx.beginPath();
                    ctx.arc(pixelX, pixelY, 5, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }
        
        function changeLimitOperation(type) {
            limitOperationType = type;
            updateLimitOperationsGraph();
        }
        
        function startLimitOpAnimation() {
            const slider = document.getElementById('limitOpSlider');
            let value = 10;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateLimitOperationsGraph();
                value += 2;
                
                if (value > 190) {
                    clearInterval(interval);
                    console.log("æé™è¿ç®—åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== é‡è¦æé™å¯è§†åŒ– ====================
        function updateImportantLimitsGraph() {
            const slider = document.getElementById('importantLimitsSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 10;
            
            if (document.getElementById('xImportantSliderValue')) {
                document.getElementById('xImportantSliderValue').textContent = xValue.toFixed(2);
            }
            
            let currentValue, limitValue, limitType, limitTarget;
            
            switch(importantLimitType) {
                case 1: // sin(x)/x
                    if (Math.abs(xValue) > 0.001) {
                        currentValue = Math.sin(xValue) / xValue;
                    } else {
                        currentValue = 1;
                    }
                    limitValue = 1;
                    limitType = "ç¬¬ä¸€ä¸ªé‡è¦æé™";
                    limitTarget = "1";
                    break;
                case 2: // (1+1/x)^x
                    if (Math.abs(xValue) > 0.001) {
                        currentValue = Math.pow(1 + 1/xValue, xValue);
                    } else {
                        currentValue = Math.E;
                    }
                    limitValue = Math.E;
                    limitType = "ç¬¬äºŒä¸ªé‡è¦æé™";
                    limitTarget = "eâ‰ˆ2.718";
                    break;
                case 3: // (1+x)^(1/x)
                    if (Math.abs(xValue) > 0.001) {
                        currentValue = Math.pow(1 + xValue, 1/xValue);
                    } else {
                        currentValue = Math.E;
                    }
                    limitValue = Math.E;
                    limitType = "ç¬¬äºŒä¸ªé‡è¦æé™å˜å½¢";
                    limitTarget = "eâ‰ˆ2.718";
                    break;
            }
            
            const difference = Math.abs(currentValue - limitValue);
            
            if (document.getElementById('importantLimitType')) {
                document.getElementById('importantLimitType').textContent = limitType;
            }
            if (document.getElementById('importantLimitValue')) {
                document.getElementById('importantLimitValue').textContent = currentValue.toFixed(4);
            }
            if (document.getElementById('importantLimitResult')) {
                document.getElementById('importantLimitResult').textContent = limitType === "ç¬¬ä¸€ä¸ªé‡è¦æé™" ? "1" : "eâ‰ˆ2.718";
            }
            if (document.getElementById('importantLimitDiff')) {
                document.getElementById('importantLimitDiff').textContent = difference.toFixed(4);
            }
            if (document.getElementById('importantLimitTarget')) {
                document.getElementById('importantLimitTarget').textContent = limitTarget;
            }
            
            drawImportantLimitsGraph(xValue, currentValue, limitValue, importantLimitType);
        }
        
        function drawImportantLimitsGraph(xValue, currentValue, limitValue, limitType) {
            if (!importantLimitsCtx) return;
            
            const canvas = document.getElementById('importantLimitsCanvas');
            const ctx = importantLimitsCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax, yMin, yMax;
            
            switch(limitType) {
                case 1: // sin(x)/x
                    xMin = -2;
                    xMax = 2;
                    yMin = 0;
                    yMax = 1.2;
                    break;
                case 2: // (1+1/x)^x
                    xMin = 0.1;
                    xMax = 10;
                    yMin = 1;
                    yMax = 3;
                    break;
                case 3: // (1+x)^(1/x)
                    xMin = -0.9;
                    xMax = 2;
                    yMin = 1;
                    yMax = 3;
                    break;
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            ctx.strokeStyle = '#4285f4';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = (xMax - xMin) / 100;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(limitType) {
                    case 1:
                        if (Math.abs(x) > 0.001) {
                            y = Math.sin(x) / x;
                        } else {
                            y = 1;
                        }
                        break;
                    case 2:
                        if (Math.abs(x) > 0.001) {
                            y = Math.pow(1 + 1/x, x);
                        } else {
                            y = Math.E;
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.001 && x > -1) {
                            y = Math.pow(1 + x, 1/x);
                        } else {
                            continue;
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶æé™çº¿
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.7)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            
            const limitY = height - ((limitValue - yMin) / (yMax - yMin) * (height - 100) + 50);
            ctx.beginPath();
            ctx.moveTo(50, limitY);
            ctx.lineTo(width - 50, limitY);
            ctx.stroke();
            
            ctx.setLineDash([]);
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(currentValue) && currentValue >= yMin && currentValue <= yMax) {
                const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height - ((currentValue - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                ctx.fillStyle = '#0f9d58';
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                ctx.fill();
                
                // ç»˜åˆ¶åˆ°æé™çº¿çš„è¿çº¿
                ctx.strokeStyle = 'rgba(255, 0, 0, 0.5)';
                ctx.lineWidth = 1;
                ctx.setLineDash([2, 2]);
                ctx.beginPath();
                ctx.moveTo(pixelX, pixelY);
                ctx.lineTo(pixelX, limitY);
                ctx.stroke();
                ctx.setLineDash([]);
            }
        }
        
        function changeImportantLimit(type) {
            importantLimitType = type;
            updateImportantLimitsGraph();
        }
        
        function startImportantLimitsAnimation() {
            const slider = document.getElementById('importantLimitsSlider');
            let value = 1;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateImportantLimitsGraph();
                value += 1;
                
                if (value > 100) {
                    clearInterval(interval);
                    console.log("é‡è¦æé™åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== æ— ç©·å°æ¯”è¾ƒå¯è§†åŒ– ====================
        function updateInfinitesimalGraph() {
            const slider = document.getElementById('infinitesimalSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 100;
            
            if (document.getElementById('xInfinitesimalSliderValue')) {
                document.getElementById('xInfinitesimalSliderValue').textContent = xValue.toFixed(3);
            }
            
            let alphaValue, betaValue, ratio, comparisonType;
            
            switch(infinitesimalType) {
                case 1: // Î² = xÂ² æ˜¯ Î± = x çš„é«˜é˜¶æ— ç©·å°
                    alphaValue = xValue;
                    betaValue = xValue * xValue;
                    ratio = betaValue / alphaValue;
                    comparisonType = "é«˜é˜¶æ— ç©·å°";
                    break;
                case 2: // Î² = 3x æ˜¯ Î± = x çš„åŒé˜¶æ— ç©·å°
                    alphaValue = xValue;
                    betaValue = 3 * xValue;
                    ratio = betaValue / alphaValue;
                    comparisonType = "åŒé˜¶æ— ç©·å°";
                    break;
                case 3: // Î² = sin x æ˜¯ Î± = x çš„ç­‰ä»·æ— ç©·å°
                    alphaValue = xValue;
                    betaValue = Math.sin(xValue);
                    ratio = betaValue / alphaValue;
                    comparisonType = "ç­‰ä»·æ— ç©·å°";
                    break;
            }
            
            if (document.getElementById('xValueInfinitesimal')) {
                document.getElementById('xValueInfinitesimal').textContent = xValue.toFixed(3);
            }
            if (document.getElementById('alphaValue')) {
                document.getElementById('alphaValue').textContent = alphaValue.toFixed(4);
            }
            if (document.getElementById('betaValue')) {
                document.getElementById('betaValue').textContent = betaValue.toFixed(4);
            }
            if (document.getElementById('ratioValue')) {
                document.getElementById('ratioValue').textContent = ratio.toFixed(4);
            }
            if (document.getElementById('comparisonType')) {
                document.getElementById('comparisonType').textContent = comparisonType;
            }
            
            drawInfinitesimalGraph(xValue, alphaValue, betaValue, ratio, infinitesimalType);
        }
        
        function drawInfinitesimalGraph(xValue, alphaValue, betaValue, ratio, comparisonType) {
            if (!infinitesimalCtx) return;
            
            const canvas = document.getElementById('infinitesimalCanvas');
            const ctx = infinitesimalCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 1;
            const yMin = 0;
            const yMax = 1;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶Î±(x)å’ŒÎ²(x)æ›²çº¿
            const functions = [
                {color: '#4285f4', value: alphaValue, name: 'Î±(x)'},
                {color: '#ff4081', value: betaValue, name: 'Î²(x)'}
            ];
            
            functions.forEach(func => {
                ctx.strokeStyle = func.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const step = (xMax - xMin) / 100;
                let firstPoint = true;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(comparisonType) {
                        case 1:
                            if (func.name === 'Î±(x)') y = x;
                            else y = x * x;
                            break;
                        case 2:
                            if (func.name === 'Î±(x)') y = x;
                            else y = 3 * x;
                            break;
                        case 3:
                            if (func.name === 'Î±(x)') y = x;
                            else y = Math.sin(x);
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                        const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                        
                        if (firstPoint) {
                            ctx.moveTo(pixelX, pixelY);
                            firstPoint = false;
                        } else {
                            ctx.lineTo(pixelX, pixelY);
                        }
                    } else {
                        firstPoint = true;
                    }
                }
                ctx.stroke();
                
                // æ·»åŠ å‡½æ•°æ ‡ç­¾
                ctx.fillStyle = func.color;
                ctx.font = 'bold 12px Arial';
                if (func.name === 'Î±(x)') {
                    ctx.fillText(func.name, width - 80, 30);
                } else {
                    ctx.fillText(func.name, width - 80, 50);
                }
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [alphaValue, betaValue];
            const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
            
            functions.forEach((func, index) => {
                const y = values[index];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    ctx.fillStyle = func.color;
                    ctx.beginPath();
                    ctx.arc(pixelX, pixelY, 5, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
            
            // ç»˜åˆ¶æ¯”å€¼æ›²çº¿
            ctx.strokeStyle = '#0f9d58';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            
            const step = (xMax - xMin) / 100;
            let firstPoint = true;
            
            for (let x = xMin + 0.001; x <= xMax; x += step) {
                let y;
                
                switch(comparisonType) {
                    case 1:
                        y = x * x / x; // xÂ²/x = x
                        break;
                    case 2:
                        y = 3 * x / x; // 3x/x = 3
                        break;
                    case 3:
                        y = Math.sin(x) / x;
                        break;
                }
                
                if (!isNaN(y) && y >= 0 && y <= 3) {
                    const pixelX2 = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY2 = height - ((y - 0) / (3 - 0) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX2, pixelY2);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX2, pixelY2);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ·»åŠ æ¯”å€¼æ ‡ç­¾
            ctx.fillStyle = '#0f9d58';
            ctx.font = 'bold 12px Arial';
            ctx.fillText('Î²/Î±', width - 80, 70);
        }
        
        function changeInfinitesimalComparison(type) {
            infinitesimalType = type;
            updateInfinitesimalGraph();
        }
        
        function startInfinitesimalAnimation() {
            const slider = document.getElementById('infinitesimalSlider');
            let value = 100;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateInfinitesimalGraph();
                value -= 1;
                
                if (value < 1) {
                    clearInterval(interval);
                    console.log("æ— ç©·å°æ¯”è¾ƒåŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== è¿ç»­æ€§å¯è§†åŒ– ====================
        function updateContinuityGraph() {
            const slider = document.getElementById('continuitySlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 10;
            
            if (document.getElementById('xContinuitySliderValue')) {
                document.getElementById('xContinuitySliderValue').textContent = xValue.toFixed(1);
            }
            
            let fx, isContinuous, discontinuityType, checkPoint;
            
            switch(continuityType) {
                case 1: // f(x)=xÂ² è¿ç»­
                    fx = xValue * xValue;
                    isContinuous = "æ˜¯";
                    discontinuityType = "æ— ";
                    checkPoint = "0";
                    break;
                case 2: // f(x)=1/x åœ¨x=0é—´æ–­
                    if (Math.abs(xValue) > 0.001) {
                        fx = 1 / xValue;
                    } else {
                        fx = NaN;
                    }
                    isContinuous = xValue === 0 ? "å¦" : "æ˜¯";
                    discontinuityType = xValue === 0 ? "ç¬¬äºŒç±»é—´æ–­ç‚¹" : "æ— ";
                    checkPoint = "0";
                    break;
                case 3: // åˆ†æ®µå‡½æ•°ï¼Œå¯å»é—´æ–­
                    if (xValue !== 0) {
                        fx = Math.sin(xValue) / xValue;
                    } else {
                        fx = 1; // å¯å»é—´æ–­ç‚¹ï¼Œè¡¥å……å®šä¹‰
                    }
                    isContinuous = "æ˜¯"; // è¡¥å……å®šä¹‰åè¿ç»­
                    discontinuityType = "å¯å»é—´æ–­ç‚¹ï¼ˆå·²è¡¥å……ï¼‰";
                    checkPoint = "0";
                    break;
            }
            
            if (document.getElementById('xValueContinuity')) {
                document.getElementById('xValueContinuity').textContent = xValue.toFixed(1);
            }
            if (document.getElementById('fxValueContinuity')) {
                document.getElementById('fxValueContinuity').textContent = isNaN(fx) ? "âˆ" : fx.toFixed(3);
            }
            if (document.getElementById('isContinuous')) {
                document.getElementById('isContinuous').textContent = isContinuous;
            }
            if (document.getElementById('discontinuityType')) {
                document.getElementById('discontinuityType').textContent = discontinuityType;
            }
            if (document.getElementById('checkPoint')) {
                document.getElementById('checkPoint').textContent = checkPoint;
            }
            
            drawContinuityGraph(xValue, fx, continuityType);
        }
        
        function drawContinuityGraph(xValue, fx, continuityType) {
            if (!continuityCtx) return;
            
            const canvas = document.getElementById('continuityCanvas');
            const ctx = continuityCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -2;
            const xMax = 2;
            const yMin = -2;
            const yMax = 2;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            ctx.strokeStyle = '#4285f4';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(continuityType) {
                    case 1:
                        y = x * x;
                        break;
                    case 2:
                        if (Math.abs(x) > 0.001) {
                            y = 1 / x;
                        } else {
                            continue; // è·³è¿‡x=0é™„è¿‘
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.001) {
                            y = Math.sin(x) / x;
                        } else {
                            y = 1; // è¡¥å……å®šä¹‰
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶é—´æ–­ç‚¹æ ‡è®°
            if (continuityType === 2) {
                // åœ¨x=0å¤„ç»˜åˆ¶ç©ºå¿ƒåœ†è¡¨ç¤ºé—´æ–­
                const pixelX = (0 - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height / 2; // yè½´ä¸­å¿ƒ
                
                ctx.strokeStyle = '#ff4081';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 8, 0, Math.PI * 2);
                ctx.stroke();
                
                // æ·»åŠ æ ‡ç­¾
                ctx.fillStyle = '#ff4081';
                ctx.font = 'bold 12px Arial';
                ctx.fillText('é—´æ–­ç‚¹', pixelX + 10, pixelY - 10);
            }
            
            if (continuityType === 3) {
                // åœ¨x=0å¤„ç»˜åˆ¶å®å¿ƒåœ†è¡¨ç¤ºå¯å»é—´æ–­ï¼ˆå·²è¡¥å……ï¼‰
                const pixelX = (0 - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height - ((1 - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                ctx.fillStyle = '#0f9d58';
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                ctx.fill();
                
                // æ·»åŠ æ ‡ç­¾
                ctx.fillStyle = '#0f9d58';
                ctx.font = 'bold 12px Arial';
                ctx.fillText('å¯å»é—´æ–­ç‚¹', pixelX + 10, pixelY - 10);
            }
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(fx) && fx >= yMin && fx <= yMax) {
                const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
                const pixelY = height - ((fx - yMin) / (yMax - yMin) * (height - 100) + 50);
                
                ctx.fillStyle = '#0f9d58';
                ctx.beginPath();
                ctx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function changeContinuityFunction(type) {
            continuityType = type;
            updateContinuityGraph();
        }
        
        function startContinuityAnimation() {
            const slider = document.getElementById('continuitySlider');
            let value = -50;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateContinuityGraph();
                value += 1;
                
                if (value > 50) {
                    clearInterval(interval);
                    console.log("è¿ç»­æ€§åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== è¿ç»­è¿ç®—å¯è§†åŒ– ====================
        function updateContinuousOperationsGraph() {
            const slider = document.getElementById('continuousOperationsSlider');
            if (!slider) return;
            
            const xValue = parseFloat(slider.value) / 10;
            
            if (document.getElementById('xContinuousSliderValue')) {
                document.getElementById('xContinuousSliderValue').textContent = xValue.toFixed(1);
            }
            
            let fValue, gValue, result, opType, continuousPoint;
            
            switch(continuousOpType) {
                case 1: // åŠ æ³•
                    fValue = Math.sin(xValue);
                    gValue = Math.cos(xValue);
                    result = fValue + gValue;
                    opType = "åŠ æ³•";
                    continuousPoint = "x=0";
                    break;
                case 2: // ä¹˜æ³•
                    fValue = xValue;
                    gValue = Math.exp(xValue);
                    result = fValue * gValue;
                    opType = "ä¹˜æ³•";
                    continuousPoint = "x=0";
                    break;
                case 3: // å¤åˆ
                    fValue = Math.sin(xValue);
                    gValue = xValue * xValue;
                    result = Math.sin(xValue * xValue);
                    opType = "å¤åˆ";
                    continuousPoint = "x=0";
                    break;
                case 4: // é™¤æ³•
                    fValue = Math.sin(xValue);
                    gValue = xValue;
                    if (Math.abs(xValue) > 0.001) {
                        result = fValue / gValue;
                    } else {
                        result = 1; // lim sin(x)/x = 1
                    }
                    opType = "é™¤æ³•";
                    continuousPoint = "xâ‰ 0";
                    break;
            }
            
            if (document.getElementById('continuousOpType')) {
                document.getElementById('continuousOpType').textContent = opType;
            }
            if (document.getElementById('fValueContinuous')) {
                document.getElementById('fValueContinuous').textContent = fValue.toFixed(3);
            }
            if (document.getElementById('gValueContinuous')) {
                document.getElementById('gValueContinuous').textContent = gValue.toFixed(3);
            }
            if (document.getElementById('resultValueContinuous')) {
                document.getElementById('resultValueContinuous').textContent = result.toFixed(3);
            }
            if (document.getElementById('continuousPoint')) {
                document.getElementById('continuousPoint').textContent = continuousPoint;
            }
            
            drawContinuousOperationsGraph(xValue, fValue, gValue, result, continuousOpType);
        }
        
        function drawContinuousOperationsGraph(xValue, fValue, gValue, result, opType) {
            if (!continuousOperationsCtx) return;
            
            const canvas = document.getElementById('continuousOperationsCanvas');
            const ctx = continuousOperationsCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -3;
            const xMax = 3;
            const yMin = -2;
            const yMax = 2;
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            const functions = [
                {color: '#4285f4', value: fValue, name: 'f(x)'},
                {color: '#0f9d58', value: gValue, name: 'g(x)'},
                {color: '#ff4081', value: result, name: 'f op g'}
            ];
            
            functions.forEach(func => {
                ctx.strokeStyle = func.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const step = (xMax - xMin) / 100;
                let firstPoint = true;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(opType) {
                        case 1: // åŠ æ³•
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = Math.cos(x);
                            else y = Math.sin(x) + Math.cos(x);
                            break;
                        case 2: // ä¹˜æ³•
                            if (func.name === 'f(x)') y = x;
                            else if (func.name === 'g(x)') y = Math.exp(x);
                            else y = x * Math.exp(x);
                            break;
                        case 3: // å¤åˆ
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = x * x;
                            else y = Math.sin(x * x);
                            break;
                        case 4: // é™¤æ³•
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = x;
                            else {
                                if (Math.abs(x) > 0.001) y = Math.sin(x) / x;
                                else y = 1;
                            }
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                        const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                        
                        if (firstPoint) {
                            ctx.moveTo(pixelX, pixelY);
                            firstPoint = false;
                        } else {
                            ctx.lineTo(pixelX, pixelY);
                        }
                    } else {
                        firstPoint = true;
                    }
                }
                ctx.stroke();
                
                // æ·»åŠ å‡½æ•°æ ‡ç­¾
                ctx.fillStyle = func.color;
                ctx.font = 'bold 12px Arial';
                if (func.name === 'f(x)') {
                    ctx.fillText(func.name, width - 80, 30);
                } else if (func.name === 'g(x)') {
                    ctx.fillText(func.name, width - 80, 50);
                } else {
                    ctx.fillText(func.name, width - 80, 70);
                }
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [fValue, gValue, result];
            const pixelX = (xValue - xMin) / (xMax - xMin) * (width - 100) + 50;
            
            functions.forEach((func, index) => {
                const y = values[index];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    ctx.fillStyle = func.color;
                    ctx.beginPath();
                    ctx.arc(pixelX, pixelY, 5, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
        }
        
        function changeContinuousOperation(type) {
            continuousOpType = type;
            updateContinuousOperationsGraph();
        }
        
        function startContinuousOpAnimation() {
            const slider = document.getElementById('continuousOperationsSlider');
            let value = -50;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateContinuousOperationsGraph();
                value += 2;
                
                if (value > 50) {
                    clearInterval(interval);
                    console.log("è¿ç»­è¿ç®—åŠ¨ç”»å®Œæˆ");
                }
            }, 100);
        }
        
        // ==================== é—­åŒºé—´æ€§è´¨å¯è§†åŒ– ====================
        function updateClosedIntervalGraph() {
            const aSlider = document.getElementById('intervalASlider');
            const bSlider = document.getElementById('intervalBSlider');
            
            if (!aSlider || !bSlider) return;
            
            // å°†æ»‘å—å€¼æ˜ å°„åˆ°å®é™…åŒºé—´å€¼
            let a, b;
            const aRatio = parseFloat(aSlider.value) / 100;
            const bRatio = parseFloat(bSlider.value) / 100;
            
            switch(closedIntervalType) {
                case 1: // f(x)=sin xï¼ŒåŒºé—´[0, 2Ï€]
                    a = aRatio * 2 * Math.PI;
                    b = bRatio * 2 * Math.PI;
                    if (a > b) [a, b] = [b, a]; // ç¡®ä¿aâ‰¤b
                    break;
                case 2: // f(x)=xÂ²-2x+1ï¼ŒåŒºé—´[-2, 4]
                    a = -2 + aRatio * 6;
                    b = -2 + bRatio * 6;
                    if (a > b) [a, b] = [b, a];
                    break;
                case 3: // f(x)=xÂ³-3xï¼ŒåŒºé—´[-2, 2]
                    a = -2 + aRatio * 4;
                    b = -2 + bRatio * 4;
                    if (a > b) [a, b] = [b, a];
                    break;
            }
            
            if (document.getElementById('intervalASliderValue')) {
                document.getElementById('intervalASliderValue').textContent = a.toFixed(2);
            }
            if (document.getElementById('intervalBSliderValue')) {
                document.getElementById('intervalBSliderValue').textContent = b.toFixed(2);
            }
            
            // è®¡ç®—åŒºé—´ä¸Šçš„æ€§è´¨
            let intervalStr = `[${a.toFixed(2)}, ${b.toFixed(2)}]`;
            let minValue = Infinity, maxValue = -Infinity;
            let zeroPoints = [];
            
            // é‡‡æ ·è®¡ç®—æœ€å°å€¼å’Œæœ€å¤§å€¼
            const step = (b - a) / 100;
            for (let x = a; x <= b; x += step) {
                let y;
                switch(closedIntervalType) {
                    case 1: y = Math.sin(x); break;
                    case 2: y = x * x - 2 * x + 1; break;
                    case 3: y = x * x * x - 3 * x; break;
                }
                
                minValue = Math.min(minValue, y);
                maxValue = Math.max(maxValue, y);
                
                // è¿‘ä¼¼æ‰¾é›¶ç‚¹
                if (Math.abs(y) < 0.1) {
                    const roundedX = Math.round(x * 10) / 10;
                    if (!zeroPoints.includes(roundedX) && zeroPoints.length < 5) {
                        zeroPoints.push(roundedX);
                    }
                }
            }
            
            if (zeroPoints.length === 0) {
                zeroPoints = ["æ— "];
            }
            
            if (document.getElementById('intervalValue')) {
                document.getElementById('intervalValue').textContent = intervalStr;
            }
            if (document.getElementById('minValue')) {
                document.getElementById('minValue').textContent = minValue.toFixed(2);
            }
            if (document.getElementById('maxValue')) {
                document.getElementById('maxValue').textContent = maxValue.toFixed(2);
            }
            if (document.getElementById('zeroPoints')) {
                document.getElementById('zeroPoints').textContent = zeroPoints.join(", ");
            }
            
            drawClosedIntervalGraph(a, b, closedIntervalType);
        }
        
        function drawClosedIntervalGraph(a, b, functionType) {
            if (!closedIntervalCtx) return;
            
            const canvas = document.getElementById('closedIntervalCanvas');
            const ctx = closedIntervalCtx;
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax, yMin, yMax;
            
            switch(functionType) {
                case 1: // sin x
                    xMin = -1;
                    xMax = 2 * Math.PI + 1;
                    yMin = -1.5;
                    yMax = 1.5;
                    break;
                case 2: // xÂ²-2x+1
                    xMin = -3;
                    xMax = 5;
                    yMin = -2;
                    yMax = 10;
                    break;
                case 3: // xÂ³-3x
                    xMin = -3;
                    xMax = 3;
                    yMin = -3;
                    yMax = 3;
                    break;
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            ctx.strokeStyle = '#4285f4';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(functionType) {
                    case 1: y = Math.sin(x); break;
                    case 2: y = x * x - 2 * x + 1; break;
                    case 3: y = x * x * x - 3 * x; break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶åŒºé—´[a,b]
            const pixelA = (a - xMin) / (xMax - xMin) * (width - 100) + 50;
            const pixelB = (b - xMin) / (xMax - xMin) * (width - 100) + 50;
            
            // ç»˜åˆ¶åŒºé—´èƒŒæ™¯
            ctx.fillStyle = 'rgba(66, 133, 244, 0.1)';
            ctx.fillRect(pixelA, 50, pixelB - pixelA, height - 100);
            
            // ç»˜åˆ¶åŒºé—´è¾¹ç•Œçº¿
            ctx.strokeStyle = '#ff4081';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(pixelA, 50);
            ctx.lineTo(pixelA, height - 50);
            ctx.moveTo(pixelB, 50);
            ctx.lineTo(pixelB, height - 50);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ·»åŠ åŒºé—´æ ‡ç­¾
            ctx.fillStyle = '#ff4081';
            ctx.font = 'bold 12px Arial';
            ctx.fillText('a', pixelA - 10, height - 30);
            ctx.fillText('b', pixelB - 10, height - 30);
            
            // ç»˜åˆ¶åŒºé—´å†…çš„å‡½æ•°æ›²çº¿ï¼ˆç”¨æ›´ç²—çš„çº¿ï¼‰
            ctx.strokeStyle = '#0f9d58';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            firstPoint = true;
            const intervalStep = (b - a) / 100;
            
            for (let x = a; x <= b; x += intervalStep) {
                let y;
                
                switch(functionType) {
                    case 1: y = Math.sin(x); break;
                    case 2: y = x * x - 2 * x + 1; break;
                    case 3: y = x * x * x - 3 * x; break;
                }
                
                if (!isNaN(y)) {
                    const pixelX = (x - xMin) / (xMax - xMin) * (width - 100) + 50;
                    const pixelY = height - ((y - yMin) / (yMax - yMin) * (height - 100) + 50);
                    
                    if (firstPoint) {
                        ctx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(pixelX, pixelY);
                    }
                }
            }
            ctx.stroke();
        }
        
        function changeClosedIntervalFunction(type) {
            closedIntervalType = type;
            updateClosedIntervalGraph();
        }
        
        function startClosedIntervalAnimation() {
            const slider = document.getElementById('intervalASlider');
            let value = 0;
            
            const interval = setInterval(() => {
                slider.value = value;
                updateClosedIntervalGraph();
                value += 1;
                
                if (value > 100) {
                    clearInterval(interval);
                    console.log("é—­åŒºé—´æ€§è´¨åŠ¨ç”»å®Œæˆ");
                }
            }, 50);
        }
        
        // ==================== é€šç”¨å·¥å…·å‡½æ•° ====================
        function drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax, isDiscrete = false) {
            // è®¾ç½®è¾¹è·
            const margin = 50;
            const graphWidth = width - 2 * margin;
            const graphHeight = height - 2 * margin;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            // Xè½´
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();
            
            // Yè½´
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.stroke();
            
            // ç»˜åˆ¶åˆ»åº¦
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            
            // Xè½´åˆ»åº¦
            const xStep = (xMax - xMin) / 10;
            for (let i = 0; i <= 10; i++) {
                const x = xMin + i * xStep;
                const pixelX = margin + (i / 10) * graphWidth;
                
                // åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(pixelX, height - margin);
                ctx.lineTo(pixelX, height - margin + 5);
                ctx.stroke();
                
                // åˆ»åº¦æ ‡ç­¾
                ctx.fillText(x.toFixed(1), pixelX, height - margin + 8);
            }
            
            // Yè½´åˆ»åº¦
            const yStep = (yMax - yMin) / 10;
            for (let i = 0; i <= 10; i++) {
                const y = yMin + i * yStep;
                const pixelY = height - margin - (i / 10) * graphHeight;
                
                // åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(margin, pixelY);
                ctx.lineTo(margin - 5, pixelY);
                ctx.stroke();
                
                // åˆ»åº¦æ ‡ç­¾
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillText(y.toFixed(1), margin - 8, pixelY);
            }
            
            // æ¢å¤æ–‡æœ¬å¯¹é½
            ctx.textAlign = 'left';
            ctx.textBaseline = 'alphabetic';
            
            // æ·»åŠ åæ ‡è½´æ ‡ç­¾
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Arial';
            ctx.fillText(isDiscrete ? 'n' : 'x', width - margin + 10, height - margin + 5);
            ctx.fillText(isDiscrete ? 'aâ‚™' : 'f(x)', margin - 30, margin - 10);
        }
        
        // ==================== ç³»ç»ŸåŠŸèƒ½å‡½æ•° ====================
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                // æ·»åŠ åˆ°å·²å­¦ä¹ ç« èŠ‚
                if (!learnedSections.has(sectionId)) {
                    learnedSections.add(sectionId);
                    updateProgress();
                }
                
                // å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
                const offset = 80;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - offset;
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        }
        
        function updateProgress() {
            const progress = (learnedSections.size / totalSections) * 100;
            const progressFill = document.getElementById('progressFill');
            const progressPercent = document.getElementById('progressPercent');
            
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
            
            if (progressPercent) {
                progressPercent.textContent = `${Math.round(progress)}% (${learnedSections.size}/${totalSections}èŠ‚)`;
            }
        }
        
        function resetProgress() {
            if (confirm("ç¡®å®šè¦é‡ç½®å­¦ä¹ è¿›åº¦å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰å·²å­¦ä¹ çš„ç« èŠ‚è®°å½•ã€‚")) {
                learnedSections.clear();
                learnedSections.add('mapping-function'); // é»˜è®¤ç¬¬ä¸€ç« å·²å­¦ä¹ 
                updateProgress();
                alert("å­¦ä¹ è¿›åº¦å·²é‡ç½®ï¼");
            }
        }
        
        // ==================== å­¦ä¹ è®¡æ—¶å™¨ ====================
        function startTimer() {
            if (timerInterval) return; // é¿å…é‡å¤å¯åŠ¨
            
            timerInterval = setInterval(() => {
                studyTimer++;
                updateTimerDisplay();
            }, 1000);
        }
        
        function pauseTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }
        
        function resetTimer() {
            pauseTimer();
            studyTimer = 0;
            updateTimerDisplay();
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(studyTimer / 3600);
            const minutes = Math.floor((studyTimer % 3600) / 60);
            const seconds = studyTimer % 60;
            
            const timerDisplay = document.getElementById('studyTimer');
            if (timerDisplay) {
                timerDisplay.textContent = 
                    `${hours.toString().padStart(2, '0')}:` +
                    `${minutes.toString().padStart(2, '0')}:` +
                    `${seconds.toString().padStart(2, '0')}`;
            }
        }
        
        // ==================== æ¸¸æˆåŠŸèƒ½ ====================
        function initGameQuestions() {
            gameQuestions = [
                {
                    question: "æé™ lim(xâ†’0) sin(x)/x çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ",
                    options: ["0", "1", "âˆ", "ä¸å­˜åœ¨"],
                    answer: 1
                },
                {
                    question: "ä¸‹åˆ—å“ªä¸ªæ˜¯æ— ç©·å°é‡ï¼Ÿ",
                    options: ["sin(x) (xâ†’0)", "xÂ² (xâ†’âˆ)", "1/x (xâ†’1)", "e^x (xâ†’0)"],
                    answer: 0
                },
                {
                    question: "å‡½æ•° f(x) = 1/x åœ¨ x=0 å¤„çš„é—´æ–­ç‚¹ç±»å‹æ˜¯ï¼Ÿ",
                    options: ["å¯å»é—´æ–­ç‚¹", "è·³è·ƒé—´æ–­ç‚¹", "ç¬¬äºŒç±»é—´æ–­ç‚¹", "è¿ç»­ç‚¹"],
                    answer: 2
                },
                {
                    question: "å¤¹é€¼å‡†åˆ™åˆç§°ä¸ºï¼Ÿ",
                    options: ["ä¸‰æ˜æ²»å®šç†", "å‹¾è‚¡å®šç†", "ä¸­å€¼å®šç†", "ç½—å°”å®šç†"],
                    answer: 0
                },
                {
                    question: "lim(xâ†’âˆ) (1+1/x)^x ç­‰äºï¼Ÿ",
                    options: ["0", "1", "e", "âˆ"],
                    answer: 2
                },
                {
                    question: "ä¸‹åˆ—å“ªä¸ªå‡½æ•°åœ¨ x=0 å¤„è¿ç»­ï¼Ÿ",
                    options: ["f(x)=1/x", "f(x)=|x|", "f(x)=1/xÂ²", "f(x)=tan(x)"],
                    answer: 1
                },
                {
                    question: "è‹¥ lim f(x)=A, lim g(x)=Bï¼Œåˆ™ lim[f(x)+g(x)] ç­‰äºï¼Ÿ",
                    options: ["A+B", "A-B", "AÃ—B", "A/B"],
                    answer: 0
                },
                {
                    question: "é—­åŒºé—´ä¸Šè¿ç»­å‡½æ•°ä¸€å®šå…·æœ‰çš„æ€§è´¨æ˜¯ï¼Ÿ",
                    options: ["æœ‰ç•Œæ€§", "å•è°ƒæ€§", "å¯å¯¼æ€§", "å‘¨æœŸæ€§"],
                    answer: 0
                },
                {
                    question: "å½“ xâ†’0 æ—¶ï¼ŒxÂ² æ˜¯ x çš„ä»€ä¹ˆæ— ç©·å°ï¼Ÿ",
                    options: ["é«˜é˜¶æ— ç©·å°", "ä½é˜¶æ— ç©·å°", "åŒé˜¶æ— ç©·å°", "ç­‰ä»·æ— ç©·å°"],
                    answer: 0
                },
                {
                    question: "å‡½æ•° f(x) åœ¨ç‚¹ xâ‚€ è¿ç»­çš„å®šä¹‰æ˜¯ï¼Ÿ",
                    options: ["lim f(x) = f(xâ‚€) (xâ†’xâ‚€)", "f'(xâ‚€) å­˜åœ¨", "f(x) åœ¨ xâ‚€ æœ‰å®šä¹‰", "f(x) åœ¨ xâ‚€ å¯å¯¼"],
                    answer: 0
                }
            ];
        }
        
        function startGame() {
            gameActive = true;
            currentGameQuestion = 0;
            gameScore = 0;
            userGameAnswer = null;
            
            // æ˜¾ç¤ºæ¸¸æˆåˆ†æ•°é¢æ¿
            const gameScoreElement = document.getElementById('gameScore');
            if (gameScoreElement) {
                gameScoreElement.style.display = 'block';
            }
            
            // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
            updateGameScore();
            
            // æ˜¾ç¤ºç¬¬ä¸€ä¸ªé—®é¢˜
            showGameQuestion();
            
            // æ˜¾ç¤ºæ¸¸æˆæ¨¡æ€æ¡†
            const gameModal = document.getElementById('gameModal');
            if (gameModal) {
                gameModal.style.display = 'flex';
            }
        }
        
        function showGameQuestion() {
            if (currentGameQuestion >= gameQuestions.length) {
                endGame();
                return;
            }
            
            const question = gameQuestions[currentGameQuestion];
            const gameQuestionElement = document.getElementById('gameQuestion');
            const gameOptionsElement = document.getElementById('gameOptions');
            
            if (gameQuestionElement) {
                gameQuestionElement.textContent = `é—®é¢˜ ${currentGameQuestion + 1}/${gameQuestions.length}: ${question.question}`;
            }
            
            if (gameOptionsElement) {
                gameOptionsElement.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.style.marginBottom = '10px';
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = 'gameAnswer';
                    radioInput.value = index;
                    radioInput.id = `option${index}`;
                    radioInput.onclick = () => {
                        userGameAnswer = index;
                    };
                    
                    const label = document.createElement('label');
                    label.htmlFor = `option${index}`;
                    label.textContent = ` ${String.fromCharCode(65 + index)}. ${option}`;
                    label.style.marginLeft = '5px';
                    label.style.cursor = 'pointer';
                    
                    optionDiv.appendChild(radioInput);
                    optionDiv.appendChild(label);
                    gameOptionsElement.appendChild(optionDiv);
                });
            }
        }
        
        function submitGameAnswer() {
            if (userGameAnswer === null) {
                alert("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼");
                return;
            }
            
            const question = gameQuestions[currentGameQuestion];
            const isCorrect = (userGameAnswer === question.answer);
            
            if (isCorrect) {
                gameScore += 10;
                alert("å›ç­”æ­£ç¡®ï¼ +10åˆ†");
            } else {
                const correctAnswer = String.fromCharCode(65 + question.answer);
                alert(`å›ç­”é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correctAnswer}`);
            }
            
            // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
            updateGameScore();
            
            // ä¸‹ä¸€ä¸ªé—®é¢˜
            currentGameQuestion++;
            userGameAnswer = null;
            
            if (currentGameQuestion < gameQuestions.length) {
                showGameQuestion();
            } else {
                endGame();
            }
        }
        
        function updateGameScore() {
            const currentScoreElement = document.getElementById('currentScore');
            if (currentScoreElement) {
                currentScoreElement.textContent = gameScore;
            }
        }
        
        function endGame() {
            gameActive = false;
            
            let message = `æ¸¸æˆç»“æŸï¼\nä½ çš„æœ€ç»ˆå¾—åˆ†æ˜¯ï¼š${gameScore}/${gameQuestions.length * 10}\n`;
            
            if (gameScore === gameQuestions.length * 10) {
                message += "å¤ªæ£’äº†ï¼ä½ æ˜¯ä¸€ä¸ªé«˜æ•°å¤©æ‰ï¼ğŸ‰";
            } else if (gameScore >= gameQuestions.length * 7) {
                message += "å¾ˆå¥½ï¼ä½ å¯¹æé™ä¸è¿ç»­æŒæ¡å¾—å¾ˆä¸é”™ï¼ğŸ‘";
            } else if (gameScore >= gameQuestions.length * 5) {
                message += "ä¸é”™ï¼ç»§ç»­åŠªåŠ›ï¼Œä½ å¯ä»¥åšå¾—æ›´å¥½ï¼ğŸ’ª";
            } else {
                message += "ç»§ç»­å­¦ä¹ ï¼Œä¸‹æ¬¡ä¸€å®šä¼šæ›´å¥½ï¼ğŸ“š";
            }
            
            alert(message);
            
            // éšè—æ¸¸æˆæ¨¡æ€æ¡†
            const gameModal = document.getElementById('gameModal');
            if (gameModal) {
                gameModal.style.display = 'none';
            }
        }
        
        function exitGameModal() {
            if (gameActive) {
                if (confirm("ç¡®å®šè¦é€€å‡ºæ¸¸æˆå—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚")) {
                    gameActive = false;
                    const gameModal = document.getElementById('gameModal');
                    if (gameModal) {
                        gameModal.style.display = 'none';
                    }
                    
                    // éšè—æ¸¸æˆåˆ†æ•°é¢æ¿
                    const gameScoreElement = document.getElementById('gameScore');
                    if (gameScoreElement) {
                        gameScoreElement.style.display = 'none';
                    }
                }
            } else {
                const gameModal = document.getElementById('gameModal');
                if (gameModal) {
                    gameModal.style.display = 'none';
                }
            }
        }
        
        function exitGame() {
            if (gameActive) {
                if (confirm("ç¡®å®šè¦é€€å‡ºæ¸¸æˆå—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚")) {
                    gameActive = false;
                    
                    // éšè—æ¸¸æˆåˆ†æ•°é¢æ¿
                    const gameScoreElement = document.getElementById('gameScore');
                    if (gameScoreElement) {
                        gameScoreElement.style.display = 'none';
                    }
                    
                    // éšè—æ¸¸æˆæ¨¡æ€æ¡†
                    const gameModal = document.getElementById('gameModal');
                    if (gameModal) {
                        gameModal.style.display = 'none';
                    }
                }
            }
        }
        
        // ==================== å­¦ä¹ èµ„æºåŠŸèƒ½ ====================
        function downloadNotes() {
            alert("ç¬”è®°ä¸‹è½½åŠŸèƒ½å³å°†ä¸Šçº¿ï¼ç›®å‰è¯·ä½¿ç”¨æµè§ˆå™¨çš„æ‰“å°åŠŸèƒ½ä¿å­˜é¡µé¢ã€‚");
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥é“¾æ¥åˆ°PDFæ–‡ä»¶
        }
        
        function viewFormulas() {
            const formulas = `
é«˜ç­‰æ•°å­¦ç¬¬ä¸€ç« å…¬å¼å¤§å…¨ï¼š

1. æé™å®šä¹‰ï¼š
   â€¢ æ•°åˆ—æé™ï¼šâˆ€Îµ>0, âˆƒN>0, å½“n>Næ—¶, |a_n - A| < Îµ
   â€¢ å‡½æ•°æé™ï¼šâˆ€Îµ>0, âˆƒÎ´>0, å½“0<|x-xâ‚€|<Î´æ—¶, |f(x)-A| < Îµ

2. é‡è¦æé™ï¼š
   â€¢ lim(xâ†’0) sin(x)/x = 1
   â€¢ lim(xâ†’âˆ) (1+1/x)^x = e
   â€¢ lim(xâ†’0) (1+x)^{1/x} = e

3. æé™è¿ç®—æ³•åˆ™ï¼š
   â€¢ è‹¥lim f(x)=A, lim g(x)=Bï¼Œåˆ™ï¼š
     - lim[f(x)Â±g(x)] = AÂ±B
     - lim[f(x)Â·g(x)] = AÂ·B
     - lim[f(x)/g(x)] = A/B (Bâ‰ 0)

4. æ— ç©·å°æ¯”è¾ƒï¼ˆÎ±,Î²â†’0ï¼‰ï¼š
   â€¢ é«˜é˜¶ï¼šlim Î²/Î± = 0
   â€¢ åŒé˜¶ï¼šlim Î²/Î± = c â‰  0
   â€¢ ç­‰ä»·ï¼šlim Î²/Î± = 1

5. è¿ç»­æ€§ï¼š
   â€¢ f(x)åœ¨xâ‚€è¿ç»­ â‡” lim(xâ†’xâ‚€) f(x) = f(xâ‚€)
   â€¢ é—­åŒºé—´ä¸Šè¿ç»­å‡½æ•°æ€§è´¨ï¼šæœ‰ç•Œæ€§ã€æœ€å€¼å®šç†ã€é›¶ç‚¹å®šç†

æç¤ºï¼šè¿™äº›å…¬å¼å·²åœ¨æœ¬å­¦ä¹ ç³»ç»Ÿä¸­é€šè¿‡äº¤äº’å¼å›¾å½¢è¿›è¡Œäº†å¯è§†åŒ–å±•ç¤ºã€‚
            `;
            
            alert(formulas);
        }
        
        function showCommonMistakes() {
            const mistakes = `
å¸¸è§é”™è¯¯ä¸æ³¨æ„äº‹é¡¹ï¼š

1. æé™è®¡ç®—é”™è¯¯ï¼š
   â€¢ é”™è¯¯ï¼šlim(xâ†’0) sin(x)/x = 0
   â€¢ æ­£ç¡®ï¼šlim(xâ†’0) sin(x)/x = 1

2. æ— ç©·å°æ¯”è¾ƒæ··æ·†ï¼š
   â€¢ é”™è¯¯ï¼šxÂ²æ˜¯xçš„ä½é˜¶æ— ç©·å°
   â€¢ æ­£ç¡®ï¼šxÂ²æ˜¯xçš„é«˜é˜¶æ— ç©·å°ï¼ˆxâ†’0æ—¶ï¼‰

3. è¿ç»­æ€§ä¸å¯å¯¼æ€§æ··æ·†ï¼š
   â€¢ é”™è¯¯ï¼šè¿ç»­ä¸€å®šå¯å¯¼
   â€¢ æ­£ç¡®ï¼šè¿ç»­ä¸ä¸€å®šå¯å¯¼ï¼ˆå¦‚f(x)=|x|åœ¨x=0å¤„ï¼‰

4. æé™è¿ç®—é¡ºåºé”™è¯¯ï¼š
   â€¢ é”™è¯¯ï¼šå…ˆæ±‚æé™å†è®¡ç®—
   â€¢ æ­£ç¡®ï¼šå…ˆåŒ–ç®€å†æ±‚æé™

5. å¤¹é€¼å‡†åˆ™åº”ç”¨é”™è¯¯ï¼š
   â€¢ é”™è¯¯ï¼šä¸ç­‰å…³ç³»ä¸æˆç«‹å°±ä½¿ç”¨å¤¹é€¼
   â€¢ æ­£ç¡®ï¼šå¿…é¡»ç¡®ä¿g(x)â‰¤f(x)â‰¤h(x)

å­¦ä¹ å»ºè®®ï¼šå¤šåšç»ƒä¹ ï¼Œæ³¨æ„æ¦‚å¿µç»†èŠ‚ï¼Œå–„ç”¨å¯è§†åŒ–å·¥å…·ç†è§£æŠ½è±¡æ¦‚å¿µã€‚
            `;
            
            alert(mistakes);
        }
        
        function showExamTips() {
            const tips = `
è€ƒè¯•æŠ€å·§ä¸å¤‡è€ƒå»ºè®®ï¼š

1. é‡ç‚¹æŒæ¡ï¼š
   â€¢ ä¸¤ä¸ªé‡è¦æé™åŠå…¶å˜å½¢
   â€¢ Îµ-Î´è¯­è¨€ç†è§£ä¸åº”ç”¨
   â€¢ æ— ç©·å°çš„æ¯”è¾ƒä¸ç­‰ä»·æ›¿æ¢
   â€¢ è¿ç»­æ€§çš„åˆ¤å®šä¸é—´æ–­ç‚¹åˆ†ç±»

2. è§£é¢˜æŠ€å·§ï¼š
   â€¢ é‡åˆ°å¤æ‚æé™å…ˆå°è¯•åŒ–ç®€
   â€¢ æ³¨æ„å‡½æ•°çš„å®šä¹‰åŸŸ
   â€¢ åˆ©ç”¨å¤¹é€¼å‡†åˆ™å¤„ç†å¤æ‚æé™
   â€¢ åˆ†æ®µå‡½æ•°æ³¨æ„åˆ†æ®µç‚¹

3. å¸¸è§é¢˜å‹ï¼š
   â€¢ æé™è®¡ç®—é¢˜ï¼ˆå 30%-40%ï¼‰
   â€¢ è¿ç»­æ€§åˆ¤æ–­é¢˜ï¼ˆå 20%-30%ï¼‰
   â€¢ è¯æ˜é¢˜ï¼ˆå 20%-30%ï¼‰
   â€¢ åº”ç”¨é¢˜ï¼ˆå 10%-20%ï¼‰

4. æ—¶é—´åˆ†é…ï¼š
   â€¢ é€‰æ‹©é¢˜ï¼š1-2åˆ†é’Ÿ/é¢˜
   â€¢ è®¡ç®—é¢˜ï¼š5-10åˆ†é’Ÿ/é¢˜
   â€¢ è¯æ˜é¢˜ï¼š10-15åˆ†é’Ÿ/é¢˜

5. å¤ä¹ å»ºè®®ï¼š
   â€¢ æ¯å‘¨å¤ä¹ 2-3æ¬¡ï¼Œæ¯æ¬¡1-2å°æ—¶
   â€¢ é‡ç‚¹ç†è§£æ¦‚å¿µï¼Œä¸åªæ˜¯è®°å…¬å¼
   â€¢ å®Œæˆè¶³å¤Ÿæ•°é‡çš„ç»ƒä¹ é¢˜
   â€¢ é”™é¢˜æ•´ç†ï¼Œå®šæœŸå›é¡¾

ç¥ä½ è€ƒè¯•é¡ºåˆ©ï¼Œå–å¾—å¥½æˆç»©ï¼ğŸ“
            `;
            
            alert(tips);
        }
        
        // ==================== é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ– ====================
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>