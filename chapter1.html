<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ•°ç¬¬ä¸€ç« ï¼šæé™ä¸è¿ç»­ - è®©æ•°å­¦ä¸å†"æé™"ä½ çš„æƒ³è±¡åŠ›ï¼</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ - æ›´æ´»æ³¼çš„é…è‰² */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #5d6afb;
            --secondary: #20c997;
            --accent: #ff6b9d;
            --dark: #2d3436;
            --light: #f8f9fa;
            --gray: #6c757d;
            --warning: #ffc107;
            --danger: #ff4757;
            --success: #2ed573;
            --info: #17a2b8;
            --fun-blue: #00cec9;
            --fun-purple: #a29bfe;
            --fun-orange: #fd9644;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* å¤´éƒ¨æ ·å¼ - æ›´æ´»æ³¼ */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--fun-purple) 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-bottom: 8px solid var(--accent);
        }
        
        .math-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.08;
            font-size: 2.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            pointer-events: none;
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) translateX(0px); }
            25% { transform: translateY(-10px) translateX(10px); }
            50% { transform: translateY(0px) translateX(0px); }
            75% { transform: translateY(10px) translateX(-10px); }
            100% { transform: translateY(0px) translateX(0px); }
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.95;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            font-weight: bold;
        }
        
        .emoji {
            font-size: 2.5rem;
            vertical-align: middle;
            margin: 0 10px;
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            gap: 25px;
        }
        
        /* ä¸»è¦å†…å®¹åŒº */
        .main-content {
            flex: 1;
            min-width: 0;
        }
        
        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 350px;
            flex-shrink: 0;
        }
        
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
        }
        
        /* çŸ¥è¯†ç‚¹ç« èŠ‚æ ·å¼ - æ›´å¡é€šåŒ– */
        .chapter-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 35px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-left: 8px solid var(--primary);
            border-right: 8px solid transparent;
            transition: transform 0.4s, box-shadow 0.4s;
            position: relative;
            overflow: hidden;
        }
        
        .chapter-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent), var(--secondary));
        }
        
        .chapter-section:hover {
            transform: translateY(-8px) scale(1.005);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .chapter-section h2 {
            color: var(--primary);
            margin-bottom: 25px;
            font-size: 1.9rem;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 10px;
            border-bottom: 3px dashed var(--fun-blue);
        }
        
        .marker-anchor {
            position: relative;
            top: -100px;
            visibility: hidden;
        }
        
        /* çŸ¥è¯†å¡ç‰‡ */
        .knowledge-card {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 6px solid var(--secondary);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            position: relative;
        }
        
        .knowledge-card::after {
            content: 'ğŸ’¡';
            position: absolute;
            top: -15px;
            right: -15px;
            font-size: 2rem;
            background: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .knowledge-card h3 {
            color: var(--secondary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.4rem;
        }
        
        .formula-box {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            font-family: 'Cambria Math', serif;
            overflow-x: auto;
            border: 2px solid var(--fun-blue);
            position: relative;
        }
        
        .formula-box::before {
            content: 'ğŸ§®';
            position: absolute;
            top: -15px;
            left: 20px;
            font-size: 1.5rem;
            background: white;
            padding: 0 10px;
        }
        
        /* å›¾å½¢å®¹å™¨ */
        .graph-container {
            background: #f8f9fa;
            border-radius: 18px;
            padding: 25px;
            margin-top: 30px;
            border: 3px solid #dee2e6;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .graph-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .graph-display-area {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .graph-canvas-container {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid var(--fun-blue);
        }
        
        canvas {
            display: block;
            border-radius: 10px;
            background: white;
            width: 100%;
            height: 280px;
        }
        
        .graph-info {
            flex: 0 0 220px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .info-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
            border-left: 4px solid var(--info);
        }
        
        .info-item:hover {
            transform: translateY(-3px);
        }
        
        .info-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .info-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        /* æ»‘å—æ§ä»¶ */
        .slider-container {
            margin-bottom: 25px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 1rem;
            color: var(--gray);
            font-weight: bold;
        }
        
        .slider {
            width: 100%;
            height: 12px;
            border-radius: 6px;
            background: linear-gradient(90deg, var(--fun-blue), var(--primary));
            outline: none;
            -webkit-appearance: none;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border: 3px solid white;
            transition: all 0.2s;
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: var(--danger);
        }
        
        /* æŒ‰é’®æ ·å¼ - æ›´å¡é€š */
        .graph-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .control-btn, .animation-btn, .link-btn, .game-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1.05rem;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .control-btn::before, .animation-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }
        
        .control-btn:hover::before, .animation-btn:hover::before {
            left: 100%;
        }
        
        .control-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--fun-purple) 100%);
            color: white;
            flex: 1;
            min-width: 170px;
        }
        
        .control-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 25px rgba(66, 133, 244, 0.3);
        }
        
        .animation-btn {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--fun-blue) 100%);
            color: white;
            flex: 2;
        }
        
        .animation-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 25px rgba(15, 157, 88, 0.3);
        }
        
        .stop-btn {
            background: linear-gradient(135deg, var(--danger) 0%, #ff6b6b 100%);
            color: white;
        }
        
        /* ä¾§è¾¹æ ç»„ä»¶ */
        .progress-container, .quick-links, .game-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
            background-clip: padding-box;
            position: relative;
        }
        
        .progress-container {
            border-color: var(--success);
        }
        
        .quick-links {
            border-color: var(--info);
        }
        
        .game-container {
            border-color: var(--warning);
        }
        
        .progress-title, .quick-links-title, .game-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 10px;
            border-bottom: 3px dotted var(--fun-blue);
        }
        
        .progress-bar {
            height: 15px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            border-radius: 10px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-text {
            font-size: 1rem;
            color: var(--gray);
            font-weight: bold;
        }
        
        .links-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .link-btn {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: var(--dark);
            border: 2px solid #dee2e6;
        }
        
        .link-btn:hover {
            background: linear-gradient(135deg, #e9ecef, #dee2e6);
            transform: translateY(-3px) rotate(2deg);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .game-btn {
            background: linear-gradient(135deg, var(--warning) 0%, var(--fun-orange) 100%);
            color: white;
            width: 100%;
        }
        
        .game-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 25px rgba(255, 152, 0, 0.3);
        }
        
        .game-exit-btn {
            background: var(--danger);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .game-exit-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
        }
        
        /* æ¸¸æˆæ¨¡æ€æ¡† */
        .game-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        .game-modal-content {
            background: white;
            border-radius: 25px;
            padding: 40px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 5px solid var(--warning);
            animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* è¾…åŠ©ç±» */
        .highlight {
            color: var(--accent);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .funny-text {
            color: var(--fun-purple);
            font-weight: bold;
            font-style: italic;
        }
        
        .tip-box {
            background: linear-gradient(135deg, #fff9db, #ffec99);
            border: 3px dashed #ffc107;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        
        .tip-box::before {
            content: 'ğŸ’¡ å°è´´å£«';
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #ffc107;
            border: 2px solid #ffc107;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .graph-display-area {
                flex-direction: column;
            }
            
            .graph-info {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .info-item {
                flex: 1;
                min-width: 140px;
            }
            
            .graph-controls {
                flex-direction: column;
            }
            
            .control-btn, .animation-btn {
                min-width: 100%;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .chapter-section h2 {
                font-size: 1.6rem;
            }
            
            .container {
                padding: 15px;
            }
        }
        
        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--primary), var(--fun-purple));
            border-radius: 10px;
            border: 3px solid #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--fun-purple), var(--primary));
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .loader-spinner {
            width: 80px;
            height: 80px;
            border: 10px solid #f3f3f3;
            border-top: 10px solid var(--primary);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ç»ƒä¹ é¢˜ç›®æ ·å¼ */
        .exercise-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 3px solid var(--success);
        }
        
        .exercise-title {
            color: var(--success);
            font-size: 1.5rem;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .exercise-question {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid var(--info);
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .exercise-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 600px) {
            .exercise-options {
                grid-template-columns: 1fr;
            }
        }
        
        .exercise-option {
            padding: 20px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .exercise-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: var(--info);
        }
        
        .exercise-option.selected {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .exercise-option.correct {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-color: var(--success);
            color: var(--success);
        }
        
        .exercise-option.incorrect {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-color: var(--danger);
            color: var(--danger);
        }
        
        .option-letter {
            width: 35px;
            height: 35px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .exercise-feedback {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            margin-top: 20px;
            display: none;
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .feedback-correct {
            color: var(--success);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .feedback-incorrect {
            color: var(--danger);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .exercise-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .exercise-stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
    </style>
</head>
<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loader" id="pageLoader">
        <div class="loader-spinner"></div>
        <h3 style="color: var(--primary); margin-top: 20px;">æ­£åœ¨åŠ è½½é«˜æ•°é­”æ³•...</h3>
        <p style="color: var(--gray); margin-top: 10px;">è®©æ•°å­¦ä¸å†"æé™"ä½ çš„æƒ³è±¡åŠ›ï¼</p>
    </div>
    
    <header>
        <div class="math-bg" id="mathBg">
            lim âˆ« âˆ‘ âˆ âˆš âˆ Ï€ Îµ Î´ âˆ‚ âˆ‡ â†’ â† â†‘ â†“ â†” âˆ´ âˆµ âˆ€ âˆƒ âˆˆ âˆ‰ âŠ‚ âŠƒ âˆª âˆ© âˆ…
        </div>
        <h1>é«˜ç­‰æ•°å­¦ç¬¬ä¸€ç« ï¼šæé™ä¸è¿ç»­ <span class="emoji">ğŸš€</span></h1>
        <p class="subtitle">è®©æŠ½è±¡æ•°å­¦"æ´»"èµ·æ¥çš„äº¤äº’å¼å­¦ä¹ ç³»ç»Ÿ | å‘Šåˆ«æ¯ç‡¥ï¼Œæ‹¥æŠ±ä¹è¶£ï¼</p>
        <p style="margin-top:20px; font-size:1.1rem; opacity:0.95; max-width:800px; margin-left:auto; margin-right:auto; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
            <span style="font-weight:bold;">ğŸ¯ å­¦ä¹ å®£è¨€ï¼š</span> é€šè¿‡<span class="highlight">åŠ¨æ€å›¾å½¢</span>ã€<span class="highlight">äº¤äº’ç»ƒä¹ </span>å’Œ<span class="highlight">æ¸¸æˆåŒ–å­¦ä¹ </span>ï¼Œè®©æŠ½è±¡çš„é«˜æ•°æ¦‚å¿µå˜å¾—åƒåˆ·æŠ–éŸ³ä¸€æ ·ä¸Šå¤´ï¼
        </p>
    </header>
    
    <div class="container">
        <main class="main-content">
            <!-- å¯¼èˆªèœå• -->
            <div class="chapter-section" style="text-align: center; background: linear-gradient(135deg, white, #f0f8ff);">
                <h2><i class="fas fa-compass"></i> æ¬¢è¿æ¥åˆ°é«˜æ•°é­”æ³•ä¸–ç•Œï¼ğŸª</h2>
                <p style="margin-bottom: 20px; font-size: 1.1rem; color: var(--gray);">ä¸‹é¢æ˜¯æˆ‘ä»¬å°†è¦æ¢ç´¢çš„åå¤§æ•°å­¦"ç§˜å¢ƒ"ï¼Œç‚¹å‡»ä»»æ„ç§˜å¢ƒå¼€å§‹å†’é™©ï¼</p>
                <div class="graph-controls" style="background: transparent; border: none; padding: 0;">
                    <button class="control-btn" onclick="scrollToSection('mapping-function')">
                        <i class="fas fa-project-diagram"></i> ç§˜å¢ƒä¸€ï¼šæ˜ å°„ä¸å‡½æ•°
                    </button>
                    <button class="control-btn" onclick="scrollToSection('sequence-limit')">
                        <i class="fas fa-sort-numeric-down"></i> ç§˜å¢ƒäºŒï¼šæ•°åˆ—æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('function-limit')">
                        <i class="fas fa-bullseye"></i> ç§˜å¢ƒä¸‰ï¼šå‡½æ•°æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('limit-criteria')">
                        <i class="fas fa-filter"></i> ç§˜å¢ƒå››ï¼šæé™å‡†åˆ™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('limit-operations')">
                        <i class="fas fa-calculator"></i> ç§˜å¢ƒäº”ï¼šæé™è¿ç®—
                    </button>
                    <button class="control-btn" onclick="scrollToSection('important-limits')">
                        <i class="fas fa-star"></i> ç§˜å¢ƒå…­ï¼šé‡è¦æé™
                    </button>
                    <button class="control-btn" onclick="scrollToSection('infinitesimal-comparison')">
                        <i class="fas fa-balance-scale-left"></i> ç§˜å¢ƒä¸ƒï¼šæ— ç©·å°æ¯”è¾ƒ
                    </button>
                    <button class="control-btn" onclick="scrollToSection('continuity')">
                        <i class="fas fa-link"></i> ç§˜å¢ƒå…«ï¼šè¿ç»­æ€§
                    </button>
                    <button class="control-btn" onclick="scrollToSection('continuous-operations')">
                        <i class="fas fa-cogs"></i> ç§˜å¢ƒä¹ï¼šè¿ç»­è¿ç®—
                    </button>
                    <button class="control-btn" onclick="scrollToSection('closed-interval')">
                        <i class="fas fa-expand-arrows-alt"></i> ç§˜å¢ƒåï¼šé—­åŒºé—´æ€§è´¨
                    </button>
                </div>
                <div class="tip-box" style="margin-top: 25px;">
                    <p><strong>ğŸ® æ¢é™©æŒ‡å—ï¼š</strong> æ¯ä¸ªç§˜å¢ƒéƒ½æœ‰<b>äº’åŠ¨å›¾å½¢</b>ã€<b>çŸ¥è¯†å¡ç‰‡</b>å’Œ<b>æŒ‘æˆ˜ç»ƒä¹ </b>ï¼æ‹–åŠ¨æ»‘å—çœ‹é­”æ³•ï¼Œç‚¹å‡»æŒ‰é’®çœ‹åŠ¨ç”»ï¼Œäº²è‡ªæ“ä½œä½“éªŒæ•°å­¦çš„é­”åŠ›ï¼</p>
                </div>
            </div>
            
            <!-- ä¸€ã€æ˜ å°„ä¸å‡½æ•° -->
            <section id="mapping-function" class="chapter-section">
                <div class="marker-anchor" id="mapping-function-anchor"></div>
                <h2><i class="fas fa-project-diagram"></i> ç§˜å¢ƒä¸€ï¼šæ˜ å°„ä¸å‡½æ•° - æ•°å­¦ä¸–ç•Œçš„"æœ‹å‹åœˆ"å…³ç³»ç½‘</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆå…«å¦ç‰ˆï¼‰</h3>
                    <p><strong>æ˜ å°„ï¼š</strong>å°±åƒå¾®ä¿¡å¥½å‹å…³ç³»ï¼Œæ¯ä¸ªxåªèƒ½å¯¹åº”ä¸€ä¸ªyï¼ˆä¸èƒ½è„šè¸å¤šæ¡èˆ¹å“¦ï¼ï¼‰ï¼Œè¿™å«"ä¸€å¯¹ä¸€"æˆ–"ä¸€å¯¹å¤š"ã€‚</p>
                    <p><strong>å‡½æ•°ï¼š</strong>å®šä¹‰åŸŸå’Œå€¼åŸŸéƒ½æ˜¯å®æ•°é›†çš„æ˜ å°„ï¼Œæ•°å­¦ç‰ˆçš„"å®ååˆ¶"èŠå¤©ï¼æ¯ä¸ªxéƒ½æœ‰å”¯ä¸€çš„yå›å¤ã€‚</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å‡½æ•°å°±åƒè‡ªåŠ¨å”®è´§æœºï¼ŒæŠ•å¸ï¼ˆè¾“å…¥xï¼‰â†’ å‡ºè´§ï¼ˆè¾“å‡ºf(x)ï¼‰ã€‚ä¸èƒ½æŠ•å‡å¸ï¼ˆxä¸åœ¨å®šä¹‰åŸŸï¼‰ï¼Œä¹Ÿä¸ä¼šå‡ºä¸¤ä¸ªä¸œè¥¿ï¼ˆå”¯ä¸€æ€§ï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ f: X \rightarrow Y, \quad x \mapsto y = f(x) $$
                        $$ \text{å®šä¹‰åŸŸï¼ˆèƒ½æŠ•çš„å¸ï¼‰: } D_f = X, \quad \text{å€¼åŸŸï¼ˆèƒ½å‡ºçš„è´§ï¼‰: } R_f = \{f(x) | x \in X\} $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ¤– ç¿»è¯‘ï¼šæœºå™¨fï¼Œåƒxåyã€‚èƒ½åƒçš„æ‰€æœ‰xå«å®šä¹‰åŸŸï¼Œèƒ½åçš„æ‰€æœ‰yå«å€¼åŸŸã€‚</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¯ å‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ– - çœ‹çœ‹å“ªäº›xå€¼èƒ½"æŠ•å¸"æˆåŠŸï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="domainCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueDomain">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="funcValueDomain">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">èƒ½æŠ•å¸å—ï¼Ÿ</div>
                                <div class="info-value" id="inDomain">æ˜¯</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">èƒ½æŠ•çš„å¸ç§</div>
                                <div class="info-value" id="domainRange">[-2,1)âˆª(1,âˆ)</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æ‹–åŠ¨æ»‘å—æŠ•å¸ï¼ˆè°ƒæ•´xå€¼ï¼‰: <span id="xSliderValue" class="highlight">0.0</span></span>
                            <span>å½“å‰å”®è´§æœº: <span id="currentFunction" class="highlight">f(x)=âˆš(x+2)/(x-1)</span></span>
                        </div>
                        <input type="range" min="-30" max="30" value="0" class="slider" id="domainSlider" oninput="updateDomainGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeDomainFunction(1)">
                            <i class="fas fa-chart-line"></i> å”®è´§æœº1: f(x)=âˆš(x+2)/(x-1)
                        </button>
                        <button class="control-btn" onclick="changeDomainFunction(2)">
                            <i class="fas fa-chart-line"></i> å”®è´§æœº2: f(x)=1/(x-2)
                        </button>
                        <button class="control-btn" onclick="changeDomainFunction(3)">
                            <i class="fas fa-chart-line"></i> å”®è´§æœº3: f(x)=ln(x)
                        </button>
                        <button class="animation-btn" id="domainAnimationBtn" onclick="toggleAnimation('domain')">
                            <i class="fas fa-play"></i> <span id="domainAnimationText">è‡ªåŠ¨æŠ•å¸æ¼”ç¤º</span>
                        </button>
                    </div>
                </div>
                
                <!-- å‡½æ•°ç±»å‹ç¤ºä¾‹ -->
                <div class="knowledge-card">
                    <h3><i class="fas fa-bezier-curve"></i> å‡½æ•°ç±»å‹ - æ•°å­¦ç•Œçš„"æ€§æ ¼æµ‹è¯•"</h3>
                    <p><strong>å¥‡å‡½æ•°ï¼š</strong> f(-x) = -f(x)ï¼Œå…³äºåŸç‚¹å¯¹ç§°ï¼Œåƒæ—‹è½¬180Â°é‡åˆï¼Œæ€§æ ¼"å›é€†"ï¼ˆåå¯¹ç§°ï¼‰ã€‚</p>
                    <p><strong>å¶å‡½æ•°ï¼š</strong> f(-x) = f(x)ï¼Œå…³äºyè½´å¯¹ç§°ï¼Œæ€§æ ¼"ä¿å®ˆ"ï¼ˆå¯¹ç§°ï¼‰ã€‚</p>
                    <p><strong>å‘¨æœŸå‡½æ•°ï¼š</strong> å­˜åœ¨Tâ‰ 0ä½¿å¾—f(x+T)=f(x)ï¼Œæ•°å­¦ç•Œçš„"å¤è¯»æœº"ï¼Œé‡å¤æ’­æ”¾ã€‚</p>
                    <p><strong>å•è°ƒæ€§ï¼š</strong> åœ¨åŒºé—´Iä¸Šå•è°ƒé€’å¢ï¼ˆä¸Šè¿›ï¼‰æˆ–é€’å‡ï¼ˆèººå¹³ï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{å¥‡å‡½æ•°ï¼ˆåŸç‚¹å¯¹ç§°çš„å›é€†è€…ï¼‰: } f(-x) = -f(x) $$
                        $$ \text{å¶å‡½æ•°ï¼ˆyè½´å¯¹ç§°çš„ä¿å®ˆè€…ï¼‰: } f(-x) = f(x) $$
                        $$ \text{å‘¨æœŸå‡½æ•°ï¼ˆå¤è¯»æœºï¼‰: } \exists T \neq 0, f(x+T) = f(x) \quad \forall x $$
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°ç±»å‹å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“Š å‡½æ•°æ€§æ ¼æµ‹è¯• - çœ‹çœ‹å‡½æ•°çš„"äººæ ¼"ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="functionTypeCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å‡½æ•°æ€§æ ¼</div>
                                <div class="info-value" id="functionTypeName">å¥‡å‡½æ•°</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="funcValueType">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(-x)å€¼</div>
                                <div class="info-value" id="funcNegValue">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æ€§æ ¼éªŒè¯</div>
                                <div class="info-value" id="parityCheck">é€šè¿‡</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æµ‹è¯•ç‚¹xå€¼: <span id="xTypeSliderValue">0.0</span></span>
                            <span>å¯¹ç§°çº¿: <span id="verticalTestStatus">å¼€å¯</span></span>
                        </div>
                        <input type="range" min="-30" max="30" value="0" class="slider" id="functionTypeSlider" oninput="updateFunctionTypeGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeFunctionType(1)">
                            <i class="fas fa-sync-alt"></i> f(x)=xÂ³ (å›é€†å¥‡å‡½æ•°)
                        </button>
                        <button class="control-btn" onclick="changeFunctionType(2)">
                            <i class="fas fa-expand-arrows-alt"></i> f(x)=xÂ² (ä¿å®ˆå¶å‡½æ•°)
                        </button>
                        <button class="control-btn" onclick="changeFunctionType(3)">
                            <i class="fas fa-redo"></i> f(x)=sin(x) (å¤è¯»å‘¨æœŸå‡½æ•°)
                        </button>
                        <button class="animation-btn" id="functionTypeAnimationBtn" onclick="toggleAnimation('functionType')">
                            <i class="fas fa-play"></i> <span id="functionTypeAnimationText">æ€§æ ¼æ‰«æ</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise1">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒä¸€æŒ‘æˆ˜ï¼šå‡½æ•°"èº«ä»½è¯"æ ¸éªŒ
                    </div>
                    <div id="exercise1Question" class="exercise-question">
                        1. å‡½æ•° f(x)=1/(x-3) çš„"èº«ä»½è¯"ï¼ˆå®šä¹‰åŸŸï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šå°±åƒå“ªäº›äººå¯ä»¥è¿›è¿™ä¸ªå¾®ä¿¡ç¾¤ï¼Ÿ</span>
                    </div>
                    <div class="exercise-options" id="exercise1Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(1)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤æ ¸éªŒ
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(1)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise1Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- äºŒã€æ•°åˆ—æé™ -->
            <section id="sequence-limit" class="chapter-section">
                <div class="marker-anchor" id="sequence-limit-anchor"></div>
                <h2><i class="fas fa-sort-numeric-down"></i> ç§˜å¢ƒäºŒï¼šæ•°åˆ—æé™ - æ— é™æ¥è¿‘çš„"æ‹çˆ±é•¿è·‘"</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆæ‹çˆ±ç‰ˆï¼‰</h3>
                    <p><strong>æ•°åˆ—æé™ï¼š</strong>å½“næ— é™å¢å¤§æ—¶ï¼Œæ•°åˆ—{a_n}æ— é™æ¥è¿‘æŸä¸ªå¸¸æ•°Aï¼Œå°±åƒå•æ‹çš„äººæ— é™æ¥è¿‘å¿ƒä¸Šäººï¼</p>
                    <p><strong>Îµ-Nè¯­è¨€ï¼ˆæ‹çˆ±æ‰¿è¯ºï¼‰ï¼š</strong>"æ— è®ºä½ è¦æ±‚å¤šç²¾ç¡®ï¼ˆÎµå¤šå°ï¼‰ï¼Œæˆ‘éƒ½èƒ½æ‰¾åˆ°æŸä¸ªæ—¶åˆ»ï¼ˆNä¹‹åï¼‰ï¼Œæˆ‘ä»¬çš„è·ç¦»å°äºä½ çš„è¦æ±‚ã€‚"</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒè¿½æ˜Ÿï¼Œnè¶Šå¤§ï¼ˆæ—¶é—´è¶Šä¹…ï¼‰ï¼Œaâ‚™è¶Šæ¥è¿‘æ˜æ˜ŸAï¼ˆæé™ï¼‰ï¼Œä½†å¯èƒ½æ°¸è¿œè¿½ä¸ä¸Šï¼ˆä¸ç­‰äºï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \lim_{n \to \infty} a_n = A \iff \forall \varepsilon > 0, \exists N > 0, \text{å½“} n > N \text{æ—¶}, |a_n - A| < \varepsilon $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ’– ç¿»è¯‘ï¼šæ— è®ºä½ ç»™å¤šå°çš„è¯¯å·®Îµï¼Œæˆ‘éƒ½èƒ½æ‰¾åˆ°ç¬¬Né¡¹ï¼Œä¹‹åæ‰€æœ‰é¡¹éƒ½åœ¨Açš„ÎµèŒƒå›´å†…ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæ•°åˆ—æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“ˆ æ•°åˆ—æé™å¯è§†åŒ–ï¼ša_n= 1 + 1/nï¼ˆæ— é™æ¥è¿‘1çš„æµªæ¼«è¿½æ±‚ï¼‰</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="sequenceCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰ç¬¬né¡¹</div>
                                <div class="info-value" id="nValue">1</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">a_nå€¼</div>
                                <div class="info-value" id="anValue">2.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å¿ƒä¸ŠäººA</div>
                                <div class="info-value" id="limitA">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">è·ç¦»|a_n-A|</div>
                                <div class="info-value" id="differenceValue">1.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´è¿½æ±‚æ—¶é—´n: <span id="nSliderValue">1</span></span>
                            <span>è¦æ±‚ç²¾åº¦Îµ: <span id="epsilonValue">0.5</span></span>
                        </div>
                        <input type="range" min="1" max="50" value="1" class="slider" id="sequenceSlider" oninput="updateSequenceGraph()">
                        <input type="range" min="1" max="20" value="5" class="slider" id="epsilonSlider" oninput="updateSequenceGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeSequence(1)">
                            <i class="fas fa-chart-line"></i> è¿½æ±‚1: a_n = 1 + 1/n
                        </button>
                        <button class="control-btn" onclick="changeSequence(2)">
                            <i class="fas fa-chart-line"></i> è¿½æ±‚2: a_n= (n-1)/n
                        </button>
                        <button class="control-btn" onclick="changeSequence(3)">
                            <i class="fas fa-chart-line"></i> è¿½æ±‚3: a_n= (-1)â¿/n
                        </button>
                        <button class="animation-btn" id="sequenceAnimationBtn" onclick="toggleAnimation('sequence')">
                            <i class="fas fa-play"></i> <span id="sequenceAnimationText">æ‹çˆ±é•¿è·‘åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise2">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒäºŒæŒ‘æˆ˜ï¼šæé™"è¡¨ç™½"æµ‹è¯•
                    </div>
                    <div id="exercise2Question" class="exercise-question">
                        2. æ•°åˆ— a_n= 1/n çš„"å¿ƒä¸Šäºº"ï¼ˆæé™ï¼‰æ˜¯å¤šå°‘ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šéšç€nå¢å¤§ï¼Œ1/nä¼šæ¥è¿‘å“ªä¸ªæ•°ï¼Ÿ</span>
                    </div>
                    <div class="exercise-options" id="exercise2Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(2)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤ç­”æ¡ˆ
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(2)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise2Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- ä¸‰ã€å‡½æ•°æé™ -->
            <section id="function-limit" class="chapter-section">
                <div class="marker-anchor" id="function-limit-anchor"></div>
                <h2><i class="fas fa-bullseye"></i> ç§˜å¢ƒä¸‰ï¼šå‡½æ•°æé™ - xçš„"ç²¾å‡†æŠ•å–‚"ä¹‹æ—…</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆæŠ•å–‚ç‰ˆï¼‰</h3>
                    <p><strong>å‡½æ•°æé™ï¼š</strong>å½“xæ— é™æ¥è¿‘xâ‚€æ—¶ï¼Œf(x)æ— é™æ¥è¿‘æŸä¸ªå¸¸æ•°Aï¼Œå°±åƒç„å‡†é¶å¿ƒï¼</p>
                    <p><strong>Îµ-Î´è¯­è¨€ï¼ˆæŠ•å–‚åè®®ï¼‰ï¼š</strong>"æ— è®ºä½ è¦æ±‚å¤šç²¾ç¡®ï¼ˆÎµï¼‰ï¼Œæˆ‘éƒ½èƒ½æ‰¾åˆ°xçš„ä¸€ä¸ªèŒƒå›´ï¼ˆÎ´ï¼‰ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…ï¼Œf(x)éƒ½èƒ½æ»¡è¶³ä½ çš„ç²¾åº¦è¦æ±‚ã€‚"</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒå–‚å® ç‰©ï¼Œxæ˜¯é£Ÿç‰©ä½ç½®ï¼Œf(x)æ˜¯å® ç‰©ååº”ã€‚åªè¦é£Ÿç‰©è¶³å¤Ÿæ¥è¿‘xâ‚€ï¼ˆè·ç¦»å°äºÎ´ï¼‰ï¼Œå® ç‰©ååº”å°±è¶³å¤Ÿæ¥è¿‘Aï¼ˆè·ç¦»å°äºÎµï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \lim_{x \to x_0} f(x) = A \iff \forall \varepsilon > 0, \exists \delta > 0, \text{å½“} 0 < |x-x_0| < \delta \text{æ—¶}, |f(x) - A| < \varepsilon $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ¯ ç¿»è¯‘ï¼šåªè¦xè¶³å¤Ÿæ¥è¿‘xâ‚€ï¼ˆè·ç¦»å°äºÎ´ï¼‰ï¼Œf(x)å°±ä¼šè¶³å¤Ÿæ¥è¿‘Aï¼ˆè·ç¦»å°äºÎµï¼‰ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå‡½æ•°æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¯ å‡½æ•°æé™å¯è§†åŒ–ï¼šf(x) = xÂ² å½“ xâ†’2ï¼ˆç„å‡†é¶å¿ƒ4ï¼ï¼‰</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="functionLimitCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueLimit">2.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fxValueLimit">4.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">é¶å¿ƒA</div>
                                <div class="info-value" id="limitValue">4.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">|f(x)-A|</div>
                                <div class="info-value" id="limitDiffValue">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼ï¼ˆé£Ÿç‰©ä½ç½®ï¼‰: <span id="xLimitSliderValue">2.0</span></span>
                            <span>è¦æ±‚ç²¾åº¦Îµ: <span id="epsilonLimitValue">0.5</span></span>
                        </div>
                        <input type="range" min="0" max="40" value="20" class="slider" id="xLimitSlider" oninput="updateFunctionLimitGraph()">
                        <input type="range" min="1" max="20" value="10" class="slider" id="epsilonLimitSlider" oninput="updateFunctionLimitGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeFunctionLimit(1)">
                            <i class="fas fa-chart-line"></i> é¶åœº1: f(x) = xÂ² (xâ†’2)
                        </button>
                        <button class="control-btn" onclick="changeFunctionLimit(2)">
                            <i class="fas fa-chart-line"></i> é¶åœº2: f(x) = (xÂ²-1)/(x-1) (xâ†’1)
                        </button>
                        <button class="control-btn" onclick="changeFunctionLimit(3)">
                            <i class="fas fa-chart-line"></i> é¶åœº3: f(x) = sin(1/x) (xâ†’0)
                        </button>
                        <button class="animation-btn" id="functionLimitAnimationBtn" onclick="toggleAnimation('functionLimit')">
                            <i class="fas fa-play"></i> <span id="functionLimitAnimationText">ç„å‡†åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise3">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒä¸‰æŒ‘æˆ˜ï¼šæé™"å°„å‡»"è€ƒæ ¸
                    </div>
                    <div id="exercise3Question" class="exercise-question">
                        3. æé™ lim(xâ†’0) sin(x)/x çš„é¶å¿ƒå€¼æ˜¯å¤šå°‘ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šè¿™æ˜¯é«˜æ•°ç•Œæœ€æœ‰åçš„"ç¥å°„æ‰‹"ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise3Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(3)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤å°„å‡»
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(3)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise3Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- å››ã€æé™å‡†åˆ™ -->
            <section id="limit-criteria" class="chapter-section">
                <div class="marker-anchor" id="limit-criteria-anchor"></div>
                <h2><i class="fas fa-filter"></i> ç§˜å¢ƒå››ï¼šæé™å‡†åˆ™ - æ•°å­¦ç•Œçš„"ä¸‰æ˜æ²»å®šç†"</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆç¾é£Ÿç‰ˆï¼‰</h3>
                    <p><strong>å¤¹é€¼å‡†åˆ™ï¼ˆä¸‰æ˜æ²»å®šç†ï¼‰ï¼š</strong>å¦‚æœå‡½æ•°g(x)â‰¤f(x)â‰¤h(x)ï¼Œä¸”lim g(x)=lim h(x)=Aï¼Œåˆ™lim f(x)=Aã€‚</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒä¸‰æ˜æ²»ï¼Œf(x)è¢«g(x)å’Œh(x)åƒé¢åŒ…ç‰‡ä¸€æ ·å¤¹åœ¨ä¸­é—´ã€‚å¦‚æœä¸¤ç‰‡é¢åŒ…éƒ½æŒ¤å‘Aï¼Œä¸­é—´çš„è‚‰é¥¼f(x)ä¹Ÿåªèƒ½æŒ¤å‘Aã€‚</p>
                    <p><strong>å•è°ƒæœ‰ç•Œå‡†åˆ™ï¼š</strong>å•è°ƒæœ‰ç•Œæ•°åˆ—å¿…æœ‰æé™ï¼Œå°±åƒæ’é˜Ÿä¹°å¥¶èŒ¶ï¼Œé˜Ÿä¼æœ‰åºï¼ˆå•è°ƒï¼‰ä¸”ä¸é•¿ï¼ˆæœ‰ç•Œï¼‰ï¼Œæœ€ç»ˆä¸€å®šèƒ½ä¹°åˆ°ï¼ˆæœ‰æé™ï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{ä¸‰æ˜æ²»å®šç†: } g(x) \le f(x) \le h(x) \text{ ä¸” } \lim g(x) = \lim h(x) = A \Rightarrow \lim f(x) = A $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ¥ª ç¿»è¯‘ï¼šfè¢«gå’Œhå¤¹åœ¨ä¸­é—´ï¼Œgå’Œhéƒ½æŒ¤å‘Aï¼Œfä¹Ÿåªèƒ½æŒ¤å‘Aï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šå¤¹é€¼å‡†åˆ™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ¥ª ä¸‰æ˜æ²»å®šç†å¯è§†åŒ– - çœ‹è‚‰é¥¼å¦‚ä½•è¢«é¢åŒ…ç‰‡"å¤¹"å‘æé™ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="squeezeCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueSqueeze">0.5</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">ä¸‹é¢åŒ…g(x)</div>
                                <div class="info-value" id="gxValue">0.25</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">è‚‰é¥¼f(x)</div>
                                <div class="info-value" id="fxValueSqueeze">0.35</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">ä¸Šé¢åŒ…h(x)</div>
                                <div class="info-value" id="hxValue">0.50</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>æé™å€¼Aï¼ˆç›®æ ‡å‘³é“ï¼‰: <span id="squeezeLimit">0</span></span>
                            <span>è°ƒæ•´xå€¼ï¼ˆä¸‰æ˜æ²»ä½ç½®ï¼‰: <span id="xSqueezeSliderValue">0.5</span></span>
                            
                        </div>
                        <input type="range" min="1" max="100" value="50" class="slider" id="squeezeSlider" oninput="updateSqueezeGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeSqueezeFunction(1)">
                            <i class="fas fa-bullseye"></i> ä¸‰æ˜æ²»1: x sin(1/x)
                        </button>
                        <button class="control-btn" onclick="changeSqueezeFunction(2)">
                            <i class="fas fa-bullseye"></i> ä¸‰æ˜æ²»2: (xÂ²+1)/(xÂ²+2)
                        </button>
                        <button class="control-btn" onclick="changeSqueezeFunction(3)">
                            <i class="fas fa-bullseye"></i> ä¸‰æ˜æ²»3: sin(x)/x
                        </button>
                        <button class="animation-btn" id="squeezeAnimationBtn" onclick="toggleAnimation('squeeze')">
                            <i class="fas fa-play"></i> <span id="squeezeAnimationText">ä¸‰æ˜æ²»åˆ¶ä½œåŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise4">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒå››æŒ‘æˆ˜ï¼šä¸‰æ˜æ²»"å¤¹å‡»"æµ‹è¯•
                    </div>
                    <div id="exercise4Question" class="exercise-question">
                        4. å¤¹é€¼å‡†åˆ™åˆè¢«æˆç§°ä¸ºä»€ä¹ˆå®šç†ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šæƒ³æƒ³f(x)è¢«ä»€ä¹ˆå¤¹åœ¨ä¸­é—´ï¼Ÿ</span>
                    </div>
                    <div class="exercise-options" id="exercise4Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(4)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤ç­”æ¡ˆ
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(4)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise4Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- äº”ã€æé™è¿ç®— -->
            <section id="limit-operations" class="chapter-section">
                <div class="marker-anchor" id="limit-operations-anchor"></div>
                <h2><i class="fas fa-calculator"></i> ç§˜å¢ƒäº”ï¼šæé™è¿ç®— - æ•°å­¦"å››åˆ™è¿ç®—"å‡çº§ç‰ˆ</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆç®—æœ¯ç‰ˆï¼‰</h3>
                    <p><strong>æé™å››åˆ™è¿ç®—æ³•åˆ™ï¼š</strong>è‹¥lim f(x)=A, lim g(x)=Bï¼Œåˆ™æé™å¯ä»¥å’Œæ™®é€šæ•°ä¸€æ ·è¿›è¡Œè¿ç®—ï¼</p>
                    <p>1. lim[f(x)Â±g(x)] = AÂ±B ï¼ˆåŠ æ³•å‡æ³•ï¼Œç®€å•å åŠ ï¼‰</p>
                    <p>2. lim[f(x)Â·g(x)] = AÂ·B ï¼ˆä¹˜æ³•ï¼Œé¢ç§¯ç›¸ä¹˜ï¼‰</p>
                    <p>3. lim[f(x)/g(x)] = A/B ï¼ˆé™¤æ³•ï¼Œä½†è¦Bâ‰ 0ï¼Œä¸èƒ½é™¤ä»¥é›¶ï¼ï¼‰</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒé“¶è¡Œè½¬è´¦ï¼ŒAå’ŒBæ˜¯ä¸¤ä¸ªäººè´¦æˆ·ä½™é¢ï¼Œè¿ç®—å°±æ˜¯è½¬è´¦æ“ä½œã€‚ä½†é™¤æ³•è¦æ³¨æ„å¯¹æ–¹ä¸èƒ½æ˜¯ç©·å…‰è›‹ï¼ˆBâ‰ 0ï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{è‹¥ } \lim f(x) = A, \lim g(x) = B \text{ï¼Œåˆ™ï¼š} $$
                        $$ \lim [f(x) \pm g(x)] = A \pm B, \quad \lim [f(x) \cdot g(x)] = A \cdot B, \quad \lim \frac{f(x)}{g(x)} = \frac{A}{B} (B \neq 0) $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ§® ç¿»è¯‘ï¼šæé™å¯ä»¥åƒæ™®é€šæ•°ä¸€æ ·åŠ å‡ä¹˜é™¤ï¼ˆé™¤æ³•è¦æ³¨æ„åˆ†æ¯ä¸ä¸ºé›¶ï¼‰ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæé™è¿ç®—å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ§® æé™è¿ç®—å¯è§†åŒ– - çœ‹ä¸¤ä¸ªå‡½æ•°å¦‚ä½•"åˆä½œ"å‡ºæ–°æé™ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="limitOperationsCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">è¿ç®—ç±»å‹</div>
                                <div class="info-value" id="operationType">åŠ æ³•</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim f(x)</div>
                                <div class="info-value" id="limitF">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim g(x)</div>
                                <div class="info-value" id="limitG">0.5</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">lim [f op g]</div>
                                <div class="info-value" id="limitResult">1.5</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xOpSliderValue">1.0</span></span>
                            <span>è¶‹è¿‘ç‚¹: <span id="approachPoint">xâ†’2</span></span>
                        </div>
                        <input type="range" min="10" max="100" value="100" class="slider" id="limitOpSlider" oninput="updateLimitOperationsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeLimitOperation(1)">
                            <i class="fas fa-plus"></i> åŠ æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(2)">
                            <i class="fas fa-minus"></i> å‡æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(3)">
                            <i class="fas fa-times"></i> ä¹˜æ³•è¿ç®—
                        </button>
                        <button class="control-btn" onclick="changeLimitOperation(4)">
                            <i class="fas fa-divide"></i> é™¤æ³•è¿ç®—
                        </button>
                        <button class="animation-btn" id="limitOpAnimationBtn" onclick="toggleAnimation('limitOperations')">
                            <i class="fas fa-play"></i> <span id="limitOpAnimationText">è¿ç®—æ¼”ç¤ºåŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise5">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒäº”æŒ‘æˆ˜ï¼šæé™"ç®—æœ¯"è€ƒæ ¸
                    </div>
                    <div id="exercise5Question" class="exercise-question">
                        5. è‹¥lim f(x)=2, lim g(x)=3ï¼Œåˆ™lim[f(x)+g(x)]ç­‰äºå¤šå°‘ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šæé™è¿ç®—å°±åƒæ™®é€šç®—æœ¯ä¸€æ ·ç®€å•ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise5Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(5)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤è®¡ç®—
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(5)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise5Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- å…­ã€é‡è¦æé™ -->
            <section id="important-limits" class="chapter-section">
                <div class="marker-anchor" id="important-limits-anchor"></div>
                <h2><i class="fas fa-star"></i> ç§˜å¢ƒå…­ï¼šé‡è¦æé™ - é«˜æ•°ç•Œçš„"æ˜æ˜Ÿå…¬å¼"</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆæ˜æ˜Ÿç‰ˆï¼‰</h3>
                    <p><strong>ç¬¬ä¸€ä¸ªé‡è¦æé™ï¼ˆæ­£å¼¦æ˜æ˜Ÿï¼‰ï¼š</strong>$$ \lim_{x \to 0} \frac{\sin x}{x} = 1 $$</p>
                    <p><strong>ç¬¬äºŒä¸ªé‡è¦æé™ï¼ˆè‡ªç„¶æ•°æ˜æ˜Ÿï¼‰ï¼š</strong>$$ \lim_{x \to \infty} \left(1 + \frac{1}{x}\right)^x = e $$</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒå¨±ä¹åœˆï¼Œè¿™ä¸¤ä¸ªæé™æ˜¯é«˜æ•°ç•Œçš„"é¡¶æµæ˜æ˜Ÿ"ï¼Œå¿…é¡»è®¤è¯†ï¼ç¬¬ä¸€ä¸ªæ˜¯æ­£å¼¦å’Œxçš„"å…„å¼Ÿæƒ…"ï¼Œç¬¬äºŒä¸ªæ˜¯å¤åˆ©è®¡ç®—çš„ç»ˆæå½¢æ€ã€‚</p>
                    <p><strong>è®°å¿†å£è¯€ï¼š</strong>"æ­£å¼¦æ¯”xè¶‹è¿‘é›¶ï¼Œæé™å°±æ˜¯ä¸€æ˜æ˜Ÿï¼›ä¸€åŠ xåˆ†ä¹‹ä¸€çš„xæ¬¡æ–¹ï¼Œæ— é™è¶‹è¿‘è‡ªç„¶eã€‚"</p>
                    
                    <div class="formula-box">
                        $$ \text{æ˜æ˜Ÿ1å·ï¼ˆæ­£å¼¦é¡¶æµï¼‰: } \lim_{x \to 0} \frac{\sin x}{x} = 1 $$
                        $$ \text{æ˜æ˜Ÿ2å·ï¼ˆè‡ªç„¶æ•°é¡¶æµï¼‰: } \lim_{x \to \infty} \left(1 + \frac{1}{x}\right)^x = e $$
                        <p style="color: var(--accent); margin-top: 10px;">â­ ç¿»è¯‘ï¼šè¿™ä¸¤ä¸ªæé™æ˜¯é«˜æ•°è€ƒè¯•çš„"å¿…è€ƒé¢˜"ï¼Œå°±åƒå‘¨æ°ä¼¦åœ¨åè¯­ä¹å›çš„åœ°ä½ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šé‡è¦æé™å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">â­ é‡è¦æé™å¯è§†åŒ– - çœ‹æ˜æ˜Ÿæé™å¦‚ä½•"Cä½å‡ºé“"ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="importantLimitsCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">æé™æ˜æ˜Ÿ</div>
                                <div class="info-value" id="importantLimitType">æ­£å¼¦æ˜æ˜Ÿ</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å½“å‰å€¼</div>
                                <div class="info-value" id="importantLimitValue">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æ˜æ˜Ÿå€¼</div>
                                <div class="info-value" id="importantLimitResult">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">è·ç¦»</div>
                                <div class="info-value" id="importantLimitDiff">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            
                            <span>æ˜æ˜Ÿå€¼: <span id="importantLimitTarget">1</span></span>
                            <span>è°ƒæ•´xå€¼: <span id="xImportantSliderValue">0.1</span></span>
                        </div>
                        <input type="range" min="1" max="60" value="10" class="slider" id="importantLimitsSlider" oninput="updateImportantLimitsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeImportantLimit(1)">
                            <i class="fas fa-sync-alt"></i> æ˜æ˜Ÿ1: lim sin(x)/x = 1
                        </button>
                        <button class="control-btn" onclick="changeImportantLimit(2)">
                            <i class="fas fa-chart-line"></i> æ˜æ˜Ÿ2: lim (1+1/x)Ë£ = e
                        </button>
                        <button class="control-btn" onclick="changeImportantLimit(3)">
                            <i class="fas fa-chart-line"></i> æ˜æ˜Ÿ3: lim (1+x)Â¹/Ë£ = e
                        </button>
                        <button class="animation-btn" id="importantLimitsAnimationBtn" onclick="toggleAnimation('importantLimits')">
                            <i class="fas fa-play"></i> <span id="importantLimitsAnimationText">æ˜æ˜Ÿå‡ºé“åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise6">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒå…­æŒ‘æˆ˜ï¼šæ˜æ˜Ÿæé™"åº”æ´"æµ‹è¯•
                    </div>
                    <div id="exercise6Question" class="exercise-question">
                        6. lim(xâ†’âˆ) (1+1/x)^x ç­‰äºå“ªä½æ•°å­¦æ˜æ˜Ÿï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šè¿™æ˜¯è‡ªç„¶ç•Œæœ€å¸¸è§çš„å¸¸æ•°ä¹‹ä¸€ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise6Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(6)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤åº”æ´
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(6)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise6Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- ä¸ƒã€æ— ç©·å°æ¯”è¾ƒ -->
            <section id="infinitesimal-comparison" class="chapter-section">
                <div class="marker-anchor" id="infinitesimal-comparison-anchor"></div>
                <h2><i class="fas fa-balance-scale-left"></i> ç§˜å¢ƒä¸ƒï¼šæ— ç©·å°æ¯”è¾ƒ - è°"è·‘"å¾—æ›´å¿«ï¼Ÿ</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆè·‘æ­¥æ¯”èµ›ç‰ˆï¼‰</h3>
                    <p><strong>æ— ç©·å°çš„é˜¶ï¼š</strong>è®¾Î±,Î²æ˜¯åŒä¸€å˜åŒ–è¿‡ç¨‹ä¸­çš„æ— ç©·å°ï¼Œæ¯”è¾ƒå®ƒä»¬è¶‹è¿‘äº0çš„é€Ÿåº¦ï¼š</p>
                    <p>1. å¦‚æœlim Î²/Î± = 0ï¼Œåˆ™Î²æ˜¯Î±çš„é«˜é˜¶æ— ç©·å°ï¼ˆÎ²è·‘å¾—æ¯”Î±å¿«ï¼‰</p>
                    <p>2. å¦‚æœlim Î²/Î± = âˆï¼Œåˆ™Î²æ˜¯Î±çš„ä½é˜¶æ— ç©·å°ï¼ˆÎ²è·‘å¾—æ¯”Î±æ…¢ï¼‰</p>
                    <p>3. å¦‚æœlim Î²/Î± = c â‰  0ï¼Œåˆ™Î²ä¸Î±æ˜¯åŒé˜¶æ— ç©·å°ï¼ˆÎ²å’ŒÎ±é€Ÿåº¦æˆæ¯”ä¾‹ï¼‰</p>
                    <p>4. å¦‚æœlim Î²/Î± = 1ï¼Œåˆ™Î²ä¸Î±æ˜¯ç­‰ä»·æ— ç©·å°ï¼ˆÎ²å’ŒÎ±å¹¶è‚©è·‘ï¼‰</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒçŸ­è·‘æ¯”èµ›ï¼Œxâ†’0æ˜¯ç»ˆç‚¹çº¿ï¼ŒÎ±å’ŒÎ²æ˜¯ä¸¤ä¸ªè¿åŠ¨å‘˜ã€‚æ¯”è¾ƒå®ƒä»¬è°å…ˆå†²è¿‡ç»ˆç‚¹çº¿ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{è®¾ } \alpha, \beta \to 0 \text{ï¼ˆä¸¤ä¸ªå†²å‘ç»ˆç‚¹çš„è¿åŠ¨å‘˜ï¼‰: } $$
                        $$ \text{é«˜é˜¶ï¼ˆè·‘å¾—å¿«ï¼‰: } \lim \frac{\beta}{\alpha} = 0 \ (\beta = o(\alpha)) $$
                        $$ \text{ç­‰ä»·ï¼ˆå¹¶è‚©è·‘ï¼‰: } \lim \frac{\beta}{\alpha} = 1 \ (\beta \sim \alpha) $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸƒâ€â™‚ï¸ ç¿»è¯‘ï¼šæ¯”è°æ›´å¿«è¶‹è¿‘äº0ï¼æ¯”å€¼â†’0è¯´æ˜Î²æ›´å¿«ï¼Œæ¯”å€¼â†’1è¯´æ˜ä¸€æ ·å¿«ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šæ— ç©·å°æ¯”è¾ƒå¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">âš–ï¸ æ— ç©·å°æ¯”è¾ƒå¯è§†åŒ– - çœ‹è°æ›´å¿«å†²å‘0ç»ˆç‚¹ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="infinitesimalCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueInfinitesimal">0.1</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">è¿åŠ¨å‘˜Î±(x)</div>
                                <div class="info-value" id="alphaValue">0.100</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">è¿åŠ¨å‘˜Î²(x)</div>
                                <div class="info-value" id="betaValue">0.010</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">é€Ÿåº¦æ¯”Î²/Î±</div>
                                <div class="info-value" id="ratioValue">0.100</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼ï¼ˆè·ç»ˆç‚¹è·ç¦»ï¼‰: <span id="xInfinitesimalSliderValue">0.1</span></span>
                            <span>æ¯”èµ›ç»“æœ: <span id="comparisonType">Î²æ›´å¿«ï¼</span></span>
                        </div>
                        <input type="range" min="1" max="100" value="10" class="slider" id="infinitesimalSlider" oninput="updateInfinitesimalGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeInfinitesimalComparison(1)">
                            <i class="fas fa-arrow-up"></i> æ¯”èµ›1: Î² = xÂ² (æ¯”Î± = xå¿«)
                        </button>
                        <button class="control-btn" onclick="changeInfinitesimalComparison(2)">
                            <i class="fas fa-equals"></i> æ¯”èµ›2: Î² = 3x (ä¸Î± = xåŒé€Ÿ)
                        </button>
                        <button class="control-btn" onclick="changeInfinitesimalComparison(3)">
                            <i class="fas fa-exchange-alt"></i> æ¯”èµ›3: Î² = sin x (ä¸Î± = xå¹¶è‚©)
                        </button>
                        <button class="animation-btn" id="infinitesimalAnimationBtn" onclick="toggleAnimation('infinitesimal')">
                            <i class="fas fa-play"></i> <span id="infinitesimalAnimationText">è·‘æ­¥æ¯”èµ›åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise7">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒä¸ƒæŒ‘æˆ˜ï¼šæ— ç©·å°"èµ›è·‘"è£åˆ¤
                    </div>
                    <div id="exercise7Question" class="exercise-question">
                        7. å½“xâ†’0æ—¶ï¼ŒxÂ²æ˜¯xçš„ä»€ä¹ˆæ— ç©·å°ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šæ¯”è¾ƒxÂ²å’Œxè°æ›´å¿«è¶‹è¿‘äº0ï¼Ÿ</span>
                    </div>
                    <div class="exercise-options" id="exercise7Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(7)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤è£åˆ¤
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(7)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise7Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- å…«ã€è¿ç»­æ€§ -->
            <section id="continuity" class="chapter-section">
                <div class="marker-anchor" id="continuity-anchor"></div>
                <h2><i class="fas fa-link"></i> ç§˜å¢ƒå…«ï¼šè¿ç»­æ€§ - å‡½æ•°"ä¸æ–­çº¿"çš„ä¿éšœ</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆè¿çº¿æ¸¸æˆç‰ˆï¼‰</h3>
                    <p><strong>è¿ç»­çš„å®šä¹‰ï¼š</strong>å‡½æ•°f(x)åœ¨ç‚¹xâ‚€è¿ç»­ â‡” lim f(x) = f(xâ‚€) (xâ†’xâ‚€)</p>
                    <p><strong>é—´æ–­ç‚¹ç±»å‹ï¼š</strong></p>
                    <p>1. ç¬¬ä¸€ç±»é—´æ–­ç‚¹ï¼šå¯å»é—´æ–­ç‚¹ï¼ˆèƒ½è¡¥ä¸Šï¼‰ã€è·³è·ƒé—´æ–­ç‚¹ï¼ˆè·³äº†ä¸€ä¸‹ï¼‰</p>
                    <p>2. ç¬¬äºŒç±»é—´æ–­ç‚¹ï¼šæ— ç©·é—´æ–­ç‚¹ã€éœ‡è¡é—´æ–­ç‚¹ï¼ˆæ”¾é£è‡ªæˆ‘ï¼‰</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒç”»çº¿ä¸æŠ¬ç¬”ï¼Œè¿ç»­å°±æ˜¯ä¸€ç¬”ç”»æˆï¼Œé—´æ–­å°±æ˜¯æŠ¬ç¬”äº†ã€‚å¯å»é—´æ–­åƒçº¸ä¸Šæœ‰ä¸ªæ´ä½†èƒ½è¡¥ä¸Šï¼Œè·³è·ƒé—´æ–­åƒç”»çº¿æ—¶æ‰‹æŠ–è·³äº†ä¸€ä¸‹ã€‚</p>
                    
                    <div class="formula-box">
                        $$ f(x) \text{ åœ¨ } x_0 \text{ è¿ç»­ } \iff \lim_{x \to x_0} f(x) = f(x_0) $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ”— ç¿»è¯‘ï¼šæé™å€¼ç­‰äºå‡½æ•°å€¼ï¼Œå°±æ˜¯è¿ç»­ï¼å°±åƒé¢„æœŸå’Œå®é™…ä¸€è‡´ã€‚</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šè¿ç»­æ€§å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ”— è¿ç»­æ€§å¯è§†åŒ– - çœ‹å‡½æ•°èƒ½ä¸èƒ½"ä¸€ç¬”ç”»"ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="continuityCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">å½“å‰xå€¼</div>
                                <div class="info-value" id="xValueContinuity">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fxValueContinuity">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">åœ¨xâ‚€è¿ç»­ï¼Ÿ</div>
                                <div class="info-value" id="isContinuous">æ˜¯</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æ–­ç‚¹ç±»å‹</div>
                                <div class="info-value" id="discontinuityType">æ— </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼ï¼ˆç”»ç¬”ä½ç½®ï¼‰: <span id="xContinuitySliderValue">0.0</span></span>
                            <span>æ£€æŸ¥ç‚¹xâ‚€: <span id="checkPoint">0</span></span>
                        </div>
                        <input type="range" min="-50" max="50" value="0" class="slider" id="continuitySlider" oninput="updateContinuityGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeContinuityFunction(1)">
                            <i class="fas fa-chart-line"></i> ç”»çº¿1: f(x)=xÂ² (è¿ç»­)
                        </button>
                        <button class="control-btn" onclick="changeContinuityFunction(2)">
                            <i class="fas fa-chart-line"></i> ç”»çº¿2: f(x)=1/x (x=0æ–­)
                        </button>
                        <button class="control-btn" onclick="changeContinuityFunction(3)">
                            <i class="fas fa-chart-line"></i> ç”»çº¿3: åˆ†æ®µå‡½æ•° (å¯å»æ–­)
                        </button>
                        <button class="animation-btn" id="continuityAnimationBtn" onclick="toggleAnimation('continuity')">
                            <i class="fas fa-play"></i> <span id="continuityAnimationText">ç”»çº¿åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise8">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒå…«æŒ‘æˆ˜ï¼šè¿ç»­"ç”»çº¿"æµ‹è¯•
                    </div>
                    <div id="exercise8Question" class="exercise-question">
                        8. å‡½æ•° f(x)=1/x åœ¨ x=0 å¤„çš„æ–­ç‚¹ç±»å‹æ˜¯ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šçœ‹çœ‹x=0é™„è¿‘å‡½æ•°å€¼çš„å˜åŒ–ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise8Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(8)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤åˆ¤æ–­
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(8)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise8Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- ä¹ã€è¿ç»­è¿ç®— -->
            <section id="continuous-operations" class="chapter-section">
                <div class="marker-anchor" id="continuous-operations-anchor"></div>
                <h2><i class="fas fa-cogs"></i> ç§˜å¢ƒä¹ï¼šè¿ç»­è¿ç®— - è¿ç»­å‡½æ•°çš„"å®¶æ—é—ä¼ "</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆé—ä¼ ç‰ˆï¼‰</h3>
                    <p><strong>è¿ç»­å‡½æ•°çš„è¿ç®—ï¼š</strong>è¿ç»­å‡½æ•°è¿›è¡Œè¿ç®—åï¼Œç»“æœè¿˜æ˜¯è¿ç»­å‡½æ•°ï¼ˆæœ‰é—ä¼ æ€§ï¼‰ï¼</p>
                    <p>1. è¿ç»­å‡½æ•°çš„å’Œã€å·®ã€ç§¯ã€å•†ï¼ˆåˆ†æ¯ä¸ä¸ºé›¶ï¼‰ä»æ˜¯è¿ç»­å‡½æ•°</p>
                    <p>2. è¿ç»­å‡½æ•°çš„å¤åˆå‡½æ•°ä»æ˜¯è¿ç»­å‡½æ•°</p>
                    <p><strong>åˆç­‰å‡½æ•°è¿ç»­æ€§ï¼š</strong>æ‰€æœ‰åˆç­‰å‡½æ•°ï¼ˆå¹‚å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°ã€ä¸‰è§’å‡½æ•°ç­‰ï¼‰åœ¨å…¶å®šä¹‰åŒºé—´å†…è¿ç»­ã€‚</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒè¿ç»­å‡½æ•°å®¶æ—ï¼Œçˆ¶æ¯éƒ½è¿ç»­ï¼Œå­©å­ï¼ˆè¿ç®—ç»“æœï¼‰ä¹Ÿè¿ç»­ã€‚ä½†è¦æ³¨æ„ï¼Œé™¤æ³•æ—¶å¦‚æœåˆ†æ¯ä¸ºé›¶ï¼Œå°±åƒåŸºå› çªå˜ï¼Œå¯èƒ½ä¸è¿ç»­ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{è‹¥ } f(x), g(x) \text{ åœ¨ } x_0 \text{ è¿ç»­ï¼Œåˆ™ï¼š} $$
                        $$ f(x) \pm g(x), \quad f(x) \cdot g(x), \quad \frac{f(x)}{g(x)} (g(x_0) \neq 0) \text{ åœ¨ } x_0 \text{ è¿ç»­} $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ§¬ ç¿»è¯‘ï¼šè¿ç»­å‡½æ•°çš„å››åˆ™è¿ç®—å’Œå¤åˆè¿ç®—ï¼Œç»“æœè¿˜æ˜¯è¿ç»­å‡½æ•°ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šè¿ç»­è¿ç®—å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">âš™ï¸ è¿ç»­è¿ç®—å¯è§†åŒ– - çœ‹è¿ç»­å®¶æ—å¦‚ä½•"é—ä¼ "ï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="continuousOperationsCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">è¿ç®—ç±»å‹</div>
                                <div class="info-value" id="continuousOpType">åŠ æ³•</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f(x)å€¼</div>
                                <div class="info-value" id="fValueContinuous">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">g(x)å€¼</div>
                                <div class="info-value" id="gValueContinuous">0.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">f op gå€¼</div>
                                <div class="info-value" id="resultValueContinuous">0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>è°ƒæ•´xå€¼: <span id="xContinuousSliderValue">0.0</span></span>
                            <span>è¿ç»­ç‚¹: <span id="continuousPoint">x=0</span></span>
                        </div>
                        <input type="range" min="-50" max="50" value="0" class="slider" id="continuousOperationsSlider" oninput="updateContinuousOperationsGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeContinuousOperation(1)">
                            <i class="fas fa-plus"></i> åŠ æ³•é—ä¼ 
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(2)">
                            <i class="fas fa-times"></i> ä¹˜æ³•é—ä¼ 
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(3)">
                            <i class="fas fa-sitemap"></i> å¤åˆé—ä¼ 
                        </button>
                        <button class="control-btn" onclick="changeContinuousOperation(4)">
                            <i class="fas fa-divide"></i> é™¤æ³•é—ä¼ 
                        </button>
                        <button class="animation-btn" id="continuousOpAnimationBtn" onclick="toggleAnimation('continuousOperations')">
                            <i class="fas fa-play"></i> <span id="continuousOpAnimationText">é—ä¼ åŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise9">
                    <div class="exercise-title">
                        <i class="fas fa-brain"></i> ç§˜å¢ƒä¹æŒ‘æˆ˜ï¼šè¿ç»­"é—ä¼ "æµ‹è¯•
                    </div>
                    <div id="exercise9Question" class="exercise-question">
                        9. ä¸¤ä¸ªè¿ç»­å‡½æ•°çš„å’Œå‡½æ•°æ˜¯ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šè¿ç»­å‡½æ•°å®¶æ—æœ‰"é—ä¼ æ€§"ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise9Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(9)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤æ£€æµ‹
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(9)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                    </div>
                    <div id="exercise9Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
            <!-- åã€é—­åŒºé—´æ€§è´¨ -->
            <section id="closed-interval" class="chapter-section">
                <div class="marker-anchor" id="closed-interval-anchor"></div>
                <h2><i class="fas fa-expand-arrows-alt"></i> ç§˜å¢ƒåï¼šé—­åŒºé—´æ€§è´¨ - å‡½æ•°çš„"èˆ’é€‚åŒº"ä¿éšœ</h2>
                
                <div class="knowledge-card">
                    <h3><i class="fas fa-lightbulb"></i> æ ¸å¿ƒæ¦‚å¿µï¼ˆä¿éšœç‰ˆï¼‰</h3>
                    <p><strong>æœ‰ç•Œæ€§å®šç†ï¼š</strong>é—­åŒºé—´[a,b]ä¸Šçš„è¿ç»­å‡½æ•°åœ¨è¯¥åŒºé—´ä¸Šæœ‰ç•Œï¼ˆåœ¨èˆ’é€‚åŒºå†…ä¸ä¼š"æ”¾é£è‡ªæˆ‘"ï¼‰ã€‚</p>
                    <p><strong>æœ€å€¼å®šç†ï¼š</strong>é—­åŒºé—´[a,b]ä¸Šçš„è¿ç»­å‡½æ•°ä¸€å®šèƒ½å–å¾—æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼ˆåœ¨èˆ’é€‚åŒºå†…èƒ½æ‰¾åˆ°æœ€é«˜ç‚¹å’Œæœ€ä½ç‚¹ï¼‰ã€‚</p>
                    <p><strong>é›¶ç‚¹å®šç†ï¼š</strong>è‹¥f(a)ä¸f(b)å¼‚å·ï¼Œåˆ™å­˜åœ¨câˆˆ(a,b)ä½¿å¾—f(c)=0ï¼ˆä¸€å¤´æ­£ä¸€å¤´è´Ÿï¼Œä¸­é—´å¿…è¿‡é›¶ç‚¹ï¼‰ã€‚</p>
                    <p><strong>æ¯”å–»ï¼š</strong>å°±åƒåœ¨å›´æ å†…æ”¾ç¾Šï¼Œç¾Šï¼ˆå‡½æ•°å€¼ï¼‰ä¸ä¼šè·‘ä¸¢ï¼ˆæœ‰ç•Œï¼‰ï¼Œèƒ½æ‰¾åˆ°æœ€é«˜æœ€è‚¥çš„ç¾Šï¼ˆæœ€å€¼ï¼‰ï¼Œå¦‚æœå›´æ ä¸¤å¤´ä¸€é»‘ä¸€ç™½ï¼Œä¸­é—´å¿…æœ‰ç°ç¾Šï¼ˆé›¶ç‚¹ï¼‰ã€‚</p>
                    
                    <div class="formula-box">
                        $$ \text{æœ€å€¼å®šç†ï¼ˆèˆ’é€‚åŒºä¿éšœï¼‰: } f \in C[a,b] \Rightarrow \exists x_1, x_2 \in [a,b], f(x_1) = \min_{[a,b]} f, f(x_2) = \max_{[a,b]} f $$
                        $$ \text{é›¶ç‚¹å®šç†ï¼ˆè¿‡é›¶ç‚¹ä¿éšœï¼‰: } f \in C[a,b], f(a)f(b) < 0 \Rightarrow \exists c \in (a,b), f(c) = 0 $$
                        <p style="color: var(--accent); margin-top: 10px;">ğŸ›¡ï¸ ç¿»è¯‘ï¼šåœ¨é—­åŒºé—´ä¸Šï¼Œè¿ç»­å‡½æ•°ä¸€å®šæœ‰ç•Œã€æœ‰æœ€å€¼ï¼Œç«¯ç‚¹å¼‚å·å¿…æœ‰é›¶ç‚¹ï¼</p>
                    </div>
                </div>
                
                <!-- åŠ¨æ€å›¾å½¢ï¼šé—­åŒºé—´æ€§è´¨å¯è§†åŒ– -->
                <div class="graph-container">
                    <div class="graph-title">ğŸ“ é—­åŒºé—´æ€§è´¨å¯è§†åŒ– - çœ‹çœ‹å‡½æ•°çš„"èˆ’é€‚åŒº"ä¿éšœï¼</div>
                    <div class="graph-display-area">
                        <div class="graph-canvas-container">
                            <canvas id="closedIntervalCanvas" width="500" height="280"></canvas>
                        </div>
                        <div class="graph-info">
                            <div class="info-item">
                                <div class="info-label">èˆ’é€‚åŒº[a,b]</div>
                                <div class="info-value" id="intervalValue">[0, 2Ï€]</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æœ€çŸ®ç¾Šï¼ˆæœ€å°å€¼ï¼‰</div>
                                <div class="info-value" id="minValue">-1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">æœ€é«˜ç¾Šï¼ˆæœ€å¤§å€¼ï¼‰</div>
                                <div class="info-value" id="maxValue">1.0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">ç°ç¾Šä½ç½®ï¼ˆé›¶ç‚¹ï¼‰</div>
                                <div class="info-value" id="zeroPoints">0, Ï€, 2Ï€</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>å›´æ å·¦ç«¯a: <span id="intervalASliderValue">0</span></span>
                            <span>å›´æ å³ç«¯b: <span id="intervalBSliderValue">6.28</span></span>
                        </div>
                        <input type="range" min="0" max="100" value="0" class="slider" id="intervalASlider" oninput="updateClosedIntervalGraph()">
                        <input type="range" min="0" max="100" value="100" class="slider" id="intervalBSlider" oninput="updateClosedIntervalGraph()">
                    </div>
                    
                    <div class="graph-controls">
                        <button class="control-btn" onclick="changeClosedIntervalFunction(1)">
                            <i class="fas fa-wave-square"></i> ç¾Šç¾¤1: f(x)=sin x
                        </button>
                        <button class="control-btn" onclick="changeClosedIntervalFunction(2)">
                            <i class="fas fa-parabola"></i> ç¾Šç¾¤2: f(x)=xÂ²-2x+1
                        </button>
                        <button class="control-btn" onclick="changeClosedIntervalFunction(3)">
                            <i class="fas fa-cube"></i> ç¾Šç¾¤3: f(x)=xÂ³-3x
                        </button>
                        <button class="animation-btn" id="closedIntervalAnimationBtn" onclick="toggleAnimation('closedInterval')">
                            <i class="fas fa-play"></i> <span id="closedIntervalAnimationText">æ”¾ç¾ŠåŠ¨ç”»</span>
                        </button>
                    </div>
                </div>
                
                <!-- ç»¼åˆç»ƒä¹ é¢˜ -->
                <div class="exercise-container" id="exercise10">
                    <div class="exercise-title">
                        <i class="fas fa-trophy"></i> ç»ˆææŒ‘æˆ˜ï¼šåå¤§ç§˜å¢ƒé€šå…³æµ‹è¯•ï¼
                    </div>
                    <div id="exercise10Question" class="exercise-question">
                        10. ä¸‹åˆ—å“ªä¸ªå‡½æ•°åœ¨é—­åŒºé—´[0,1]ä¸Šæ»¡è¶³é›¶ç‚¹å®šç†çš„æ¡ä»¶ï¼Ÿ<br>
                        <span style="color: var(--gray); font-size: 0.9rem;">æç¤ºï¼šéœ€è¦f(0)å’Œf(1)å¼‚å·ï¼Œä¸”å‡½æ•°åœ¨[0,1]è¿ç»­ï¼</span>
                    </div>
                    <div class="exercise-options" id="exercise10Options">
                        <!-- é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="exercise-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="totalExercises">10</div>
                            <div class="stat-label">æ€»ç§˜å¢ƒæ•°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="correctExercises">0</div>
                            <div class="stat-label">é€šå…³æ•°</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="accuracy">0%</div>
                            <div class="stat-label">é€šå…³ç‡</div>
                        </div>
                    </div>
                    <div class="exercise-navigation">
                        <button class="control-btn" onclick="checkExerciseAnswer(10)" style="background:linear-gradient(135deg, var(--success), #20c997);">
                            <i class="fas fa-check"></i> æäº¤é€šå…³
                        </button>
                        <button class="control-btn" onclick="showExerciseSolution(10)" style="background:linear-gradient(135deg, var(--info), #17a2b8);">
                            <i class="fas fa-lightbulb"></i> æŸ¥çœ‹è§£æ
                        </button>
                        <button class="control-btn" onclick="resetAllExercises()" style="background:linear-gradient(135deg, var(--warning), #ffc107);">
                            <i class="fas fa-redo"></i> é‡ç½®æŒ‘æˆ˜
                        </button>
                    </div>
                    <div id="exercise10Feedback" class="exercise-feedback">
                        <!-- åé¦ˆä¿¡æ¯ -->
                    </div>
                </div>
                
            </section>
            
        </main>
        
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <!-- å­¦ä¹ è¿›åº¦ -->
            <div class="progress-container">
                <div class="progress-title">
                    <i class="fas fa-tasks"></i> ç§˜å¢ƒæ¢ç´¢è¿›åº¦ ğŸ—ºï¸
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 10%"></div>
                </div>
                <div class="progress-text">
                    å·²æ¢ç´¢ï¼š<span id="progressPercent">10%</span> (1/10ä¸ªç§˜å¢ƒ)
                    <br>
                    <span style="color: var(--accent); font-size: 0.9rem;">ğŸ¯ ä»Šæ—¥ç›®æ ‡ï¼šæ¢ç´¢3ä¸ªç§˜å¢ƒï¼</span>
                </div>
                <button class="control-btn" onclick="resetProgress()" style="margin-top:15px; width:100%; background:linear-gradient(135deg, var(--danger), #ff4757);">
                    <i class="fas fa-redo"></i> é‡ç½®æ¢ç´¢è¿›åº¦
                </button>
            </div>
            
            <!-- å¿«é€Ÿé“¾æ¥ -->
            <div class="quick-links">
                <div class="quick-links-title">
                    <i class="fas fa-rocket"></i> ç§˜å¢ƒä¼ é€é—¨ ğŸšª
                </div>
                <div class="links-grid">
                    <button class="link-btn" onclick="scrollToSection('mapping-function')">
                        <i class="fas fa-project-diagram"></i> ç§˜å¢ƒä¸€
                    </button>
                    <button class="link-btn" onclick="scrollToSection('sequence-limit')">
                        <i class="fas fa-sort-numeric-down"></i> ç§˜å¢ƒäºŒ
                    </button>
                    <button class="link-btn" onclick="scrollToSection('function-limit')">
                        <i class="fas fa-bullseye"></i> ç§˜å¢ƒä¸‰
                    </button>
                    <button class="link-btn" onclick="scrollToSection('limit-criteria')">
                        <i class="fas fa-filter"></i> ç§˜å¢ƒå››
                    </button>
                    <button class="link-btn" onclick="scrollToSection('limit-operations')">
                        <i class="fas fa-calculator"></i> ç§˜å¢ƒäº”
                    </button>
                    <button class="link-btn" onclick="scrollToSection('important-limits')">
                        <i class="fas fa-star"></i> ç§˜å¢ƒå…­
                    </button>
                    <button class="link-btn" onclick="scrollToSection('infinitesimal-comparison')">
                        <i class="fas fa-balance-scale-left"></i> ç§˜å¢ƒä¸ƒ
                    </button>
                    <button class="link-btn" onclick="scrollToSection('continuity')">
                        <i class="fas fa-link"></i> ç§˜å¢ƒå…«
                    </button>
                    <button class="link-btn" onclick="scrollToSection('continuous-operations')">
                        <i class="fas fa-cogs"></i> ç§˜å¢ƒä¹
                    </button>
                    <button class="link-btn" onclick="scrollToSection('closed-interval')">
                        <i class="fas fa-expand-arrows-alt"></i> ç§˜å¢ƒå
                    </button>
                </div>
            </div>
            
            <!-- æé™æŒ‘æˆ˜æ¸¸æˆ -->
            <div class="game-container">
                <div class="game-title">
                    <i class="fas fa-gamepad"></i> é«˜æ•°å¤§å†’é™© ğŸ®
                </div>
                <p style="margin-bottom:20px; color:#666; font-style: italic;">"æ•°å­¦ç‰ˆå¯†å®¤é€ƒè„±"ï¼Œæµ‹æµ‹ä½ æ˜¯é’é“œè¿˜æ˜¯ç‹è€…ï¼</p>
                <button class="game-btn" onclick="startGame()">
                    <i class="fas fa-play-circle"></i> å¼€å§‹å¤§å†’é™©
                </button>
                <div id="gameScore" style="margin-top:15px; padding:20px; background:white; border-radius:15px; display:none; box-shadow: 0 4px 10px rgba(0,0,0,0.08);">
                    <div class="info-label">å½“å‰æ¢é™©ç§¯åˆ†</div>
                    <div class="info-value" id="currentScore">0</div>
                    <div style="margin-top:15px; display:flex; gap:10px;">
                        <button class="game-exit-btn" onclick="exitGame()" style="flex:1;">
                            <i class="fas fa-times"></i> é€€å‡ºå†’é™©
                        </button>
                        <button class="game-exit-btn" onclick="continueGame()" style="flex:1; background:linear-gradient(135deg, var(--success), #2ed573);">
                            <i class="fas fa-play"></i> ç»§ç»­æ¢é™©
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- å­¦ä¹ èµ„æº -->
            <div class="quick-links">
                <div class="quick-links-title">
                    <i class="fas fa-download"></i> æ¢é™©å·¥å…·åŒ… ğŸ§°
                </div>
                <div style="margin-top:15px; display: grid; gap: 10px;">
                    <button class="link-btn" onclick="downloadNotes()">
                        <i class="fas fa-file-pdf"></i> ç§˜å¢ƒåœ°å›¾
                    </button>
                    <button class="link-btn" onclick="viewFormulas()">
                        <i class="fas fa-square-root-alt"></i> é­”æ³•å’’è¯­
                    </button>
                    <button class="link-btn" onclick="showCommonMistakes()">
                        <i class="fas fa-exclamation-triangle"></i> é™·é˜±è­¦ç¤º
                    </button>
                    <button class="link-btn" onclick="showExamTips()">
                        <i class="fas fa-graduation-cap"></i> é€šå…³ç§˜ç±
                    </button>
                    <button class="link-btn" onclick="showFunnyMemes()">
                        <i class="fas fa-laugh-squint"></i> è¶£å‘³æ¢—å›¾
                    </button>
                </div>
            </div>
            
            <!-- å­¦ä¹ è®¡æ—¶å™¨ -->
            <div class="progress-container" style="margin-top:25px;">
                <div class="progress-title">
                    <i class="fas fa-clock"></i> æ¢é™©è®¡æ—¶å™¨ â±ï¸
                </div>
                <div style="font-size:2.2rem; font-weight:bold; color:var(--primary); margin:15px 0; text-align: center;" id="studyTimer">
                    00:00:00
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="control-btn" onclick="startTimer()" style="flex:1;">
                        <i class="fas fa-play"></i> å¼€å§‹
                    </button>
                    <button class="control-btn" onclick="pauseTimer()" style="flex:1; background:linear-gradient(135deg, var(--warning) 0%, var(--fun-orange) 100%);">
                        <i class="fas fa-pause"></i> æš‚åœ
                    </button>
                    <button class="control-btn" onclick="resetTimer()" style="flex:1; background:linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                        <i class="fas fa-stop"></i> é‡ç½®
                    </button>
                </div>
                <div style="margin-top:15px; padding:10px; background:#f8f9fa; border-radius:10px;">
                    <div style="font-size:0.9rem; color:var(--gray);">ä»Šæ—¥æ¢é™©ï¼š<span id="todayStudyTime">0åˆ†é’Ÿ</span></div>
                    <div style="font-size:0.9rem; color:var(--gray);">ç´¯è®¡æ¢é™©ï¼š<span id="totalStudyTime">0å°æ—¶</span></div>
                </div>
            </div>
            
            <!-- å­¦ä¹ æˆå°± -->
            <div class="progress-container" style="margin-top:25px;">
                <div class="progress-title">
                    <i class="fas fa-trophy"></i> æˆå°±å¢™ ğŸ†
                </div>
                <div id="achievements" style="margin-top:15px;">
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                        <div style="width:30px; height:30px; background:gold; border-radius:50%; display:flex; align-items:center; justify-content:center;">â­</div>
                        <div>
                            <div style="font-weight:bold;">åˆè¯†é«˜æ•°</div>
                            <div style="font-size:0.8rem; color:var(--gray);">å®Œæˆç¬¬ä¸€ç« å­¦ä¹ </div>
                        </div>
                    </div>
                    <!-- æ›´å¤šæˆå°±å¯ä»¥åŠ¨æ€æ·»åŠ  -->
                </div>
            </div>
        </aside>
    </div>
    
    <!-- æ¸¸æˆæ¨¡æ€æ¡† -->
    <div class="game-modal" id="gameModal">
        <div class="game-modal-content">
            <h2 style="color:var(--warning); margin-bottom:20px; text-align:center;"><i class="fas fa-gamepad"></i> é«˜æ•°å¤§å†’é™© ğŸ®</h2>
            <div style="text-align:center; margin-bottom:15px;">
                <span style="background:var(--warning); color:white; padding:5px 15px; border-radius:20px; font-weight:bold;">ç¬¬ <span id="gameQuestionNumber">1</span>/10 å…³</span>
            </div>
            <div id="gameQuestion" style="margin-bottom:25px; font-size:1.2rem; line-height:1.6; padding:15px; background:#f8f9fa; border-radius:15px;"></div>
            <div id="gameOptions" style="margin-bottom:25px;"></div>
            <div style="display:flex; justify-content:space-between; margin-top:20px;">
                <button class="game-exit-btn" onclick="exitGameModal()">
                    <i class="fas fa-times"></i> é€€å‡ºå†’é™©
                </button>
                <button class="control-btn" onclick="submitGameAnswer()" style="background:linear-gradient(135deg, var(--success), #2ed573);">
                    <i class="fas fa-check"></i> é—¯å…³ï¼
                </button>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨ä¿¡æ¯ -->
    <footer style="background:var(--dark); color:white; padding:40px 20px; margin-top:50px; text-align:center;">
        <div style="max-width:800px; margin:0 auto;">
            <h3 style="color:var(--fun-blue); margin-bottom:20px;">ğŸ‰ æ­å–œä½ å®Œæˆé«˜æ•°åå¤§ç§˜å¢ƒæ¢é™©ï¼</h3>
            <p style="margin-bottom:20px; opacity:0.9;">æé™ä¸è¿ç»­åªæ˜¯é«˜æ•°ä¸–ç•Œçš„ç¬¬ä¸€ä¸ªç¯‡ç« ï¼Œæ›´å¤šå¥‡å¦™æ•°å­¦ä¸–ç•Œç­‰ä½ æ¢ç´¢ï¼</p>
            <div style="display:flex; justify-content:center; gap:20px; flex-wrap:wrap; margin-top:30px;">
                <button class="control-btn" onclick="shareAchievement()" style="background:linear-gradient(135deg, var(--fun-blue), #00cec9);">
                    <i class="fas fa-share-alt"></i> åˆ†äº«æˆå°±
                </button>
                <button class="control-btn" onclick="giveFeedback()" style="background:linear-gradient(135deg, var(--fun-purple), #a29bfe);">
                    <i class="fas fa-comment-dots"></i> åé¦ˆå»ºè®®
                </button>
            </div>
            <p style="margin-top:30px; opacity:0.7; font-size:0.9rem;">Â© 2023 è®©æ•°å­¦ä¸å†"æé™"ä½ çš„æƒ³è±¡åŠ› | äº¤äº’å¼é«˜æ•°å­¦ä¹ ç³»ç»Ÿ</p>
        </div>
    </footer>

    <script>
        // ==================== å…¨å±€å˜é‡ ====================
        // Canvasä¸Šä¸‹æ–‡
        let domainCtx, functionTypeCtx, sequenceCtx, functionLimitCtx, squeezeCtx;
        let limitOperationsCtx, importantLimitsCtx, infinitesimalCtx;
        let continuityCtx, continuousOperationsCtx, closedIntervalCtx;
        
        // å„å›¾å½¢æ§åˆ¶å˜é‡
        let domainFunctionType = 1;
        let functionType = 1;
        let showVerticalTest = true;
        let sequenceType = 1;
        let functionLimitType = 1;
        let squeezeType = 1;
        let limitOperationType = 1;
        let importantLimitType = 1;
        let infinitesimalType = 1;
        let continuityType = 1;
        let continuousOpType = 1;
        let closedIntervalType = 1;
        
        // åŠ¨ç”»æ§åˆ¶å˜é‡
        let animationIntervals = {};
        
        // ç³»ç»Ÿå˜é‡
        let studyTimer = 0;
        let timerInterval = null;
        let gameActive = false;
        let currentGameQuestion = 0;
        let gameScore = 0;
        let gameQuestions = [];
        let userGameAnswer = null;
        let learnedSections = new Set(['mapping-function']);
        let totalSections = 10;
        
        // ç»ƒä¹ ç³»ç»Ÿå˜é‡
        let exercises = [];
        let exerciseAnswers = {};
        let exerciseSelected = {};
        let exerciseStats = {
            total: 10,
            correct: 0,
            attempted: 0
        };
        
        // å­¦ä¹ è®°å½•
        let todayStudyTime = 0;
        let totalStudyTime = 0;
        
        // ==================== åˆå§‹åŒ–å‡½æ•° ====================
        function init() {
            console.log("ğŸš€ å¯åŠ¨é«˜æ•°é­”æ³•å­¦ä¹ ç³»ç»Ÿ...");
            
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            showLoader();
            
            // å»¶è¿Ÿåˆå§‹åŒ–ä»¥ç¡®ä¿DOMå®Œå…¨åŠ è½½
            setTimeout(() => {
                try {
                    // åˆå§‹åŒ–Canvasä¸Šä¸‹æ–‡
                    initCanvasContexts();
                    
                    // åˆå§‹åŒ–æ‰€æœ‰å›¾å½¢
                    updateAllGraphs();
                    
                    // æ›´æ–°å­¦ä¹ è¿›åº¦
                    updateProgress();
                    
                    // åˆå§‹åŒ–æ¸¸æˆé—®é¢˜
                    initGameQuestions();
                    
                    // åˆå§‹åŒ–ç»ƒä¹ ç³»ç»Ÿ
                    initExercises();
                    
                    // æ¢å¤å­¦ä¹ è®°å½•
                    loadStudyRecords();
                    
                    // å¼€å§‹å­¦ä¹ è®¡æ—¶å™¨
                    startTimer();
                    
                    // éšè—åŠ è½½åŠ¨ç”»
                    hideLoader();
                    
                    console.log("âœ… ç³»ç»Ÿå¯åŠ¨æˆåŠŸï¼å‡†å¤‡å¼€å§‹å¥‡å¦™æ•°å­¦ä¹‹æ—…ï¼");
                    
                    // æ˜¾ç¤ºæ¬¢è¿æç¤º
                    setTimeout(() => {
                        showFunnyTip("ğŸ‰ æ¬¢è¿æ¥åˆ°é«˜æ•°é­”æ³•ä¸–ç•Œï¼æ‹–åŠ¨æ»‘å—ã€ç‚¹å‡»æŒ‰é’®ï¼Œè®©æ•°å­¦æ´»èµ·æ¥ï¼");
                    }, 1000);
                    
                } catch (error) {
                    console.error("åˆå§‹åŒ–é”™è¯¯:", error);
                    hideLoader();
                    alert("ç³»ç»Ÿå¯åŠ¨å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚é”™è¯¯ä¿¡æ¯: " + error.message);
                }
            }, 500);
        }
        
        function showLoader() {
            const loader = document.getElementById('pageLoader');
            if (loader) loader.style.display = 'flex';
        }
        
        function hideLoader() {
            const loader = document.getElementById('pageLoader');
            if (loader) loader.style.display = 'none';
        }
        
        function showFunnyTip(message) {
            // åˆ›å»ºæç¤ºæ¡†
            const tip = document.createElement('div');
            tip.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, var(--primary), var(--fun-purple));
                color: white;
                padding: 20px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                z-index: 10001;
                max-width: 300px;
                animation: slideInRight 0.5s ease, fadeOut 0.5s ease 4.5s forwards;
                font-weight: bold;
            `;
            tip.innerHTML = `<div style="display:flex; align-items:center; gap:10px;">
                <div style="font-size:1.5rem;">ğŸ‰</div>
                <div>${message}</div>
            </div>`;
            document.body.appendChild(tip);
            
            // 5ç§’åç§»é™¤
            setTimeout(() => {
                if (tip.parentNode) {
                    tip.parentNode.removeChild(tip);
                }
            }, 5000);
        }
        
        function initCanvasContexts() {
            console.log("ğŸ¨ åˆå§‹åŒ–Canvasç»˜å›¾å¼•æ“...");
            
            // æ‰€æœ‰Canvaså…ƒç´ 
            const canvases = [
                {id: 'domainCanvas', ctxVar: 'domainCtx'},
                {id: 'functionTypeCanvas', ctxVar: 'functionTypeCtx'},
                {id: 'sequenceCanvas', ctxVar: 'sequenceCtx'},
                {id: 'functionLimitCanvas', ctxVar: 'functionLimitCtx'},
                {id: 'squeezeCanvas', ctxVar: 'squeezeCtx'},
                {id: 'limitOperationsCanvas', ctxVar: 'limitOperationsCtx'},
                {id: 'importantLimitsCanvas', ctxVar: 'importantLimitsCtx'},
                {id: 'infinitesimalCanvas', ctxVar: 'infinitesimalCtx'},
                {id: 'continuityCanvas', ctxVar: 'continuityCtx'},
                {id: 'continuousOperationsCanvas', ctxVar: 'continuousOperationsCtx'},
                {id: 'closedIntervalCanvas', ctxVar: 'closedIntervalCtx'}
            ];
            
            let successCount = 0;
            
            canvases.forEach(canvasInfo => {
                const canvas = document.getElementById(canvasInfo.id);
                if (canvas) {
                    // è®¾ç½®åˆé€‚çš„Canvaså°ºå¯¸
                    const container = canvas.parentElement;
                    if (container) {
                        const width = container.clientWidth - 30;
                        const height = 280;
                        canvas.width = width;
                        canvas.height = height;
                    }
                    
                    const ctx = canvas.getContext('2d');
                    if (ctx) {
                        eval(`${canvasInfo.ctxVar} = ctx`);
                        successCount++;
                    }
                }
            });
            
            console.log(`âœ… Canvasåˆå§‹åŒ–: ${successCount}ä¸ªæˆåŠŸ`);
        }
        
        function updateAllGraphs() {
            // æ›´æ–°æ‰€æœ‰å›¾å½¢å‡½æ•°
            const updateFunctions = [
                updateDomainGraph,
                updateFunctionTypeGraph,
                updateSequenceGraph,
                updateFunctionLimitGraph,
                updateSqueezeGraph,
                updateLimitOperationsGraph,
                updateImportantLimitsGraph,
                updateInfinitesimalGraph,
                updateContinuityGraph,
                updateContinuousOperationsGraph,
                updateClosedIntervalGraph
            ];
            
            // å»¶è¿Ÿæ‰§è¡Œä»¥é¿å…é˜»å¡
            updateFunctions.forEach((func, index) => {
                setTimeout(() => {
                    try {
                        if (typeof func === 'function') {
                            func();
                        }
                    } catch (error) {
                        console.error(`æ›´æ–°å›¾å½¢ ${func.name} æ—¶å‡ºé”™:`, error);
                    }
                }, index * 50);
            });
        }
        
        // ==================== åŠ¨ç”»æ§åˆ¶å‡½æ•° ====================
        function toggleAnimation(type) {
            if (animationIntervals[type]) {
                stopAnimation(type);
                updateAnimationButton(type, false);
                return false;
            } else {
                startAnimation(type);
                updateAnimationButton(type, true);
                return true;
            }
        }
        
        function startAnimation(type) {
            // åœæ­¢å…¶ä»–æ­£åœ¨è¿è¡Œçš„åŠ¨ç”»
            Object.keys(animationIntervals).forEach(key => {
                if (key !== type && animationIntervals[key]) {
                    stopAnimation(key);
                    updateAnimationButton(key, false);
                }
            });
            
            let slider, min, max, step, updateFunc, btnId, textId, animationText;
            
            switch(type) {
                case 'domain':
                    slider = document.getElementById('domainSlider');
                    min = -30; max = 30; step = 1;
                    updateFunc = updateDomainGraph;
                    btnId = 'domainAnimationBtn';
                    textId = 'domainAnimationText';
                    animationText = 'è‡ªåŠ¨æŠ•å¸æ¼”ç¤º';
                    break;
                case 'functionType':
                    slider = document.getElementById('functionTypeSlider');
                    min = -30; max = 30; step = 1;
                    updateFunc = updateFunctionTypeGraph;
                    btnId = 'functionTypeAnimationBtn';
                    textId = 'functionTypeAnimationText';
                    animationText = 'æ€§æ ¼æ‰«æ';
                    break;
                case 'sequence':
                    slider = document.getElementById('sequenceSlider');
                    min = 1; max = 50; step = 1;
                    updateFunc = updateSequenceGraph;
                    btnId = 'sequenceAnimationBtn';
                    textId = 'sequenceAnimationText';
                    animationText = 'æ‹çˆ±é•¿è·‘åŠ¨ç”»';
                    break;
                case 'functionLimit':
                    slider = document.getElementById('xLimitSlider');
                    min = 0; max = 40; step = 1;
                    updateFunc = updateFunctionLimitGraph;
                    btnId = 'functionLimitAnimationBtn';
                    textId = 'functionLimitAnimationText';
                    animationText = 'ç„å‡†åŠ¨ç”»';
                    break;
                case 'squeeze':
                    slider = document.getElementById('squeezeSlider');
                    min =200; max = 1; step =-2;
                    updateFunc = updateSqueezeGraph;
                    btnId = 'squeezeAnimationBtn';
                    textId = 'squeezeAnimationText';
                    animationText = 'ä¸‰æ˜æ²»åˆ¶ä½œåŠ¨ç”»';
                    break;
                case 'limitOperations':
                    slider = document.getElementById('limitOpSlider');
                    min = 10; max = 100; step =1;
                    updateFunc = updateLimitOperationsGraph;
                    btnId = 'limitOpAnimationBtn';
                    textId = 'limitOpAnimationText';
                    animationText = 'è¿ç®—æ¼”ç¤ºåŠ¨ç”»';
                    break;
                case 'importantLimits':
                    slider = document.getElementById('importantLimitsSlider');
                    if (importantLimitType === 2) { // æ˜æ˜Ÿ2ï¼š(1+1/x)^x
                         min = 1;  // ä»æœ€å¤§å€¼å¼€å§‹ï¼ˆxè¾ƒå¤§å€¼ï¼‰
                          max = 30;    // åˆ°æœ€å°å€¼ç»“æŸï¼ˆxè¾ƒå°å€¼ï¼‰
                         step = 1;  // è´Ÿå€¼ï¼šä»å³å‘å·¦ç§»åŠ¨
                         } else {
                              min = 20;
                              max = 1;
                              step = -1;   // å…¶ä»–ç±»å‹ä¿æŒåŸæ–¹å‘
                          }
                    
                    updateFunc = updateImportantLimitsGraph;
                    btnId = 'importantLimitsAnimationBtn';
                    textId = 'importantLimitsAnimationText';
                    animationText = 'æ˜æ˜Ÿå‡ºé“åŠ¨ç”»';
                    break;
                case 'infinitesimal':
                    slider = document.getElementById('infinitesimalSlider');
                    min = 100; max = 1; step = -1;
                    updateFunc = updateInfinitesimalGraph;
                    btnId = 'infinitesimalAnimationBtn';
                    textId = 'infinitesimalAnimationText';
                    animationText = 'è·‘æ­¥æ¯”èµ›åŠ¨ç”»';
                    break;
                case 'continuity':
                    slider = document.getElementById('continuitySlider');
                    min = -50; max = 50; step = 1;
                    updateFunc = updateContinuityGraph;
                    btnId = 'continuityAnimationBtn';
                    textId = 'continuityAnimationText';
                    animationText = 'ç”»çº¿åŠ¨ç”»';
                    break;
                case 'continuousOperations':
                    slider = document.getElementById('continuousOperationsSlider');
                    min = -50; max = 50; step = 2;
                    updateFunc = updateContinuousOperationsGraph;
                    btnId = 'continuousOpAnimationBtn';
                    textId = 'continuousOpAnimationText';
                    animationText = 'é—ä¼ åŠ¨ç”»';
                    break;
                case 'closedInterval':
                    slider = document.getElementById('intervalASlider');
                    min = 0; max = 100; step = 1;
                    updateFunc = updateClosedIntervalGraph;
                    btnId = 'closedIntervalAnimationBtn';
                    textId = 'closedIntervalAnimationText';
                    animationText = 'æ”¾ç¾ŠåŠ¨ç”»';
                    break;
            }
            
            if (!slider) return;
            
            let value = parseInt(slider.min) || min;
            slider.value = value;
            
            animationIntervals[type] = setInterval(() => {
                if (step > 0) {
                    value += step;
                    if (type === 'limitOperations' && value >= 30) {
                        value = 30;
                       stopAnimation(type);
                       updateAnimationButton(type, false);
                       showFunnyTip("ğŸ¯ åŠ¨ç‚¹å·²åˆ°è¾¾ç›®æ ‡ä½ç½® x=2ï¼");
                        return; // ç›´æ¥è¿”å›ï¼Œä¸å†ç»§ç»­
                           }
                    if (value > (parseInt(slider.max) || max)) {
                        value = parseInt(slider.min) || min;
                    }
                } else {
                    value += step;
                    if (value < (parseInt(slider.min) || min)) {
                        value = parseInt(slider.max) || max;
                    }
                }
                slider.value = value;
                if (updateFunc) updateFunc();
            }, 100);
            
            // æ˜¾ç¤ºæç¤º
            const funnyMessages = {
                'domain': "ğŸš€ è‡ªåŠ¨æŠ•å¸å¼€å§‹ï¼è§‚å¯Ÿå“ªäº›xå€¼èƒ½'ä¸Šè½¦'ï¼",
                'functionType': "ğŸ” æ€§æ ¼æ‰«æä¸­...çœ‹çœ‹å‡½æ•°çš„'äººæ ¼'ï¼",
                'sequence': "ğŸ’– æ‹çˆ±é•¿è·‘å¼€å§‹ï¼è§‚å¯Ÿæ— é™æ¥è¿‘çš„æµªæ¼«ï¼",
                'functionLimit': "ğŸ¯ ç„å‡†åŠ¨ç”»å¼€å§‹ï¼è§‚å¯Ÿé¶å¿ƒå¦‚ä½•å‘½ä¸­ï¼",
                'squeeze': "ğŸ¥ª ä¸‰æ˜æ²»åˆ¶ä½œä¸­...çœ‹è‚‰é¥¼å¦‚ä½•è¢«å¤¹å‡»ï¼",
                'limitOperations': "ğŸ§® è¿ç®—æ¼”ç¤ºå¼€å§‹ï¼çœ‹æ•°å­¦å¦‚ä½•'åˆä½œ'ï¼",
                'importantLimits': "â­ æ˜æ˜Ÿå‡ºé“ç§€ï¼çœ‹æé™å¦‚ä½•Cä½äº®ç›¸ï¼",
                'infinitesimal': "ğŸƒâ€â™‚ï¸ è·‘æ­¥æ¯”èµ›å¼€å§‹ï¼çœ‹è°æ›´å¿«å†²å‘0ç»ˆç‚¹ï¼",
                'continuity': "ğŸ”— ç”»çº¿åŠ¨ç”»å¼€å§‹ï¼çœ‹å‡½æ•°èƒ½ä¸èƒ½ä¸€ç¬”ç”»æˆï¼",
                'continuousOperations': "ğŸ§¬ é—ä¼ åŠ¨ç”»å¼€å§‹ï¼çœ‹è¿ç»­å¦‚ä½•'é—ä¼ 'ï¼",
                'closedInterval': "ğŸ‘ æ”¾ç¾ŠåŠ¨ç”»å¼€å§‹ï¼çœ‹ç¾Šç¾¤åœ¨å›´æ å†…çš„æ´»åŠ¨ï¼"
            };
            
            showFunnyTip(funnyMessages[type] || "åŠ¨ç”»å¼€å§‹ï¼");
        }
        
        function stopAnimation(type) {
            if (animationIntervals[type]) {
                clearInterval(animationIntervals[type]);
                animationIntervals[type] = null;
            }
        }
        
        function updateAnimationButton(type, isPlaying) {
            const btn = document.getElementById(`${type}AnimationBtn`);
            const text = document.getElementById(`${type}AnimationText`);
            
            if (btn && text) {
                if (isPlaying) {
                    btn.innerHTML = '<i class="fas fa-pause"></i> <span id="' + type + 'AnimationText">åœæ­¢åŠ¨ç”»</span>';
                    btn.classList.add('stop-btn');
                } else {
                    const buttonTexts = {
                        'domain': 'è‡ªåŠ¨æŠ•å¸æ¼”ç¤º',
                        'functionType': 'æ€§æ ¼æ‰«æ',
                        'sequence': 'æ‹çˆ±é•¿è·‘åŠ¨ç”»',
                        'functionLimit': 'ç„å‡†åŠ¨ç”»',
                        'squeeze': 'ä¸‰æ˜æ²»åˆ¶ä½œåŠ¨ç”»',
                        'limitOperations': 'è¿ç®—æ¼”ç¤ºåŠ¨ç”»',
                        'importantLimits': 'æ˜æ˜Ÿå‡ºé“åŠ¨ç”»',
                        'infinitesimal': 'è·‘æ­¥æ¯”èµ›åŠ¨ç”»',
                        'continuity': 'ç”»çº¿åŠ¨ç”»',
                        'continuousOperations': 'é—ä¼ åŠ¨ç”»',
                        'closedInterval': 'æ”¾ç¾ŠåŠ¨ç”»'
                    };
                    btn.innerHTML = '<i class="fas fa-play"></i> <span id="' + type + 'AnimationText">' + (buttonTexts[type] || 'åŠ¨ç”»æ¼”ç¤º') + '</span>';
                    btn.classList.remove('stop-btn');
                }
            }
        }
        
        // ==================== å›¾å½¢ç»˜åˆ¶è¾…åŠ©å‡½æ•° ====================
        function drawCoordinateSystem(ctx, width, height, xMin, xMax, yMin, yMax, isDiscrete = false) {
            // è®¾ç½®è¾¹è·
            const margin = { left: 60, right: 40, top: 40, bottom: 60 };
            const graphWidth = width - margin.left - margin.right;
            const graphHeight = height - margin.top - margin.bottom;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯ç½‘æ ¼
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.lineWidth = 0.5;
            
            // å‚ç›´ç½‘æ ¼çº¿
            const xGridCount = 10;
            for (let i = 0; i <= xGridCount; i++) {
                const x = margin.left + (i / xGridCount) * graphWidth;
                ctx.beginPath();
                ctx.moveTo(x, margin.top);
                ctx.lineTo(x, height - margin.bottom);
                ctx.stroke();
            }
            
            // æ°´å¹³ç½‘æ ¼çº¿
            const yGridCount = 10;
            for (let i = 0; i <= yGridCount; i++) {
                const y = margin.top + (i / yGridCount) * graphHeight;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(width - margin.right, y);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            
            // Xè½´
            ctx.beginPath();
            ctx.moveTo(margin.left, height - margin.bottom);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.stroke();
            
            // Yè½´
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.stroke();
            
            // ç»˜åˆ¶ç®­å¤´
            // Xè½´ç®­å¤´
            ctx.beginPath();
            ctx.moveTo(width - margin.right, height - margin.bottom);
            ctx.lineTo(width - margin.right - 10, height - margin.bottom - 5);
            ctx.lineTo(width - margin.right - 10, height - margin.bottom + 5);
            ctx.closePath();
            ctx.fillStyle = '#333';
            ctx.fill();
            
            // Yè½´ç®­å¤´
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left - 5, margin.top + 10);
            ctx.lineTo(margin.left + 5, margin.top + 10);
            ctx.closePath();
            ctx.fill();
            
            // ç»˜åˆ¶åˆ»åº¦
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            
            // Xè½´åˆ»åº¦
            const xStep = (xMax - xMin) / 10;
            for (let i = 0; i <= 10; i++) {
                const x = xMin + i * xStep;
                const pixelX = margin.left + (i / 10) * graphWidth;
                
                // åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(pixelX, height - margin.bottom);
                ctx.lineTo(pixelX, height - margin.bottom + 8);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                // åˆ»åº¦æ ‡ç­¾
                ctx.fillText(x.toFixed(1), pixelX, height - margin.bottom + 12);
            }
            
            // Yè½´åˆ»åº¦
            const yStep = (yMax - yMin) / 10;
            for (let i = 0; i <= 10; i++) {
                const y = yMin + i * yStep;
                const pixelY = height - margin.bottom - (i / 10) * graphHeight;
                
                // åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(margin.left, pixelY);
                ctx.lineTo(margin.left - 8, pixelY);
                ctx.stroke();
                
                // åˆ»åº¦æ ‡ç­¾
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillText(y.toFixed(1), margin.left - 12, pixelY);
            }
            
            // æ¢å¤æ–‡æœ¬å¯¹é½
            ctx.textAlign = 'left';
            ctx.textBaseline = 'alphabetic';
            
            // æ·»åŠ åæ ‡è½´æ ‡ç­¾
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Arial';
            ctx.fillText(isDiscrete ? 'n' : 'x', width - margin.right + 15, height - margin.bottom + 5);
            ctx.fillText(isDiscrete ? 'aâ‚™' : 'f(x)', margin.left - 25, margin.top - 15);
            
            return { margin, graphWidth, graphHeight };
        }
        
        // ==================== å‡½æ•°å®šä¹‰åŸŸå¯è§†åŒ– ====================
        function updateDomainGraph() {
            try {
                const slider = document.getElementById('domainSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xSliderValue').textContent = xValue.toFixed(1);
                document.getElementById('xValueDomain').textContent = xValue.toFixed(1);
                
                // è®¡ç®—å‡½æ•°å€¼å’Œå®šä¹‰åŸŸåˆ¤æ–­
                let funcValue, inDomain, domainRange, currentFunction;
                
                switch(domainFunctionType) {
                    case 1:
                        if (xValue >= -2 && xValue !== 1) {
                            funcValue = Math.sqrt(xValue + 2) / (xValue - 1);
                            inDomain = "æ˜¯";
                        } else {
                            funcValue = NaN;
                            inDomain = "å¦";
                        }
                        domainRange = "[-2,1)âˆª(1,âˆ)";
                        currentFunction = "f(x)=âˆš(x+2)/(x-1)";
                        break;
                    case 2:
                        if (xValue !== 2) {
                            funcValue = 1 / (xValue - 2);
                            inDomain = "æ˜¯";
                        } else {
                            funcValue = NaN;
                            inDomain = "å¦";
                        }
                        domainRange = "(-âˆ,2)âˆª(2,âˆ)";
                        currentFunction = "f(x)=1/(x-2)";
                        break;
                    case 3:
                        if (xValue > 0) {
                            funcValue = Math.log(xValue);
                            inDomain = "æ˜¯";
                        } else {
                            funcValue = NaN;
                            inDomain = "å¦";
                        }
                        domainRange = "(0,âˆ)";
                        currentFunction = "f(x)=ln(x)";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('funcValueDomain').textContent = isNaN(funcValue) ? "æœªå®šä¹‰" : funcValue.toFixed(3);
                document.getElementById('inDomain').textContent = inDomain;
                document.getElementById('domainRange').textContent = domainRange;
                document.getElementById('currentFunction').textContent = currentFunction;
                
                // ç»˜åˆ¶å›¾å½¢
                drawDomainGraph(xValue, funcValue, inDomain);
            } catch (error) {
                console.error('æ›´æ–°å®šä¹‰åŸŸå›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawDomainGraph(xValue, funcValue, inDomain) {
            if (!domainCtx) return;
            
            const canvas = document.getElementById('domainCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -5, xMax = 5, yMin = -5, yMax = 5;
            const coords = drawCoordinateSystem(domainCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            domainCtx.strokeStyle = '#ff6b9d';
            domainCtx.lineWidth = 3;
            domainCtx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y, isValid = true;
                
                switch(domainFunctionType) {
                    case 1:
                        if (x >= -2 && x !== 1) {
                            y = Math.sqrt(x + 2) / (x - 1);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                    case 2:
                        if (x !== 2) {
                            y = 1 / (x - 2);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                    case 3:
                        if (x > 0) {
                            y = Math.log(x);
                            if (Math.abs(y) > 10) isValid = false;
                        } else isValid = false;
                        break;
                }
                
                if (isValid && !isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (firstPoint) {
                        domainCtx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        domainCtx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            domainCtx.stroke();
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (inDomain === "æ˜¯" && !isNaN(funcValue)) {
                const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height - coords.margin.bottom - ((funcValue - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                // ç»˜åˆ¶ç‚¹
                domainCtx.fillStyle = '#20c997';
                domainCtx.beginPath();
                domainCtx.arc(pixelX, pixelY, 10, 0, Math.PI * 2);
                domainCtx.fill();
            }
        }
        
        function changeDomainFunction(type) {
            domainFunctionType = type;
            stopAnimation('domain');
            updateDomainGraph();
            
            const functionNames = [
                "f(x)=âˆš(x+2)/(x-1)",
                "f(x)=1/(x-2)", 
                "f(x)=ln(x)"
            ];
            showFunnyTip(`åˆ‡æ¢åˆ°å”®è´§æœº: ${functionNames[type-1]} ğŸ¯`);
        }
        
        // ==================== å‡½æ•°ç±»å‹å¯è§†åŒ– ====================
        function updateFunctionTypeGraph() {
            try {
                const slider = document.getElementById('functionTypeSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xTypeSliderValue').textContent = xValue.toFixed(1);
                document.getElementById('xValueDomain').textContent = xValue.toFixed(1);
                
                // è®¡ç®—å‡½æ•°å€¼
                let fValue, fNegValue, typeName, parityCheck;
                
                switch(functionType) {
                    case 1: // f(x)=xÂ³ å¥‡å‡½æ•°
                        fValue = Math.pow(xValue, 3);
                        fNegValue = Math.pow(-xValue, 3);
                        typeName = "å¥‡å‡½æ•°";
                        parityCheck = Math.abs(fNegValue + fValue) < 0.001 ? "é€šè¿‡" : "ä¸é€šè¿‡";
                        break;
                    case 2: // f(x)=xÂ² å¶å‡½æ•°
                        fValue = Math.pow(xValue, 2);
                        fNegValue = Math.pow(-xValue, 2);
                        typeName = "å¶å‡½æ•°";
                        parityCheck = Math.abs(fNegValue - fValue) < 0.001 ? "é€šè¿‡" : "ä¸é€šè¿‡";
                        break;
                    case 3: // f(x)=sin(x) å‘¨æœŸå‡½æ•°
                        fValue = Math.sin(xValue);
                        fNegValue = Math.sin(-xValue);
                        typeName = "å‘¨æœŸå‡½æ•°";
                        parityCheck = "å‘¨æœŸæ€§éªŒè¯";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('funcValueType').textContent = fValue.toFixed(3);
                document.getElementById('funcNegValue').textContent = fNegValue.toFixed(3);
                document.getElementById('functionTypeName').textContent = typeName;
                document.getElementById('parityCheck').textContent = parityCheck;
                document.getElementById('verticalTestStatus').textContent = showVerticalTest ? "å¼€å¯" : "å…³é—­";
                
                // ç»˜åˆ¶å›¾å½¢
                drawFunctionTypeGraph(xValue, fValue, fNegValue);
            } catch (error) {
                console.error('æ›´æ–°å‡½æ•°ç±»å‹å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawFunctionTypeGraph(xValue, fValue, fNegValue) {
            if (!functionTypeCtx) return;
            
            const canvas = document.getElementById('functionTypeCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -5, xMax = 5, yMin = -5, yMax = 5;
            const coords = drawCoordinateSystem(functionTypeCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            functionTypeCtx.strokeStyle = '#5d6afb';
            functionTypeCtx.lineWidth = 3;
            functionTypeCtx.beginPath();
            
            const step = (xMax - xMin) / 200;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                switch(functionType) {
                    case 1: y = Math.pow(x, 3); break;
                    case 2: y = Math.pow(x, 2); break;
                    case 3: y = Math.sin(x); break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (x === xMin) {
                        functionTypeCtx.moveTo(pixelX, pixelY);
                    } else {
                        functionTypeCtx.lineTo(pixelX, pixelY);
                    }
                }
            }
            functionTypeCtx.stroke();
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
            const pixelY = height - coords.margin.bottom - ((fValue - yMin) / (yMax - yMin)) * coords.graphHeight;
            
            functionTypeCtx.fillStyle = '#20c997';
            functionTypeCtx.beginPath();
            functionTypeCtx.arc(pixelX, pixelY, 8, 0, Math.PI * 2);
            functionTypeCtx.fill();
            
            // ç»˜åˆ¶å¯¹ç§°ç‚¹
            if (showVerticalTest && functionType !== 3) {
                const negPixelX = coords.margin.left + ((-xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
                const negPixelY = height - coords.margin.bottom - ((fNegValue - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                functionTypeCtx.fillStyle = '#ff6b9d';
                functionTypeCtx.beginPath();
                functionTypeCtx.arc(negPixelX, negPixelY, 8, 0, Math.PI * 2);
                functionTypeCtx.fill();
                
                // ç»˜åˆ¶å¯¹ç§°çº¿
                functionTypeCtx.strokeStyle = 'rgba(255, 107, 157, 0.5)';
                functionTypeCtx.lineWidth = 1;
                functionTypeCtx.setLineDash([5, 5]);
                functionTypeCtx.beginPath();
                functionTypeCtx.moveTo(pixelX, pixelY);
                functionTypeCtx.lineTo(negPixelX, negPixelY);
                functionTypeCtx.stroke();
                functionTypeCtx.setLineDash([]);
            }
            
            // ç»˜åˆ¶å¯¹ç§°è½´
            if (showVerticalTest) {
                functionTypeCtx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
                functionTypeCtx.lineWidth = 1;
                functionTypeCtx.setLineDash([3, 3]);
                
                // yè½´
                functionTypeCtx.beginPath();
                const yAxisX = coords.margin.left + ((0 - xMin) / (xMax - xMin)) * coords.graphWidth;
                functionTypeCtx.moveTo(yAxisX, coords.margin.top);
                functionTypeCtx.lineTo(yAxisX, height - coords.margin.bottom);
                functionTypeCtx.stroke();
                
                // xè½´
                functionTypeCtx.beginPath();
                const xAxisY = height - coords.margin.bottom - ((0 - yMin) / (yMax - yMin)) * coords.graphHeight;
                functionTypeCtx.moveTo(coords.margin.left, xAxisY);
                functionTypeCtx.lineTo(width - coords.margin.right, xAxisY);
                functionTypeCtx.stroke();
                
                functionTypeCtx.setLineDash([]);
            }
        }
        
        function changeFunctionType(type) {
            functionType = type;
            stopAnimation('functionType');
            updateFunctionTypeGraph();
            
            const typeNames = ["å›é€†å¥‡å‡½æ•°", "ä¿å®ˆå¶å‡½æ•°", "å¤è¯»å‘¨æœŸå‡½æ•°"];
            showFunnyTip(`åˆ‡æ¢åˆ°${typeNames[type-1]}ï¼ğŸ­`);
        }
        
        function toggleVerticalTest() {
            showVerticalTest = !showVerticalTest;
            updateFunctionTypeGraph();
        }
        
        // ==================== æ•°åˆ—æé™å¯è§†åŒ– ====================
        function updateSequenceGraph() {
            try {
                const nSlider = document.getElementById('sequenceSlider');
                const epsilonSlider = document.getElementById('epsilonSlider');
                
                if (!nSlider || !epsilonSlider) return;
                
                const n = parseInt(nSlider.value);
                const epsilon = parseFloat(epsilonSlider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('nSliderValue').textContent = n;
                document.getElementById('epsilonValue').textContent = epsilon.toFixed(2);
                
                let an, limitA;
                
                switch(sequenceType) {
                    case 1:
                        an = 1 + 1 / n;
                        limitA = 1;
                        break;
                    case 2:
                        an = (n - 1) / n;
                        limitA = 1;
                        break;
                    case 3:
                        an = Math.pow(-1, n) / n;
                        limitA = 0;
                        break;
                }
                
                const difference = Math.abs(an - limitA);
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('nValue').textContent = n;
                document.getElementById('anValue').textContent = an.toFixed(3);
                document.getElementById('limitA').textContent = limitA;
                document.getElementById('differenceValue').textContent = difference.toFixed(3);
                
                // ç»˜åˆ¶å›¾å½¢
                drawSequenceGraph(n, an, limitA, epsilon);
            } catch (error) {
                console.error('æ›´æ–°æ•°åˆ—æé™å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawSequenceGraph(n, an, limitA, epsilon) {
            if (!sequenceCtx) return;
            
            const canvas = document.getElementById('sequenceCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const nMin = 1;
            const nMax = Math.max(20, n * 1.5);
            const aMin = Math.min(limitA - 1, limitA - 2 * epsilon);
            const aMax = Math.max(limitA + 1, limitA + 2 * epsilon);
            
            const coords = drawCoordinateSystem(sequenceCtx, width, height, nMin, nMax, aMin, aMax, true);
            
            // ç»˜åˆ¶æé™çº¿
            sequenceCtx.strokeStyle = 'rgba(255, 0, 0, 0.7)';
            sequenceCtx.lineWidth = 2;
            sequenceCtx.setLineDash([5, 5]);
            
            const limitY = height - coords.margin.bottom - ((limitA - aMin) / (aMax - aMin)) * coords.graphHeight;
            sequenceCtx.beginPath();
            sequenceCtx.moveTo(coords.margin.left, limitY);
            sequenceCtx.lineTo(width - coords.margin.right, limitY);
            sequenceCtx.stroke();
            
            sequenceCtx.setLineDash([]);
            
            // ç»˜åˆ¶æ•°åˆ—ç‚¹
            sequenceCtx.fillStyle = '#5d6afb';
            const maxPoints = Math.min(50, nMax);
            
            for (let i = 1; i <= maxPoints; i++) {
                let currentAn;
                switch(sequenceType) {
                    case 1: currentAn = 1 + 1 / i; break;
                    case 2: currentAn = (i - 1) / i; break;
                    case 3: currentAn = Math.pow(-1, i) / i; break;
                }
                
                const x = coords.margin.left + ((i - nMin) / (nMax - nMin)) * coords.graphWidth;
                const y = height - coords.margin.bottom - ((currentAn - aMin) / (aMax - aMin)) * coords.graphHeight;
                
                // ç»˜åˆ¶ç‚¹
                sequenceCtx.beginPath();
                sequenceCtx.arc(x, y, 4, 0, Math.PI * 2);
                sequenceCtx.fill();
                
                // çªå‡ºæ˜¾ç¤ºå½“å‰nçš„ç‚¹
                if (i === n && i <= maxPoints) {
                    sequenceCtx.fillStyle = '#20c997';
                    sequenceCtx.beginPath();
                    sequenceCtx.arc(x, y, 8, 0, Math.PI * 2);
                    sequenceCtx.fill();
                    sequenceCtx.fillStyle = '#5d6afb';
                }
            }
            
            // ç»˜åˆ¶Îµå¸¦
            sequenceCtx.fillStyle = 'rgba(255, 107, 157, 0.1)';
            const epsilonTop = height - coords.margin.bottom - (((limitA + epsilon) - aMin) / (aMax - aMin)) * coords.graphHeight;
            const epsilonBottom = height - coords.margin.bottom - (((limitA - epsilon) - aMin) / (aMax - aMin)) * coords.graphHeight;
            sequenceCtx.fillRect(coords.margin.left, epsilonTop, coords.graphWidth, epsilonBottom - epsilonTop);
            
            // ç»˜åˆ¶Îµè¾¹ç•Œçº¿
            sequenceCtx.strokeStyle = 'rgba(255, 107, 157, 0.5)';
            sequenceCtx.lineWidth = 1;
            sequenceCtx.setLineDash([3, 3]);
            sequenceCtx.beginPath();
            sequenceCtx.moveTo(coords.margin.left, epsilonTop);
            sequenceCtx.lineTo(width - coords.margin.right, epsilonTop);
            sequenceCtx.moveTo(coords.margin.left, epsilonBottom);
            sequenceCtx.lineTo(width - coords.margin.right, epsilonBottom);
            sequenceCtx.stroke();
            sequenceCtx.setLineDash([]);
        }
        
        function changeSequence(type) {
            sequenceType = type;
            stopAnimation('sequence');
            updateSequenceGraph();
            
            const sequenceNames = ["1 + 1/n", "(n-1)/n", "(-1)â¿/n"];
            showFunnyTip(`åˆ‡æ¢åˆ°è¿½æ±‚: aâ‚™ = ${sequenceNames[type-1]} ğŸ’–`);
        }
        
        // ==================== å‡½æ•°æé™å¯è§†åŒ– ====================
        function updateFunctionLimitGraph() {
            try {
                const xSlider = document.getElementById('xLimitSlider');
                const epsilonSlider = document.getElementById('epsilonLimitSlider');
                
                if (!xSlider || !epsilonSlider) return;
                
                const xValue = parseFloat(xSlider.value) / 10;
                const epsilon = parseFloat(epsilonSlider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xLimitSliderValue').textContent = xValue.toFixed(1);
                document.getElementById('epsilonLimitValue').textContent = epsilon.toFixed(2);
                
                let fx, limitA, x0;
                
                switch(functionLimitType) {
                    case 1:
                        fx = xValue * xValue;
                        limitA = 4;
                        x0 = 2;
                        break;
                    case 2:
                        fx = (xValue * xValue - 1) / (xValue - 1);
                        if (Math.abs(xValue - 1) < 0.001) fx = 2;
                        limitA = 2;
                        x0 = 1;
                        break;
                    case 3:
                        if (Math.abs(xValue) > 0.001) {
                            fx = Math.sin(1 / xValue);
                        } else {
                            fx = NaN;
                        }
                        limitA = NaN;
                        x0 = 0;
                        break;
                }
                
                const difference = isNaN(fx) || isNaN(limitA) ? NaN : Math.abs(fx - limitA);
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('xValueLimit').textContent = xValue.toFixed(1);
                document.getElementById('fxValueLimit').textContent = isNaN(fx) ? "æœªå®šä¹‰" : fx.toFixed(3);
                document.getElementById('limitValue').textContent = isNaN(limitA) ? "ä¸å­˜åœ¨" : limitA.toFixed(1);
                document.getElementById('limitDiffValue').textContent = isNaN(difference) ? "æœªå®šä¹‰" : difference.toFixed(3);
                
                // ç»˜åˆ¶å›¾å½¢
                drawFunctionLimitGraph(xValue, fx, limitA, epsilon, x0);
            } catch (error) {
                console.error('æ›´æ–°å‡½æ•°æé™å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawFunctionLimitGraph(xValue, fx, limitA, epsilon, x0) {
            if (!functionLimitCtx) return;
            
            const canvas = document.getElementById('functionLimitCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax;
            switch(functionLimitType) {
                case 1: xMin = -3; xMax = 5; break;
                case 2: xMin = -1; xMax = 3; break;
                case 3: xMin = -2; xMax = 2; break;
            }
            const yMin = -3;
            const yMax = 3;
            
            const coords = drawCoordinateSystem(functionLimitCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            functionLimitCtx.strokeStyle = '#5d6afb';
            functionLimitCtx.lineWidth = 3;
            functionLimitCtx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(functionLimitType) {
                    case 1:
                        y = x * x;
                        break;
                    case 2:
                        if (Math.abs(x - 1) > 0.01) {
                            y = (x * x - 1) / (x - 1);
                        } else {
                            continue;
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.01) {
                            y = Math.sin(1 / x);
                        } else {
                            continue;
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (firstPoint) {
                        functionLimitCtx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        functionLimitCtx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            functionLimitCtx.stroke();
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(fx)) {
                const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height - coords.margin.bottom - ((fx - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                functionLimitCtx.fillStyle = '#20c997';
                functionLimitCtx.beginPath();
                functionLimitCtx.arc(pixelX, pixelY, 8, 0, Math.PI * 2);
                functionLimitCtx.fill();
            }
            
            // ç»˜åˆ¶æé™ç‚¹å’ŒÎµå¸¦
            if (!isNaN(limitA)) {
                // æé™ç‚¹
                const limitPixelX = coords.margin.left + ((x0 - xMin) / (xMax - xMin)) * coords.graphWidth;
                const limitPixelY = height - coords.margin.bottom - ((limitA - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                functionLimitCtx.fillStyle = 'rgba(255, 0, 0, 0.7)';
                functionLimitCtx.beginPath();
                functionLimitCtx.arc(limitPixelX, limitPixelY, 6, 0, Math.PI * 2);
                functionLimitCtx.fill();
                
                // Îµå¸¦
                functionLimitCtx.fillStyle = 'rgba(255, 107, 157, 0.1)';
                const epsilonTop = height - coords.margin.bottom - (((limitA + epsilon) - yMin) / (yMax - yMin)) * coords.graphHeight;
                const epsilonBottom = height - coords.margin.bottom - (((limitA - epsilon) - yMin) / (yMax - yMin)) * coords.graphHeight;
                functionLimitCtx.fillRect(coords.margin.left, epsilonTop, coords.graphWidth, epsilonBottom - epsilonTop);
                
                // Î´å¸¦
                const delta = epsilon / 2; // ç®€åŒ–çš„Î´å€¼
                const deltaLeft = coords.margin.left + ((x0 - delta - xMin) / (xMax - xMin)) * coords.graphWidth;
                const deltaRight = coords.margin.left + ((x0 + delta - xMin) / (xMax - xMin)) * coords.graphWidth;
                
                functionLimitCtx.fillStyle = 'rgba(93, 106, 251, 0.1)';
                functionLimitCtx.fillRect(deltaLeft, coords.margin.top, deltaRight - deltaLeft, coords.graphHeight);
            }
        }
        
        function changeFunctionLimit(type) {
            functionLimitType = type;
            stopAnimation('functionLimit');
            updateFunctionLimitGraph();
            
            const limitNames = ["xÂ² (xâ†’2)", "(xÂ²-1)/(x-1) (xâ†’1)", "sin(1/x) (xâ†’0)"];
            showFunnyTip(`åˆ‡æ¢åˆ°é¶åœº: ${limitNames[type-1]} ğŸ¯`);
        }
        
        // ==================== å¤¹é€¼å‡†åˆ™å¯è§†åŒ– ====================
        function updateSqueezeGraph() {
            try {
                const slider = document.getElementById('squeezeSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 100;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xSqueezeSliderValue').textContent = xValue.toFixed(2);
                
                let gx, fx, hx, limit;
                
                switch(squeezeType) {
                    case 1:
                        if (Math.abs(xValue) > 0.001) {
                            fx = xValue * Math.sin(1 / xValue);
                        } else {
                            fx = 0;
                        }
                        gx = -Math.abs(xValue);
                        hx = Math.abs(xValue);
                        limit = 0;
                        break;
                    case 2:
                        fx = (xValue * xValue + 1) / (xValue * xValue + 2);
                        gx = 1 / (xValue * xValue + 2);
                        hx = 1;
                        limit = 1;
                        break;
                    case 3:
                        if (Math.abs(xValue) > 0.001) {
                            fx = Math.sin(xValue) / xValue;
                        } else {
                            fx = 1;
                        }
                        gx = Math.cos(xValue);
                        hx = 1;
                        limit = 1;
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('xValueSqueeze').textContent = xValue.toFixed(2);
                document.getElementById('gxValue').textContent = gx.toFixed(3);
                document.getElementById('fxValueSqueeze').textContent = fx.toFixed(3);
                document.getElementById('hxValue').textContent = hx.toFixed(3);
                document.getElementById('squeezeLimit').textContent = limit;
                
                // ç»˜åˆ¶å›¾å½¢
                drawSqueezeGraph(xValue, gx, fx, hx, limit);
            } catch (error) {
                console.error('æ›´æ–°å¤¹é€¼å‡†åˆ™å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawSqueezeGraph(xValue, gx, fx, hx, limit) {
            if (!squeezeCtx) return;
            
            const canvas = document.getElementById('squeezeCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 2;
            const yMin = -1;
            const yMax = 2;
            
            const coords = drawCoordinateSystem(squeezeCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            const functions = [
                {color: '#5d6afb', value: gx, name: 'ä¸‹é¢åŒ…g(x)'},
                {color: '#ff6b9d', value: fx, name: 'è‚‰é¥¼f(x)'},
                {color: '#20c997', value: hx, name: 'ä¸Šé¢åŒ…h(x)'}
            ];
            
            functions.forEach(func => {
                squeezeCtx.strokeStyle = func.color;
                squeezeCtx.lineWidth = 2;
                squeezeCtx.beginPath();
                
                const step = (xMax - xMin) / 100;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(squeezeType) {
                        case 1:
                            if (func.name.includes('g')) y = -Math.abs(x);
                            else if (func.name.includes('f')) {
                                if (Math.abs(x) > 0.001) y = x * Math.sin(1 / x);
                                else y = 0;
                            }
                            else if (func.name.includes('h')) y = Math.abs(x);
                            break;
                        case 2:
                            if (func.name.includes('g')) y = 1 / (x * x + 2);
                            else if (func.name.includes('f')) y = (x * x + 1) / (x * x + 2);
                            else if (func.name.includes('h')) y = 1;
                            break;
                        case 3:
                            if (func.name.includes('g')) y = Math.cos(x);
                            else if (func.name.includes('f')) {
                                if (Math.abs(x) > 0.001) y = Math.sin(x) / x;
                                else y = 1;
                            }
                            else if (func.name.includes('h')) y = 1;
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                        const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                        
                        if (x === xMin) {
                            squeezeCtx.moveTo(pixelX, pixelY);
                        } else {
                            squeezeCtx.lineTo(pixelX, pixelY);
                        }
                    }
                }
                squeezeCtx.stroke();
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
            
            functions.forEach(func => {
                let y;
                switch(squeezeType) {
                    case 1:
                        if (func.name.includes('g')) y = -Math.abs(xValue);
                        else if (func.name.includes('f')) {
                            if (Math.abs(xValue) > 0.001) y = xValue * Math.sin(1 / xValue);
                            else y = 0;
                        }
                        else if (func.name.includes('h')) y = Math.abs(xValue);
                        break;
                    case 2:
                        if (func.name.includes('g')) y = 1 / (xValue * xValue + 2);
                        else if (func.name.includes('f')) y = (xValue * xValue + 1) / (xValue * xValue + 2);
                        else if (func.name.includes('h')) y = 1;
                        break;
                    case 3:
                        if (func.name.includes('g')) y = Math.cos(xValue);
                        else if (func.name.includes('f')) {
                            if (Math.abs(xValue) > 0.001) y = Math.sin(xValue) / xValue;
                            else y = 1;
                        }
                        else if (func.name.includes('h')) y = 1;
                        break;
                }
                
                const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                squeezeCtx.fillStyle = func.color;
                squeezeCtx.beginPath();
                squeezeCtx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                squeezeCtx.fill();
            });
            
            // ç»˜åˆ¶æé™çº¿
            squeezeCtx.strokeStyle = 'rgba(255, 0, 0, 0.7)';
            squeezeCtx.lineWidth = 2;
            squeezeCtx.setLineDash([5, 5]);
            
            const limitY = height - coords.margin.bottom - ((limit - yMin) / (yMax - yMin)) * coords.graphHeight;
            squeezeCtx.beginPath();
            squeezeCtx.moveTo(coords.margin.left, limitY);
            squeezeCtx.lineTo(width - coords.margin.right, limitY);
            squeezeCtx.stroke();
            squeezeCtx.setLineDash([]);
        }
        
        function changeSqueezeFunction(type) {
            squeezeType = type;
            stopAnimation('squeeze');
            updateSqueezeGraph();
            
            const squeezeNames = ["x sin(1/x)", "(xÂ²+1)/(xÂ²+2)", "sin(x)/x"];
            showFunnyTip(`åˆ‡æ¢åˆ°ä¸‰æ˜æ²»: ${squeezeNames[type-1]} ğŸ¥ª`);
        }
        
        // ==================== æé™è¿ç®—å¯è§†åŒ– ====================
        function updateLimitOperationsGraph() {
            try {
                const slider = document.getElementById('limitOpSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 100 + 1;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xOpSliderValue').textContent = xValue.toFixed(2);
                
                let fValue, gValue, result, limitF, limitG, limitResult;
                let approachPoint = "xâ†’2";
                let operationType;
                
                switch(limitOperationType) {
                    case 1: // åŠ æ³•
                        fValue = xValue * xValue;
                        gValue = 2 * xValue;
                        result = fValue + gValue;
                        limitF = 4;
                        limitG = 4;
                        limitResult = 8;
                        operationType = "åŠ æ³•";
                        break;
                    case 2: // å‡æ³•
                        fValue = xValue * xValue;
                        gValue = xValue + 1;
                        result = fValue - gValue;
                        limitF = 4;
                        limitG = 3;
                        limitResult = 1;
                        operationType = "å‡æ³•";
                        break;
                    case 3: // ä¹˜æ³•
                        fValue = xValue;
                        gValue = xValue + 1;
                        result = fValue * gValue;
                        limitF = 2;
                        limitG = 3;
                        limitResult = 6;
                        operationType = "ä¹˜æ³•";
                        break;
                    case 4: // é™¤æ³•
                        fValue = xValue * xValue;
                        gValue = xValue;
                        result = fValue / gValue;
                        limitF = 4;
                        limitG = 2;
                        limitResult = 2;
                        operationType = "é™¤æ³•";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('operationType').textContent = operationType;
                document.getElementById('limitF').textContent = limitF.toFixed(1);
                document.getElementById('limitG').textContent = limitG.toFixed(1);
                document.getElementById('limitResult').textContent = limitResult.toFixed(1);
                document.getElementById('approachPoint').textContent = approachPoint;
                
                // ç»˜åˆ¶å›¾å½¢
                drawLimitOperationsGraph(xValue, fValue, gValue, result);
            } catch (error) {
                console.error('æ›´æ–°æé™è¿ç®—å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawLimitOperationsGraph(xValue, fValue, gValue, result) {
            if (!limitOperationsCtx) return;
            
            const canvas = document.getElementById('limitOperationsCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 4;
            const yMin = 0;
            const yMax = 10;
            
            const coords = drawCoordinateSystem(limitOperationsCtx, width, height, xMin, xMax, yMin, yMax);
            
            // å®šä¹‰ä¸‰ç§é¢œè‰²
            const colors = ['#5d6afb', '#20c997', '#ff6b9d'];
            const functionNames = ['f(x)', 'g(x)', 'f(x) op g(x)'];
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            for (let i = 0; i < 3; i++) {
                limitOperationsCtx.strokeStyle = colors[i];
                limitOperationsCtx.lineWidth = 2;
                limitOperationsCtx.beginPath();
                
                const step = (xMax - xMin) / 100;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(limitOperationType) {
                        case 1: // åŠ æ³•
                            if (i === 0) y = x * x;
                            else if (i === 1) y = 2 * x;
                            else y = x * x + 2 * x;
                            break;
                        case 2: // å‡æ³•
                            if (i === 0) y = x * x;
                            else if (i === 1) y = x + 1;
                            else y = x * x - (x + 1);
                            break;
                        case 3: // ä¹˜æ³•
                            if (i === 0) y = x;
                            else if (i === 1) y = x + 1;
                            else y = x * (x + 1);
                            break;
                        case 4: // é™¤æ³•
                            if (i === 0) y = x * x;
                            else if (i === 1) y = x;
                            else y = x;
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                        const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                        
                        if (x === xMin) {
                            limitOperationsCtx.moveTo(pixelX, pixelY);
                        } else {
                            limitOperationsCtx.lineTo(pixelX, pixelY);
                        }
                    }
                }
                limitOperationsCtx.stroke();
                
                // æ·»åŠ å‡½æ•°æ ‡ç­¾
                limitOperationsCtx.fillStyle = colors[i];
                limitOperationsCtx.font = 'bold 12px Arial';
                limitOperationsCtx.fillText(functionNames[i], width - 80, 30 + i * 20);
            }
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [fValue, gValue, result];
            const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
            
            for (let i = 0; i < 3; i++) {
                const y = values[i];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    limitOperationsCtx.fillStyle = colors[i];
                    limitOperationsCtx.beginPath();
                    limitOperationsCtx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                    limitOperationsCtx.fill();
                }
            }
        }
        
        function changeLimitOperation(type) {
            limitOperationType = type;
            stopAnimation('limitOperations');
            updateLimitOperationsGraph();
            
            const operationNames = ["åŠ æ³•è¿ç®—", "å‡æ³•è¿ç®—", "ä¹˜æ³•è¿ç®—", "é™¤æ³•è¿ç®—"];
            showFunnyTip(`åˆ‡æ¢åˆ°${operationNames[type-1]}ï¼ğŸ§®`);
        }
        
        // ==================== é‡è¦æé™å¯è§†åŒ– ====================
        function updateImportantLimitsGraph() {
            try {
                const slider = document.getElementById('importantLimitsSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xImportantSliderValue').textContent = xValue.toFixed(2);
                
                let currentValue, limitValue, limitType, limitTarget;
                
                switch(importantLimitType) {
                    case 1:
                        if (Math.abs(xValue) > 0.001) {
                            currentValue = Math.sin(xValue) / xValue;
                        } else {
                            currentValue = 1;
                        }
                        limitValue = 1;
                        limitType = "æ­£å¼¦æ˜æ˜Ÿ";
                        limitTarget = "1";
                        break;
                    case 2:
                        if (Math.abs(xValue) > 0.001) {
                            currentValue = Math.pow(1 + 1/xValue, xValue);
                        } else {
                            currentValue = Math.E;
                        }
                        limitValue = Math.E;
                        limitType = "è‡ªç„¶æ•°æ˜æ˜Ÿ";
                        limitTarget = "eâ‰ˆ2.718";
                        break;
                    case 3:
                        if (Math.abs(xValue) > 0.001) {
                            currentValue = Math.pow(1 + xValue, 1/xValue);
                        } else {
                            currentValue = Math.E;
                        }
                        limitValue = Math.E;
                        limitType = "è‡ªç„¶æ•°æ˜æ˜Ÿå˜å½¢";
                        limitTarget = "eâ‰ˆ2.718";
                        break;
                }
                
                const difference = Math.abs(currentValue - limitValue);
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('importantLimitType').textContent = limitType;
                document.getElementById('importantLimitValue').textContent = currentValue.toFixed(4);
                document.getElementById('importantLimitResult').textContent = limitType === "æ­£å¼¦æ˜æ˜Ÿ" ? "1" : "eâ‰ˆ2.718";
                document.getElementById('importantLimitDiff').textContent = difference.toFixed(4);
                document.getElementById('importantLimitTarget').textContent = limitTarget;
                
                // ç»˜åˆ¶å›¾å½¢
                drawImportantLimitsGraph(xValue, currentValue, limitValue);
            } catch (error) {
                console.error('æ›´æ–°é‡è¦æé™å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawImportantLimitsGraph(xValue, currentValue, limitValue) {
            if (!importantLimitsCtx) return;
            
            const canvas = document.getElementById('importantLimitsCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax, yMin, yMax;
            
            switch(importantLimitType) {
                case 1:
                    xMin = -2;
                    xMax = 2;
                    yMin = 0;
                    yMax = 1.2;
                    break;
                case 2:
                    xMin = 0.1;
                    xMax = 10;
                    yMin = 1;
                    yMax = 3;
                    break;
                case 3:
                    xMin = -0.9;
                    xMax = 2;
                    yMin = 1;
                    yMax = 3;
                    break;
            }
            
            const coords = drawCoordinateSystem(importantLimitsCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            importantLimitsCtx.strokeStyle = '#5d6afb';
            importantLimitsCtx.lineWidth = 3;
            importantLimitsCtx.beginPath();
            
            const step = (xMax - xMin) / 100;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(importantLimitType) {
                    case 1:
                        if (Math.abs(x) > 0.001) {
                            y = Math.sin(x) / x;
                        } else {
                            y = 1;
                        }
                        break;
                    case 2:
                        if (Math.abs(x) > 0.001) {
                            y = Math.pow(1 + 1/x, x);
                        } else {
                            continue;
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.001 && x > -1) {
                            y = Math.pow(1 + x, 1/x);
                        } else {
                            continue;
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (x === xMin) {
                        importantLimitsCtx.moveTo(pixelX, pixelY);
                    } else {
                        importantLimitsCtx.lineTo(pixelX, pixelY);
                    }
                }
            }
            importantLimitsCtx.stroke();
            
            // ç»˜åˆ¶æé™çº¿
            importantLimitsCtx.strokeStyle = 'rgba(255, 0, 0, 0.7)';
            importantLimitsCtx.lineWidth = 2;
            importantLimitsCtx.setLineDash([5, 5]);
            
            const limitY = height - coords.margin.bottom - ((limitValue - yMin) / (yMax - yMin)) * coords.graphHeight;
            importantLimitsCtx.beginPath();
            importantLimitsCtx.moveTo(coords.margin.left, limitY);
            importantLimitsCtx.lineTo(width - coords.margin.right, limitY);
            importantLimitsCtx.stroke();
            
            importantLimitsCtx.setLineDash([]);
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(currentValue) && currentValue >= yMin && currentValue <= yMax) {
                const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height - coords.margin.bottom - ((currentValue - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                importantLimitsCtx.fillStyle = '#20c997';
                importantLimitsCtx.beginPath();
                importantLimitsCtx.arc(pixelX, pixelY, 8, 0, Math.PI * 2);
                importantLimitsCtx.fill();
            }
        }
        
        function changeImportantLimit(type) {
            importantLimitType = type;
            stopAnimation('importantLimits');
            updateImportantLimitsGraph();
            
            const limitNames = ["sin(x)/x", "(1+1/x)^x", "(1+x)^(1/x)"];
            showFunnyTip(`åˆ‡æ¢åˆ°æ˜æ˜Ÿæé™: lim ${limitNames[type-1]} â­`);
        }
        
        // ==================== æ— ç©·å°æ¯”è¾ƒå¯è§†åŒ– ====================
        function updateInfinitesimalGraph() {
            try {
                const slider = document.getElementById('infinitesimalSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 100;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xInfinitesimalSliderValue').textContent = xValue.toFixed(3);
                
                let alphaValue, betaValue, ratio, comparisonType;
                
                switch(infinitesimalType) {
                    case 1:
                        alphaValue = xValue;
                        betaValue = xValue * xValue;
                        ratio = betaValue / alphaValue;
                        comparisonType = "Î²æ›´å¿«ï¼";
                        break;
                    case 2:
                        alphaValue = xValue;
                        betaValue = 3 * xValue;
                        ratio = betaValue / alphaValue;
                        comparisonType = "åŒé€Ÿï¼";
                        break;
                    case 3:
                        alphaValue = xValue;
                        betaValue = Math.sin(xValue);
                        ratio = betaValue / alphaValue;
                        comparisonType = "å¹¶è‚©è·‘ï¼";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('xValueInfinitesimal').textContent = xValue.toFixed(3);
                document.getElementById('alphaValue').textContent = alphaValue.toFixed(4);
                document.getElementById('betaValue').textContent = betaValue.toFixed(4);
                document.getElementById('ratioValue').textContent = ratio.toFixed(4);
                document.getElementById('comparisonType').textContent = comparisonType;
                
                // ç»˜åˆ¶å›¾å½¢
                drawInfinitesimalGraph(xValue, alphaValue, betaValue, ratio);
            } catch (error) {
                console.error('æ›´æ–°æ— ç©·å°æ¯”è¾ƒå›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawInfinitesimalGraph(xValue, alphaValue, betaValue, ratio) {
            if (!infinitesimalCtx) return;
            
            const canvas = document.getElementById('infinitesimalCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = 0;
            const xMax = 1;
            const yMin = 0;
            const yMax = 1;
            
            const coords = drawCoordinateSystem(infinitesimalCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶Î±(x)å’ŒÎ²(x)æ›²çº¿
            const functions = [
                {color: '#5d6afb', value: alphaValue, name: 'è¿åŠ¨å‘˜Î±(x)'},
                {color: '#ff6b9d', value: betaValue, name: 'è¿åŠ¨å‘˜Î²(x)'}
            ];
            
            functions.forEach(func => {
                infinitesimalCtx.strokeStyle = func.color;
                infinitesimalCtx.lineWidth = 2;
                infinitesimalCtx.beginPath();
                
                const step = (xMax - xMin) / 100;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(infinitesimalType) {
                        case 1:
                            if (func.name.includes('Î±')) y = x;
                            else y = x * x;
                            break;
                        case 2:
                            if (func.name.includes('Î±')) y = x;
                            else y = 3 * x;
                            break;
                        case 3:
                            if (func.name.includes('Î±')) y = x;
                            else y = Math.sin(x);
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                        const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                        
                        if (x === xMin) {
                            infinitesimalCtx.moveTo(pixelX, pixelY);
                        } else {
                            infinitesimalCtx.lineTo(pixelX, pixelY);
                        }
                    }
                }
                infinitesimalCtx.stroke();
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [alphaValue, betaValue];
            const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
            
            functions.forEach((func, index) => {
                const y = values[index];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    infinitesimalCtx.fillStyle = func.color;
                    infinitesimalCtx.beginPath();
                    infinitesimalCtx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                    infinitesimalCtx.fill();
                }
            });
            
            // ç»˜åˆ¶ç»ˆç‚¹çº¿ï¼ˆx=0ï¼‰
            infinitesimalCtx.strokeStyle = 'rgba(0, 0, 0, 0.5)';
            infinitesimalCtx.lineWidth = 3;
            const finishX = coords.margin.left + ((0 - xMin) / (xMax - xMin)) * coords.graphWidth;
            infinitesimalCtx.beginPath();
            infinitesimalCtx.moveTo(finishX, coords.margin.top);
            infinitesimalCtx.lineTo(finishX, height - coords.margin.bottom);
            infinitesimalCtx.stroke();
            
            // æ·»åŠ ç»ˆç‚¹æ ‡ç­¾
            infinitesimalCtx.fillStyle = '#333';
            infinitesimalCtx.font = 'bold 14px Arial';
            infinitesimalCtx.fillText('ç»ˆç‚¹çº¿', finishX - 25, coords.margin.top - 10);
        }
        
        function changeInfinitesimalComparison(type) {
            infinitesimalType = type;
            stopAnimation('infinitesimal');
            updateInfinitesimalGraph();
            
            const comparisonNames = ["Î²=xÂ² (æ¯”Î±=xå¿«)", "Î²=3x (ä¸Î±=xåŒé€Ÿ)", "Î²=sin x (ä¸Î±=xå¹¶è‚©)"];
            showFunnyTip(`åˆ‡æ¢åˆ°æ¯”èµ›: ${comparisonNames[type-1]} ğŸƒâ€â™‚ï¸`);
        }
        
        // ==================== è¿ç»­æ€§å¯è§†åŒ– ====================
        function updateContinuityGraph() {
            try {
                const slider = document.getElementById('continuitySlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xContinuitySliderValue').textContent = xValue.toFixed(1);
                
                let fx, isContinuous, discontinuityType, checkPoint;
                
                switch(continuityType) {
                    case 1:
                        fx = xValue * xValue;
                        isContinuous = "æ˜¯";
                        discontinuityType = "æ— ";
                        checkPoint = "0";
                        break;
                    case 2:
                        if (Math.abs(xValue) > 0.001) {
                            fx = 1 / xValue;
                        } else {
                            fx = NaN;
                        }
                        isContinuous = xValue === 0 ? "å¦" : "æ˜¯";
                        discontinuityType = xValue === 0 ? "ç¬¬äºŒç±»é—´æ–­ç‚¹" : "æ— ";
                        checkPoint = "0";
                        break;
                    case 3:
                        if (xValue !== 0) {
                            fx = Math.sin(xValue) / xValue;
                        } else {
                            fx = 1;
                        }
                        isContinuous = "æ˜¯";
                        discontinuityType = "å¯å»é—´æ–­ç‚¹ï¼ˆå·²è¡¥å……ï¼‰";
                        checkPoint = "0";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('xValueContinuity').textContent = xValue.toFixed(1);
                document.getElementById('fxValueContinuity').textContent = isNaN(fx) ? "âˆ" : fx.toFixed(3);
                document.getElementById('isContinuous').textContent = isContinuous;
                document.getElementById('discontinuityType').textContent = discontinuityType;
                document.getElementById('checkPoint').textContent = checkPoint;
                
                // ç»˜åˆ¶å›¾å½¢
                drawContinuityGraph(xValue, fx);
            } catch (error) {
                console.error('æ›´æ–°è¿ç»­æ€§å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawContinuityGraph(xValue, fx) {
            if (!continuityCtx) return;
            
            const canvas = document.getElementById('continuityCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -2;
            const xMax = 2;
            const yMin = -2;
            const yMax = 2;
            
            const coords = drawCoordinateSystem(continuityCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            continuityCtx.strokeStyle = '#5d6afb';
            continuityCtx.lineWidth = 3;
            continuityCtx.beginPath();
            
            const step = (xMax - xMin) / 200;
            let firstPoint = true;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(continuityType) {
                    case 1:
                        y = x * x;
                        break;
                    case 2:
                        if (Math.abs(x) > 0.001) {
                            y = 1 / x;
                        } else {
                            continue;
                        }
                        break;
                    case 3:
                        if (Math.abs(x) > 0.001) {
                            y = Math.sin(x) / x;
                        } else {
                            y = 1;
                        }
                        break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (firstPoint) {
                        continuityCtx.moveTo(pixelX, pixelY);
                        firstPoint = false;
                    } else {
                        continuityCtx.lineTo(pixelX, pixelY);
                    }
                } else {
                    firstPoint = true;
                }
            }
            continuityCtx.stroke();
            
            // ç»˜åˆ¶é—´æ–­ç‚¹æ ‡è®°
            if (continuityType === 2) {
                // åœ¨x=0å¤„ç»˜åˆ¶ç©ºå¿ƒåœ†è¡¨ç¤ºé—´æ–­
                const pixelX = coords.margin.left + ((0 - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height / 2;
                
                continuityCtx.strokeStyle = '#ff6b9d';
                continuityCtx.lineWidth = 3;
                continuityCtx.beginPath();
                continuityCtx.arc(pixelX, pixelY, 10, 0, Math.PI * 2);
                continuityCtx.stroke();
                
                // æ·»åŠ æ ‡ç­¾
                continuityCtx.fillStyle = '#ff6b9d';
                continuityCtx.font = 'bold 12px Arial';
                continuityCtx.fillText('é—´æ–­ç‚¹', pixelX + 15, pixelY - 15);
            }
            
            if (continuityType === 3) {
                // åœ¨x=0å¤„ç»˜åˆ¶å®å¿ƒåœ†è¡¨ç¤ºå¯å»é—´æ–­ï¼ˆå·²è¡¥å……ï¼‰
                const pixelX = coords.margin.left + ((0 - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height - coords.margin.bottom - ((1 - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                continuityCtx.fillStyle = '#20c997';
                continuityCtx.beginPath();
                continuityCtx.arc(pixelX, pixelY, 8, 0, Math.PI * 2);
                continuityCtx.fill();
                
                // æ·»åŠ æ ‡ç­¾
                continuityCtx.fillStyle = '#20c997';
                continuityCtx.font = 'bold 12px Arial';
                continuityCtx.fillText('å¯å»é—´æ–­ç‚¹', pixelX + 15, pixelY - 15);
            }
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            if (!isNaN(fx) && fx >= yMin && fx <= yMax) {
                const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
                const pixelY = height - coords.margin.bottom - ((fx - yMin) / (yMax - yMin)) * coords.graphHeight;
                
                continuityCtx.fillStyle = '#20c997';
                continuityCtx.beginPath();
                continuityCtx.arc(pixelX, pixelY, 10, 0, Math.PI * 2);
                continuityCtx.fill();
            }
        }
        
        function changeContinuityFunction(type) {
            continuityType = type;
            stopAnimation('continuity');
            updateContinuityGraph();
            
            const continuityNames = ["xÂ² (è¿ç»­)", "1/x (x=0é—´æ–­)", "åˆ†æ®µå‡½æ•° (å¯å»é—´æ–­)"];
            showFunnyTip(`åˆ‡æ¢åˆ°ç”»çº¿: ${continuityNames[type-1]} ğŸ”—`);
        }
        
        // ==================== è¿ç»­è¿ç®—å¯è§†åŒ– ====================
        function updateContinuousOperationsGraph() {
            try {
                const slider = document.getElementById('continuousOperationsSlider');
                if (!slider) return;
                
                const xValue = parseFloat(slider.value) / 10;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                document.getElementById('xContinuousSliderValue').textContent = xValue.toFixed(1);
                
                let fValue, gValue, result, opType, continuousPoint;
                
                switch(continuousOpType) {
                    case 1:
                        fValue = Math.sin(xValue);
                        gValue = Math.cos(xValue);
                        result = fValue + gValue;
                        opType = "åŠ æ³•é—ä¼ ";
                        continuousPoint = "x=0";
                        break;
                    case 2:
                        fValue = xValue;
                        gValue = Math.exp(xValue);
                        result = fValue * gValue;
                        opType = "ä¹˜æ³•é—ä¼ ";
                        continuousPoint = "x=0";
                        break;
                    case 3:
                        fValue = Math.sin(xValue);
                        gValue = xValue * xValue;
                        result = Math.sin(xValue * xValue);
                        opType = "å¤åˆé—ä¼ ";
                        continuousPoint = "x=0";
                        break;
                    case 4:
                        fValue = Math.sin(xValue);
                        gValue = xValue;
                        if (Math.abs(xValue) > 0.001) {
                            result = fValue / gValue;
                        } else {
                            result = 1;
                        }
                        opType = "é™¤æ³•é—ä¼ ";
                        continuousPoint = "xâ‰ 0";
                        break;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('continuousOpType').textContent = opType;
                document.getElementById('fValueContinuous').textContent = fValue.toFixed(3);
                document.getElementById('gValueContinuous').textContent = gValue.toFixed(3);
                document.getElementById('resultValueContinuous').textContent = result.toFixed(3);
                document.getElementById('continuousPoint').textContent = continuousPoint;
                
                // ç»˜åˆ¶å›¾å½¢
                drawContinuousOperationsGraph(xValue, fValue, gValue, result);
            } catch (error) {
                console.error('æ›´æ–°è¿ç»­è¿ç®—å›¾å½¢æ—¶å‡ºé”™:', error);
            }
        }
        
        function drawContinuousOperationsGraph(xValue, fValue, gValue, result) {
            if (!continuousOperationsCtx) return;
            
            const canvas = document.getElementById('continuousOperationsCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            const xMin = -3;
            const xMax = 3;
            const yMin = -2;
            const yMax = 2;
            
            const coords = drawCoordinateSystem(continuousOperationsCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶ä¸‰æ¡å‡½æ•°æ›²çº¿
            const functions = [
                {color: '#5d6afb', value: fValue, name: 'f(x)'},
                {color: '#20c997', value: gValue, name: 'g(x)'},
                {color: '#ff6b9d', value: result, name: 'f op g'}
            ];
            
            functions.forEach(func => {
                continuousOperationsCtx.strokeStyle = func.color;
                continuousOperationsCtx.lineWidth = 2;
                continuousOperationsCtx.beginPath();
                
                const step = (xMax - xMin) / 100;
                
                for (let x = xMin; x <= xMax; x += step) {
                    let y;
                    
                    switch(continuousOpType) {
                        case 1:
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = Math.cos(x);
                            else y = Math.sin(x) + Math.cos(x);
                            break;
                        case 2:
                            if (func.name === 'f(x)') y = x;
                            else if (func.name === 'g(x)') y = Math.exp(x);
                            else y = x * Math.exp(x);
                            break;
                        case 3:
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = x * x;
                            else y = Math.sin(x * x);
                            break;
                        case 4:
                            if (func.name === 'f(x)') y = Math.sin(x);
                            else if (func.name === 'g(x)') y = x;
                            else {
                                if (Math.abs(x) > 0.001) y = Math.sin(x) / x;
                                else y = 1;
                            }
                            break;
                    }
                    
                    if (!isNaN(y) && y >= yMin && y <= yMax) {
                        const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                        const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                        
                        if (x === xMin) {
                            continuousOperationsCtx.moveTo(pixelX, pixelY);
                        } else {
                            continuousOperationsCtx.lineTo(pixelX, pixelY);
                        }
                    }
                }
                continuousOperationsCtx.stroke();
            });
            
            // ç»˜åˆ¶å½“å‰ç‚¹
            const values = [fValue, gValue, result];
            const pixelX = coords.margin.left + ((xValue - xMin) / (xMax - xMin)) * coords.graphWidth;
            
            functions.forEach((func, index) => {
                const y = values[index];
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    continuousOperationsCtx.fillStyle = func.color;
                    continuousOperationsCtx.beginPath();
                    continuousOperationsCtx.arc(pixelX, pixelY, 6, 0, Math.PI * 2);
                    continuousOperationsCtx.fill();
                }
            });
        }
        
        function changeContinuousOperation(type) {
            continuousOpType = type;
            stopAnimation('continuousOperations');
            updateContinuousOperationsGraph();
            
            const operationNames = ["åŠ æ³•é—ä¼ ", "ä¹˜æ³•é—ä¼ ", "å¤åˆé—ä¼ ", "é™¤æ³•é—ä¼ "];
            showFunnyTip(`åˆ‡æ¢åˆ°${operationNames[type-1]}ï¼ğŸ§¬`);
        }
        
        // ==================== é—­åŒºé—´æ€§è´¨å¯è§†åŒ– ====================
         function updateClosedIntervalGraph() {
    try {
        const aSlider = document.getElementById('intervalASlider');
        const bSlider = document.getElementById('intervalBSlider');
        
        if (!aSlider || !bSlider) return;
        
        // å°†æ»‘å—å€¼æ˜ å°„åˆ°å®é™…åŒºé—´å€¼
        let a, b;
        const aRatio = parseFloat(aSlider.value) / 100;
        const bRatio = parseFloat(bSlider.value) / 100;
        
        switch(closedIntervalType) {
            case 1: // sin(x)
                a = aRatio * 2 * Math.PI;
                b = bRatio * 2 * Math.PI;
                if (a > b) [a, b] = [b, a];
                break;
            case 2: // xÂ²-2x+1
                a = -2 + aRatio * 6;
                b = -2 + bRatio * 6;
                if (a > b) [a, b] = [b, a];
                break;
            case 3: // xÂ³-3x
                a = -2 + aRatio * 4;
                b = -2 + bRatio * 4;
                if (a > b) [a, b] = [b, a];
                break;
        }
        
        // æ›´æ–°æ˜¾ç¤ºå€¼
        document.getElementById('intervalASliderValue').textContent = a.toFixed(2);
        document.getElementById('intervalBSliderValue').textContent = b.toFixed(2);
        
        // è®¡ç®—å‡½æ•°å€¼
        const calculateY = (x) => {
            switch(closedIntervalType) {
                case 1: return Math.sin(x);
                case 2: return x * x - 2 * x + 1;
                case 3: return x * x * x - 3 * x;
                default: return 0;
            }
        };
        
        // è®¡ç®—å¯¼æ•°ï¼ˆç”¨äºç²¾ç¡®æ‰¾æå€¼ç‚¹ï¼‰
        const calculateDerivative = (x) => {
            switch(closedIntervalType) {
                case 1: return Math.cos(x);
                case 2: return 2 * x - 2;
                case 3: return 3 * x * x - 3;
                default: return 0;
            }
        };
        
        // 1. ç²¾ç¡®è®¡ç®—é›¶ç‚¹ï¼ˆä½¿ç”¨ç¬¦å·å˜åŒ–æ£€æµ‹ + äºŒåˆ†æ³•ï¼‰
        let zeroPoints = [];
        
        // é‡‡æ ·æŸ¥æ‰¾ç¬¦å·å˜åŒ–åŒºé—´
        const nSamples = 1000;
        const step = (b - a) / nSamples;
        let prevX = a;
        let prevY = calculateY(a);
        
        for (let i = 1; i <= nSamples; i++) {
            const currentX = a + i * step;
            const currentY = calculateY(currentX);
            
            // æ£€æµ‹ç¬¦å·å˜åŒ–
            if (prevY * currentY <= 0 && Math.abs(prevY) + Math.abs(currentY) > 1e-10) {
                // ä½¿ç”¨äºŒåˆ†æ³•ç²¾ç¡®æ±‚æ ¹
                let left = prevX, right = currentX;
                let mid, midY;
                
                for (let iter = 0; iter < 20; iter++) { // äºŒåˆ†20æ¬¡è¶³å¤Ÿç²¾ç¡®
                    mid = (left + right) / 2;
                    midY = calculateY(mid);
                    
                    if (Math.abs(midY) < 1e-8) break;
                    
                    if (calculateY(left) * midY <= 0) {
                        right = mid;
                    } else {
                        left = mid;
                    }
                }
                
                const zero = mid;
                const roundedZero = Math.round(zero * 100) / 100;
                
                // é¿å…é‡å¤ï¼ˆè€ƒè™‘æµ®ç‚¹æ•°ç²¾åº¦ï¼‰
                const isDuplicate = zeroPoints.some(z => Math.abs(z - roundedZero) < 0.01);
                if (!isDuplicate) {
                    zeroPoints.push(roundedZero);
                }
            }
            
            prevX = currentX;
            prevY = currentY;
        }
        
        // æ£€æŸ¥åŒºé—´ç«¯ç‚¹
        if (Math.abs(calculateY(a)) < 1e-8) {
            const roundedA = Math.round(a * 100) / 100;
            if (!zeroPoints.some(z => Math.abs(z - roundedA) < 0.01)) {
                zeroPoints.push(roundedA);
            }
        }
        
        if (Math.abs(calculateY(b)) < 1e-8) {
            const roundedB = Math.round(b * 100) / 100;
            if (!zeroPoints.some(z => Math.abs(z - roundedB) < 0.01)) {
                zeroPoints.push(roundedB);
            }
        }
        
        // æ’åºå¹¶é™åˆ¶æ•°é‡
        zeroPoints.sort((x, y) => x - y);
        zeroPoints = zeroPoints.slice(0, 5); // æœ€å¤šæ˜¾ç¤º5ä¸ªé›¶ç‚¹
        
        // 2. ç²¾ç¡®è®¡ç®—æœ€å€¼ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œé¿å…å¤æ‚å¯¼æ•°è®¡ç®—ï¼‰
        let minValue = Infinity, maxValue = -Infinity;
        
        // ç®€åŒ–æ–¹æ³•ï¼šå¯†é›†é‡‡æ · + ç‰¹æ®Šç‚¹æ£€æŸ¥
        const samplePoints = [];
        
        // æ·»åŠ åŒºé—´ç«¯ç‚¹
        samplePoints.push(a);
        samplePoints.push(b);
        
        // æ·»åŠ å…³é”®é©»ç‚¹ï¼ˆæ ¹æ®å‡½æ•°ç±»å‹ï¼‰
        switch(closedIntervalType) {
            case 1: // sin(x)
                // sin(x)çš„é©»ç‚¹åœ¨ (k+0.5)Ï€ å¤„
                let k = Math.floor(a / Math.PI - 0.5);
                while ((k + 0.5) * Math.PI <= b) {
                    const extremum = (k + 0.5) * Math.PI;
                    if (extremum >= a && extremum <= b) {
                        samplePoints.push(extremum);
                    }
                    k++;
                }
                break;
                
            case 2: // xÂ²-2x+1
                // å¯¼æ•° 2x-2=0ï¼Œé©»ç‚¹åœ¨ x=1
                if (1 >= a && 1 <= b) {
                    samplePoints.push(1);
                }
                break;
                
            case 3: // xÂ³-3x
                // å¯¼æ•° 3xÂ²-3=0ï¼Œé©»ç‚¹åœ¨ x=Â±1
                if (1 >= a && 1 <= b) samplePoints.push(1);
                if (-1 >= a && -1 <= b) samplePoints.push(-1);
                break;
        }
        
        // å¯†é›†é‡‡æ ·ï¼ˆç¡®ä¿ä¸æ¼æ‰æå€¼ï¼‰
        const denseSamples = 200;
        for (let i = 0; i <= denseSamples; i++) {
            const x = a + i * (b - a) / denseSamples;
            samplePoints.push(x);
        }
        
        // è®¡ç®—æ‰€æœ‰é‡‡æ ·ç‚¹çš„å‡½æ•°å€¼
        samplePoints.forEach(x => {
            const y = calculateY(x);
            if (y < minValue) minValue = y;
            if (y > maxValue) maxValue = y;
        });
        
        // é’ˆå¯¹sin(x)çš„ç‰¹æ®Šå¤„ç†ï¼šç¡®ä¿æå€¼ä¸è¶…è¿‡Â±1
        if (closedIntervalType === 1) {
            // æ£€æŸ¥åŒºé—´æ˜¯å¦åŒ…å«sinçš„æå€¼ç‚¹
            const hasMinusOne = false; // éœ€è¦åœ¨é‡‡æ ·ä¸­æ£€æŸ¥
            const hasPlusOne = false;
            
            // æ£€æŸ¥é‡‡æ ·ç‚¹ä¸­æ˜¯å¦æœ‰æ¥è¿‘Â±1çš„å€¼
            const tolerance = 0.01;
            samplePoints.forEach(x => {
                const y = calculateY(x);
                if (Math.abs(y + 1) < tolerance) minValue = Math.min(minValue, -1);
                if (Math.abs(y - 1) < tolerance) maxValue = Math.max(maxValue, 1);
            });
        }
        
        // å¤„ç†ç‰¹æ®Šæƒ…å†µï¼šåŒºé—´é•¿åº¦éå¸¸å°
        if (b - a < 1e-6) {
            minValue = calculateY((a + b) / 2);
            maxValue = minValue;
        }
        
        // ç¡®ä¿minValueå’ŒmaxValueä¸æ˜¯Infinity
        if (!isFinite(minValue) || !isFinite(maxValue)) {
            // å›é€€åˆ°ç®€å•è®¡ç®—
            minValue = Math.min(calculateY(a), calculateY(b));
            maxValue = Math.max(calculateY(a), calculateY(b));
        }
        
        // æ ¼å¼åŒ–æ˜¾ç¤º
        let intervalStr = `[${a.toFixed(2)}, ${b.toFixed(2)}]`;
        let zeroDisplay = zeroPoints.length > 0 ? 
            zeroPoints.map(z => typeof z === 'number' ? z.toFixed(2) : z).join(", ") : 
            "æ— ";
        
        // å¦‚æœé›¶ç‚¹å¤ªå¤šï¼Œåªæ˜¾ç¤ºå‰3ä¸ª
        if (zeroPoints.length > 3) {
            zeroDisplay = zeroPoints.slice(0, 3).map(z => z.toFixed(2)).join(", ") + ", ...";
        }
        
        // æ›´æ–°æ˜¾ç¤º
        document.getElementById('intervalValue').textContent = intervalStr;
        document.getElementById('minValue').textContent = minValue.toFixed(2);
        document.getElementById('maxValue').textContent = maxValue.toFixed(2);
        document.getElementById('zeroPoints').textContent = zeroDisplay;
        
        // ç»˜åˆ¶å›¾å½¢
        drawClosedIntervalGraph(a, b);
        
    } catch (error) {
        console.error('æ›´æ–°é—­åŒºé—´æ€§è´¨å›¾å½¢æ—¶å‡ºé”™:', error);
    }
}
        
        function drawClosedIntervalGraph(a, b) {
            if (!closedIntervalCtx) return;
            
            const canvas = document.getElementById('closedIntervalCanvas');
            const width = canvas.width;
            const height = canvas.height;
            
            // è®¾ç½®åæ ‡èŒƒå›´
            let xMin, xMax, yMin, yMax;
            
            switch(closedIntervalType) {
                case 1:
                    xMin = -1;
                    xMax = 2 * Math.PI + 1;
                    yMin = -1.5;
                    yMax = 1.5;
                    break;
                case 2:
                    xMin = -3;
                    xMax = 5;
                    yMin = -2;
                    yMax = 10;
                    break;
                case 3:
                    xMin = -3;
                    xMax = 3;
                    yMin = -3;
                    yMax = 3;
                    break;
            }
            
            const coords = drawCoordinateSystem(closedIntervalCtx, width, height, xMin, xMax, yMin, yMax);
            
            // ç»˜åˆ¶å‡½æ•°æ›²çº¿
            closedIntervalCtx.strokeStyle = '#5d6afb';
            closedIntervalCtx.lineWidth = 3;
            closedIntervalCtx.beginPath();
            
            const step = (xMax - xMin) / 200;
            
            for (let x = xMin; x <= xMax; x += step) {
                let y;
                
                switch(closedIntervalType) {
                    case 1: y = Math.sin(x); break;
                    case 2: y = x * x - 2 * x + 1; break;
                    case 3: y = x * x * x - 3 * x; break;
                }
                
                if (!isNaN(y) && y >= yMin && y <= yMax) {
                    const pixelX = coords.margin.left + ((x - xMin) / (xMax - xMin)) * coords.graphWidth;
                    const pixelY = height - coords.margin.bottom - ((y - yMin) / (yMax - yMin)) * coords.graphHeight;
                    
                    if (x === xMin) {
                        closedIntervalCtx.moveTo(pixelX, pixelY);
                    } else {
                        closedIntervalCtx.lineTo(pixelX, pixelY);
                    }
                }
            }
            closedIntervalCtx.stroke();
            
            // ç»˜åˆ¶åŒºé—´[a,b]
            const pixelA = coords.margin.left + ((a - xMin) / (xMax - xMin)) * coords.graphWidth;
            const pixelB = coords.margin.left + ((b - xMin) / (xMax - xMin)) * coords.graphWidth;
            
            // ç»˜åˆ¶åŒºé—´èƒŒæ™¯
            closedIntervalCtx.fillStyle = 'rgba(93, 106, 251, 0.1)';
            closedIntervalCtx.fillRect(pixelA, coords.margin.top, pixelB - pixelA, coords.graphHeight);
            
            // ç»˜åˆ¶åŒºé—´è¾¹ç•Œçº¿
            closedIntervalCtx.strokeStyle = '#ff6b9d';
            closedIntervalCtx.lineWidth = 3;
            closedIntervalCtx.setLineDash([5, 5]);
            closedIntervalCtx.beginPath();
            closedIntervalCtx.moveTo(pixelA, coords.margin.top);
            closedIntervalCtx.lineTo(pixelA, height - coords.margin.bottom);
            closedIntervalCtx.moveTo(pixelB, coords.margin.top);
            closedIntervalCtx.lineTo(pixelB, height - coords.margin.bottom);
            closedIntervalCtx.stroke();
            closedIntervalCtx.setLineDash([]);
            
            // æ·»åŠ åŒºé—´æ ‡ç­¾
            closedIntervalCtx.fillStyle = '#ff6b9d';
            closedIntervalCtx.font = 'bold 14px Arial';
            closedIntervalCtx.fillText('a', pixelA - 15, height - 30);
            closedIntervalCtx.fillText('b', pixelB - 15, height - 30);
        }
        
        function changeClosedIntervalFunction(type) {
            closedIntervalType = type;
            stopAnimation('closedInterval');
            updateClosedIntervalGraph();
            
            const functionNames = ["sin x", "xÂ²-2x+1", "xÂ³-3x"];
            showFunnyTip(`åˆ‡æ¢åˆ°ç¾Šç¾¤: f(x)=${functionNames[type-1]} ğŸ‘`);
        }
        
        // ==================== ç»ƒä¹ ç³»ç»Ÿ ====================
        function initExercises() {
            exercises = [
                {
                    id: 1,
                    question: "å‡½æ•° f(x)=1/(x-3) çš„'èº«ä»½è¯'ï¼ˆå®šä¹‰åŸŸï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ",
                    options: [
                        "(-âˆ, 3) âˆª (3, âˆ)",
                        "(-âˆ, âˆ)",
                        "[3, âˆ)",
                        "(-âˆ, 3]"
                    ],
                    answer: 0,
                    explanation: "ğŸ‘®â€â™‚ï¸ èº«ä»½æ ¸éªŒï¼šåˆ†æ¯ä¸èƒ½ä¸º0ï¼Œæ‰€ä»¥x-3â‰ 0ï¼Œå³xâ‰ 3ã€‚å› æ­¤å®šä¹‰åŸŸä¸º(-âˆ, 3) âˆª (3, âˆ)ã€‚å°±åƒå¾®ä¿¡ç¾¤ï¼Œx=3çš„äººä¸èƒ½è¿›ï¼"
                },
                {
                    id: 2,
                    question: "æ•°åˆ— aâ‚™ = 1/n çš„'å¿ƒä¸Šäºº'ï¼ˆæé™ï¼‰æ˜¯å¤šå°‘ï¼Ÿ",
                    options: ["0", "1", "âˆ", "ä¸å­˜åœ¨"],
                    answer: 0,
                    explanation: "ğŸ’– æ‹çˆ±åˆ†æï¼šå½“nâ†’âˆæ—¶ï¼Œ1/næ— é™æ¥è¿‘0ï¼Œæ‰€ä»¥æé™æ˜¯0ã€‚å°±åƒè¿½æ˜Ÿï¼Œæ—¶é—´è¶Šä¹…è·ç¦»è¶Šè¿‘ï¼Œä½†å¯èƒ½æ°¸è¿œè¿½ä¸ä¸Šï¼"
                },
                {
                    id: 3,
                    question: "æé™ lim(xâ†’0) sin(x)/x çš„é¶å¿ƒå€¼æ˜¯å¤šå°‘ï¼Ÿ",
                    options: ["0", "1", "âˆ", "ä¸å­˜åœ¨"],
                    answer: 1,
                    explanation: "ğŸ¯ å°„å‡»æˆç»©ï¼šè¿™æ˜¯ç¬¬ä¸€ä¸ªé‡è¦æé™ï¼Œå½“xâ†’0æ—¶ï¼Œsin(x)/xâ†’1ã€‚é«˜æ•°ç•Œæœ€æœ‰åçš„'ç¥å°„æ‰‹'ï¼"
                },
                {
                    id: 4,
                    question: "å¤¹é€¼å‡†åˆ™åˆè¢«æˆç§°ä¸ºä»€ä¹ˆå®šç†ï¼Ÿ",
                    options: ["ä¸‰æ˜æ²»å®šç†", "å‹¾è‚¡å®šç†", "ä¸­å€¼å®šç†", "ç½—å°”å®šç†"],
                    answer: 0,
                    explanation: "ğŸ¥ª ç¾é£Ÿé‰´å®šï¼šå› ä¸ºå‡½æ•°è¢«ä¸¤ä¸ªå‡½æ•°åƒä¸‰æ˜æ²»ä¸€æ ·å¤¹åœ¨ä¸­é—´ï¼Œæ‰€ä»¥åˆå«ä¸‰æ˜æ²»å®šç†ã€‚ä¸­é—´çš„è‚‰é¥¼f(x)åªèƒ½è·Ÿç€é¢åŒ…ç‰‡èµ°ï¼"
                },
                {
                    id: 5,
                    question: "è‹¥lim f(x)=2, lim g(x)=3ï¼Œåˆ™lim[f(x)+g(x)]ç­‰äºå¤šå°‘ï¼Ÿ",
                    options: ["5", "-1", "6", "2/3"],
                    answer: 0,
                    explanation: "ğŸ§® ç®—æœ¯è€ƒæ ¸ï¼šæé™çš„åŠ æ³•æ³•åˆ™ï¼šlim[f(x)+g(x)] = lim f(x) + lim g(x) = 2 + 3 = 5ã€‚å°±åƒé“¶è¡Œè½¬è´¦ï¼ŒAæœ‰2å…ƒï¼ŒBæœ‰3å…ƒï¼Œä¸€èµ·å°±æ˜¯5å…ƒï¼"
                },
                {
                    id: 6,
                    question: "lim(xâ†’âˆ) (1+1/x)^x ç­‰äºå“ªä½æ•°å­¦æ˜æ˜Ÿï¼Ÿ",
                    options: ["0", "1", "e", "âˆ"],
                    answer: 2,
                    explanation: "â­ æ˜æ˜Ÿåº”æ´ï¼šè¿™æ˜¯ç¬¬äºŒä¸ªé‡è¦æé™ï¼Œç»“æœæ˜¯è‡ªç„¶å¸¸æ•°eâ‰ˆ2.71828ã€‚å°±åƒå¤åˆ©è®¡ç®—çš„æé™ï¼Œåˆ©æ»šåˆ©çš„ç»ˆæå½¢æ€ï¼"
                },
                {
                    id: 7,
                    question: "å½“xâ†’0æ—¶ï¼ŒxÂ²æ˜¯xçš„ä»€ä¹ˆæ— ç©·å°ï¼Ÿ",
                    options: ["é«˜é˜¶æ— ç©·å°", "ä½é˜¶æ— ç©·å°", "åŒé˜¶æ— ç©·å°", "ç­‰ä»·æ— ç©·å°"],
                    answer: 0,
                    explanation: "ğŸƒâ€â™‚ï¸ èµ›è·‘è£åˆ¤ï¼šå› ä¸ºlim(xâ†’0) xÂ²/x = lim(xâ†’0) x = 0ï¼Œæ‰€ä»¥xÂ²æ˜¯xçš„é«˜é˜¶æ— ç©·å°ã€‚xÂ²æ¯”xæ›´å¿«å†²å‘0ç»ˆç‚¹ï¼"
                },
                {
                    id: 8,
                    question: "å‡½æ•° f(x)=1/x åœ¨ x=0 å¤„çš„æ–­ç‚¹ç±»å‹æ˜¯ï¼Ÿ",
                    options: ["å¯å»é—´æ–­ç‚¹", "è·³è·ƒé—´æ–­ç‚¹", "ç¬¬äºŒç±»é—´æ–­ç‚¹", "è¿ç»­ç‚¹"],
                    answer: 2,
                    explanation: "ğŸ”— ç”»çº¿æ£€æŸ¥ï¼šåœ¨x=0å¤„å‡½æ•°æ— å®šä¹‰ä¸”å·¦å³æé™éƒ½ä¸å­˜åœ¨ï¼Œæ˜¯ç¬¬äºŒç±»é—´æ–­ç‚¹ã€‚å°±åƒç”»çº¿æ—¶çªç„¶æ”¾é£è‡ªæˆ‘ï¼"
                },
                {
                    id: 9,
                    question: "ä¸¤ä¸ªè¿ç»­å‡½æ•°çš„å’Œå‡½æ•°æ˜¯ï¼Ÿ",
                    options: ["è¿ç»­å‡½æ•°", "ä¸è¿ç»­å‡½æ•°", "ä¸ä¸€å®šè¿ç»­", "æ— æ³•ç¡®å®š"],
                    answer: 0,
                    explanation: "ğŸ§¬ é—ä¼ æ£€æµ‹ï¼šè¿ç»­å‡½æ•°çš„å’Œã€å·®ã€ç§¯ã€å•†ï¼ˆåˆ†æ¯ä¸ä¸º0ï¼‰ä»æ˜¯è¿ç»­å‡½æ•°ã€‚è¿ç»­å®¶æ—æœ‰é—ä¼ æ€§ï¼"
                },
                {
                    id: 10,
                    question: "ä¸‹åˆ—å“ªä¸ªå‡½æ•°åœ¨é—­åŒºé—´[0,1]ä¸Šæ»¡è¶³é›¶ç‚¹å®šç†çš„æ¡ä»¶ï¼Ÿ",
                    options: ["f(x)=xÂ²-0.5", "f(x)=1/x", "f(x)=|x|", "f(x)=xÂ²+1"],
                    answer: 0,
                    explanation: "ğŸ‘ æ”¾ç¾Šè§‚å¯Ÿï¼šf(0)=-0.5<0, f(1)=0.5>0ï¼Œå¼‚å·ä¸”åœ¨é—­åŒºé—´è¿ç»­ï¼Œæ»¡è¶³é›¶ç‚¹å®šç†æ¡ä»¶ã€‚å°±åƒå›´æ ä¸¤å¤´ä¸€é»‘ä¸€ç™½ç¾Šï¼Œä¸­é—´å¿…æœ‰ç°ç¾Šï¼"
                }
            ];
            
            // åˆå§‹åŒ–ç»ƒä¹ çŠ¶æ€
            exercises.forEach(exercise => {
                exerciseAnswers[exercise.id] = null;
                exerciseSelected[exercise.id] = null;
            });
            
            // æ¸²æŸ“æ‰€æœ‰ç»ƒä¹ é¢˜
            exercises.forEach(exercise => {
                renderExercise(exercise);
            });
            
            updateExerciseStats();
        }
        
        function renderExercise(exercise) {
            const container = document.getElementById(`exercise${exercise.id}`);
            if (!container) return;
            
            const optionsContainer = container.querySelector('.exercise-options');
            if (!optionsContainer) return;
            
            optionsContainer.innerHTML = '';
            
            exercise.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'exercise-option';
                if (exerciseSelected[exercise.id] === index) {
                    optionDiv.classList.add('selected');
                }
                optionDiv.onclick = () => selectExerciseOption(exercise.id, index);
                
                const letterDiv = document.createElement('div');
                letterDiv.className = 'option-letter';
                letterDiv.textContent = String.fromCharCode(65 + index);
                
                const textDiv = document.createElement('div');
                textDiv.textContent = option;
                
                optionDiv.appendChild(letterDiv);
                optionDiv.appendChild(textDiv);
                optionsContainer.appendChild(optionDiv);
            });
        }
        
        function selectExerciseOption(exerciseId, optionIndex) {
            exerciseSelected[exerciseId] = optionIndex;
            
            // æ›´æ–°UI
            const container = document.getElementById(`exercise${exerciseId}`);
            if (container) {
                const options = container.querySelectorAll('.exercise-option');
                options.forEach((option, index) => {
                    option.classList.remove('selected');
                    if (index === optionIndex) {
                        option.classList.add('selected');
                    }
                });
            }
        }
        
        function checkExerciseAnswer(exerciseId) {
            const exercise = exercises.find(e => e.id === exerciseId);
            if (!exercise) return;
            
            const selected = exerciseSelected[exerciseId];
            if (selected === null) {
                showFunnyTip("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼ğŸ¤”");
                return;
            }
            
            const isCorrect = (selected === exercise.answer);
            exerciseAnswers[exerciseId] = isCorrect;
            
            // æ›´æ–°UI
            const container = document.getElementById(`exercise${exerciseId}`);
            if (container) {
                const options = container.querySelectorAll('.exercise-option');
                options.forEach((option, index) => {
                    option.classList.remove('correct', 'incorrect');
                    if (index === exercise.answer) {
                        option.classList.add('correct');
                    } else if (index === selected && !isCorrect) {
                        option.classList.add('incorrect');
                    }
                });
                
                // æ˜¾ç¤ºåé¦ˆ
                const feedback = container.querySelector('.exercise-feedback');
                if (feedback) {
                    feedback.style.display = 'block';
                    feedback.innerHTML = isCorrect ? 
                        `<div class="feedback-correct">ğŸ‰ é€šå…³æˆåŠŸï¼</div><div style="margin-top:10px;">${exercise.explanation}</div>` :
                        `<div class="feedback-incorrect">ğŸ˜… é€šå…³å¤±è´¥ï¼</div><div style="margin-top:10px;">æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${String.fromCharCode(65 + exercise.answer)}. ${exercise.options[exercise.answer]}</div><div style="margin-top:10px;">${exercise.explanation}</div>`;
                }
            }
            
            // æ›´æ–°ç»Ÿè®¡
            updateExerciseStats();
            
            // æ˜¾ç¤ºç»“æœæç¤º
            if (isCorrect) {
                const funnyMessages = [
                    "å¤ªæ£’äº†ï¼ä½ çœŸæ˜¯æ•°å­¦å°å¤©æ‰ï¼ğŸŒŸ",
                    "å®Œç¾ï¼ç»§ç»­åŠ æ²¹ï¼ğŸ’ª",
                    "é€šå…³æˆåŠŸï¼é«˜æ•°å¯¹ä½ æ¥è¯´å°èœä¸€ç¢Ÿï¼ğŸ¯",
                    "ä¼˜ç§€ï¼ä½ çš„æ•°å­¦ç›´è§‰å¾ˆæ£’ï¼ğŸ§ "
                ];
                showFunnyTip(funnyMessages[Math.floor(Math.random() * funnyMessages.length)]);
            } else {
                const encouragingMessages = [
                    "å·®ä¸€ç‚¹ï¼å†æƒ³æƒ³ï¼ğŸ’¡",
                    "æ²¡å…³ç³»ï¼Œé”™è¯¯æ˜¯å­¦ä¹ çš„å¥½æœºä¼šï¼ğŸ“š",
                    "å†è¯•ä¸€æ¬¡ï¼Œä½ å¯ä»¥çš„ï¼ğŸ¤“",
                    "çœ‹çœ‹è§£æï¼Œä¸‹æ¬¡ä¸€å®šèƒ½é€šå…³ï¼ğŸ’ª"
                ];
                showFunnyTip(encouragingMessages[Math.floor(Math.random() * encouragingMessages.length)]);
            }
        }
        
        function showExerciseSolution(exerciseId) {
            const exercise = exercises.find(e => e.id === exerciseId);
            if (!exercise) return;
            
            const container = document.getElementById(`exercise${exerciseId}`);
            if (container) {
                const feedback = container.querySelector('.exercise-feedback');
                if (feedback) {
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <div style="color: var(--info); font-weight: bold; margin-bottom: 10px;">ğŸ“š é€šå…³ç§˜ç±ï¼š</div>
                        <div style="margin-bottom: 10px;">${exercise.explanation}</div>
                        <div style="color: var(--success); font-weight: bold;">æ­£ç¡®ç­”æ¡ˆï¼š${String.fromCharCode(65 + exercise.answer)}. ${exercise.options[exercise.answer]}</div>
                    `;
                }
            }
            
            showFunnyTip("ğŸ“– å­¦ä¹ ç§˜ç±ä¹Ÿæ˜¯é€šå…³çš„é‡è¦ä¸€æ­¥ï¼");
        }
        
        function updateExerciseStats() {
            const attempted = Object.values(exerciseAnswers).filter(v => v !== null).length;
            const correct = Object.values(exerciseAnswers).filter(v => v === true).length;
            
            exerciseStats.attempted = attempted;
            exerciseStats.correct = correct;
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('totalExercises').textContent = exercises.length;
            document.getElementById('correctExercises').textContent = correct;
            document.getElementById('accuracy').textContent = attempted > 0 ? Math.round((correct / attempted) * 100) + '%' : '0%';
        }
        
        function resetAllExercises() {
            if (confirm("ç¡®å®šè¦é‡ç½®æ‰€æœ‰æŒ‘æˆ˜å—ï¼Ÿå½“å‰é€šå…³è®°å½•å°†è¢«æ¸…é™¤ã€‚")) {
                exercises.forEach(exercise => {
                    exerciseAnswers[exercise.id] = null;
                    exerciseSelected[exercise.id] = null;
                    renderExercise(exercise);
                    
                    const container = document.getElementById(`exercise${exercise.id}`);
                    if (container) {
                        const feedback = container.querySelector('.exercise-feedback');
                        if (feedback) feedback.style.display = 'none';
                    }
                });
                
                updateExerciseStats();
                showFunnyTip("æ‰€æœ‰æŒ‘æˆ˜å·²é‡ç½®ï¼é‡æ–°æ¢é™©å§ï¼ğŸ”„");
            }
        }
        
        // ==================== ç³»ç»ŸåŠŸèƒ½å‡½æ•° ====================
        function scrollToSection(sectionId) {
            // åœæ­¢æ‰€æœ‰åŠ¨ç”»
            Object.keys(animationIntervals).forEach(key => {
                stopAnimation(key);
                updateAnimationButton(key, false);
            });
            
            const element = document.getElementById(sectionId);
            if (element) {
                // æ·»åŠ åˆ°å·²å­¦ä¹ ç« èŠ‚
                if (!learnedSections.has(sectionId)) {
                    learnedSections.add(sectionId);
                    updateProgress();
                    
                    const sectionNames = {
                        'mapping-function': 'ç§˜å¢ƒä¸€ï¼šæ˜ å°„ä¸å‡½æ•°',
                        'sequence-limit': 'ç§˜å¢ƒäºŒï¼šæ•°åˆ—æé™',
                        'function-limit': 'ç§˜å¢ƒä¸‰ï¼šå‡½æ•°æé™',
                        'limit-criteria': 'ç§˜å¢ƒå››ï¼šæé™å‡†åˆ™',
                        'limit-operations': 'ç§˜å¢ƒäº”ï¼šæé™è¿ç®—',
                        'important-limits': 'ç§˜å¢ƒå…­ï¼šé‡è¦æé™',
                        'infinitesimal-comparison': 'ç§˜å¢ƒä¸ƒï¼šæ— ç©·å°æ¯”è¾ƒ',
                        'continuity': 'ç§˜å¢ƒå…«ï¼šè¿ç»­æ€§',
                        'continuous-operations': 'ç§˜å¢ƒä¹ï¼šè¿ç»­è¿ç®—',
                        'closed-interval': 'ç§˜å¢ƒåï¼šé—­åŒºé—´æ€§è´¨'
                    };
                    
                    showFunnyTip(`ğŸ‰ è§£é”æ–°ç§˜å¢ƒï¼š${sectionNames[sectionId]}ï¼`);
                }
                
                // å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
                const offset = 100;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - offset;
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        }
        
        function updateProgress() {
            const progress = (learnedSections.size / totalSections) * 100;
            const progressFill = document.getElementById('progressFill');
            const progressPercent = document.getElementById('progressPercent');
            
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
            
            if (progressPercent) {
                progressPercent.textContent = `${Math.round(progress)}% (${learnedSections.size}/${totalSections}ä¸ªç§˜å¢ƒ)`;
            }
            
            // ä¿å­˜è¿›åº¦åˆ°æœ¬åœ°å­˜å‚¨
            saveStudyRecords();
        }
        
        function resetProgress() {
            if (confirm("ç¡®å®šè¦é‡ç½®æ¢ç´¢è¿›åº¦å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰å·²æ¢ç´¢çš„ç§˜å¢ƒè®°å½•ã€‚")) {
                learnedSections.clear();
                learnedSections.add('mapping-function');
                updateProgress();
                showFunnyTip("æ¢ç´¢è¿›åº¦å·²é‡ç½®ï¼é‡æ–°å¼€å§‹å¥‡å¦™æ•°å­¦ä¹‹æ—…å§ï¼ğŸ”„");
            }
        }
        
        // ==================== å­¦ä¹ è®¡æ—¶å™¨ ====================
        function startTimer() {
            if (timerInterval) return;
            
            timerInterval = setInterval(() => {
                studyTimer++;
                todayStudyTime++;
                totalStudyTime++;
                updateTimerDisplay();
                saveStudyRecords();
            }, 1000);
            
            showFunnyTip("â±ï¸ æ¢é™©è®¡æ—¶å¼€å§‹ï¼åŠ æ²¹ï¼ğŸ’ª");
        }
        
        function pauseTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                showFunnyTip("â¸ï¸ è®¡æ—¶å·²æš‚åœï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼â˜•");
            }
        }
        
        function resetTimer() {
            if (confirm("ç¡®å®šè¦é‡ç½®è®¡æ—¶å™¨å—ï¼Ÿå½“å‰è®¡æ—¶å°†è¢«æ¸…é›¶ã€‚")) {
                pauseTimer();
                studyTimer = 0;
                updateTimerDisplay();
                showFunnyTip("è®¡æ—¶å™¨å·²é‡ç½®ï¼ğŸ”„");
            }
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(studyTimer / 3600);
            const minutes = Math.floor((studyTimer % 3600) / 60);
            const seconds = studyTimer % 60;
            
            const timerDisplay = document.getElementById('studyTimer');
            if (timerDisplay) {
                timerDisplay.textContent = 
                    `${hours.toString().padStart(2, '0')}:` +
                    `${minutes.toString().padStart(2, '0')}:` +
                    `${seconds.toString().padStart(2, '0')}`;
            }
            
            // æ›´æ–°ä»Šæ—¥å­¦ä¹ æ—¶é—´
            const todayMinutes = Math.floor(todayStudyTime / 60);
            const totalHours = Math.floor(totalStudyTime / 3600);
            
            const todayElement = document.getElementById('todayStudyTime');
            const totalElement = document.getElementById('totalStudyTime');
            
            if (todayElement) todayElement.textContent = `${todayMinutes}åˆ†é’Ÿ`;
            if (totalElement) totalElement.textContent = `${totalHours}å°æ—¶`;
        }
        
        // ==================== å­¦ä¹ è®°å½•ç®¡ç† ====================
        function saveStudyRecords() {
            try {
                const records = {
                    learnedSections: Array.from(learnedSections),
                    studyTimer: studyTimer,
                    todayStudyTime: todayStudyTime,
                    totalStudyTime: totalStudyTime,
                    exerciseStats: exerciseStats,
                    lastVisit: new Date().toISOString()
                };
                
                localStorage.setItem('calculusChapter1Records', JSON.stringify(records));
            } catch (error) {
                console.error('ä¿å­˜å­¦ä¹ è®°å½•å¤±è´¥:', error);
            }
        }
        
        function loadStudyRecords() {
            try {
                const saved = localStorage.getItem('calculusChapter1Records');
                if (saved) {
                    const records = JSON.parse(saved);
                    
                    if (records.learnedSections) {
                        learnedSections = new Set(records.learnedSections);
                    }
                    
                    studyTimer = records.studyTimer || 0;
                    todayStudyTime = records.todayStudyTime || 0;
                    totalStudyTime = records.totalStudyTime || 0;
                    
                    const lastVisit = records.lastVisit ? new Date(records.lastVisit) : null;
                    const today = new Date();
                    if (lastVisit && (lastVisit.getDate() !== today.getDate() || 
                        lastVisit.getMonth() !== today.getMonth() || 
                        lastVisit.getFullYear() !== today.getFullYear())) {
                        todayStudyTime = 0;
                    }
                    
                    if (records.exerciseStats) {
                        exerciseStats = records.exerciseStats;
                    }
                    
                    updateTimerDisplay();
                    updateProgress();
                    updateExerciseStats();
                    
                    console.log('ğŸ“š å­¦ä¹ è®°å½•æ¢å¤æˆåŠŸï¼');
                }
            } catch (error) {
                console.error('åŠ è½½å­¦ä¹ è®°å½•å¤±è´¥:', error);
            }
        }
        
        // ==================== æ¸¸æˆåŠŸèƒ½ ====================
        function initGameQuestions() {
            gameQuestions = [
                {
                    question: "æé™ lim(xâ†’0) sin(x)/x çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ",
                    options: ["0", "1", "âˆ", "ä¸å­˜åœ¨"],
                    answer: 1,
                    explanation: "è¿™æ˜¯ç¬¬ä¸€ä¸ªé‡è¦æé™ï¼Œå½“xâ†’0æ—¶ï¼Œsin(x)/xâ†’1ã€‚"
                },
                {
                    question: "ä¸‹åˆ—å“ªä¸ªæ˜¯æ— ç©·å°é‡ï¼Ÿ",
                    options: ["sin(x) (xâ†’0)", "xÂ² (xâ†’âˆ)", "1/x (xâ†’1)", "e^x (xâ†’0)"],
                    answer: 0,
                    explanation: "å½“xâ†’0æ—¶ï¼Œsin(x)â†’0ï¼Œæ˜¯æ— ç©·å°é‡ã€‚"
                },
                {
                    question: "å‡½æ•° f(x) = 1/x åœ¨ x=0 å¤„çš„é—´æ–­ç‚¹ç±»å‹æ˜¯ï¼Ÿ",
                    options: ["å¯å»é—´æ–­ç‚¹", "è·³è·ƒé—´æ–­ç‚¹", "ç¬¬äºŒç±»é—´æ–­ç‚¹", "è¿ç»­ç‚¹"],
                    answer: 2,
                    explanation: "åœ¨x=0å¤„å‡½æ•°æ— å®šä¹‰ä¸”å·¦å³æé™éƒ½ä¸å­˜åœ¨ï¼Œæ˜¯ç¬¬äºŒç±»é—´æ–­ç‚¹ã€‚"
                },
                {
                    question: "å¤¹é€¼å‡†åˆ™åˆç§°ä¸ºï¼Ÿ",
                    options: ["ä¸‰æ˜æ²»å®šç†", "å‹¾è‚¡å®šç†", "ä¸­å€¼å®šç†", "ç½—å°”å®šç†"],
                    answer: 0,
                    explanation: "å› ä¸ºå‡½æ•°è¢«ä¸¤ä¸ªå‡½æ•°åƒä¸‰æ˜æ²»ä¸€æ ·å¤¹åœ¨ä¸­é—´ï¼Œæ‰€ä»¥åˆå«ä¸‰æ˜æ²»å®šç†ã€‚"
                },
                {
                    question: "lim(xâ†’âˆ) (1+1/x)^x ç­‰äºï¼Ÿ",
                    options: ["0", "1", "e", "âˆ"],
                    answer: 2,
                    explanation: "è¿™æ˜¯ç¬¬äºŒä¸ªé‡è¦æé™ï¼Œç»“æœæ˜¯è‡ªç„¶å¸¸æ•°eâ‰ˆ2.71828ã€‚"
                },
                {
                    question: "ä¸‹åˆ—å“ªä¸ªå‡½æ•°åœ¨ x=0 å¤„è¿ç»­ï¼Ÿ",
                    options: ["f(x)=1/x", "f(x)=|x|", "f(x)=1/xÂ²", "f(x)=cot(x)"],
                    answer: 1,
                    explanation: "f(x)=|x|åœ¨x=0å¤„è¿ç»­ï¼Œå…¶ä»–å‡½æ•°åœ¨x=0å¤„éƒ½ä¸è¿ç»­ã€‚"
                },
                {
                    question: "è‹¥ lim f(x)=A, lim g(x)=Bï¼Œåˆ™ lim[f(x)+g(x)] ç­‰äºï¼Ÿ",
                    options: ["A+B", "A-B", "AÃ—B", "A/B"],
                    answer: 0,
                    explanation: "æé™çš„åŠ æ³•æ³•åˆ™ï¼šlim[f(x)+g(x)] = lim f(x) + lim g(x)ã€‚"
                },
                {
                    question: "é—­åŒºé—´ä¸Šè¿ç»­å‡½æ•°ä¸€å®šå…·æœ‰çš„æ€§è´¨æ˜¯ï¼Ÿ",
                    options: ["æœ‰ç•Œæ€§", "å•è°ƒæ€§", "å¯å¯¼æ€§", "å‘¨æœŸæ€§"],
                    answer: 0,
                    explanation: "æœ‰ç•Œæ€§å®šç†ï¼šé—­åŒºé—´ä¸Šçš„è¿ç»­å‡½æ•°ä¸€å®šæœ‰ç•Œã€‚"
                },
                {
                    question: "å½“ xâ†’0 æ—¶ï¼ŒxÂ² æ˜¯ x çš„ä»€ä¹ˆæ— ç©·å°ï¼Ÿ",
                    options: ["é«˜é˜¶æ— ç©·å°", "ä½é˜¶æ— ç©·å°", "åŒé˜¶æ— ç©·å°", "ç­‰ä»·æ— ç©·å°"],
                    answer: 0,
                    explanation: "å› ä¸ºlim(xâ†’0) xÂ²/x = lim(xâ†’0) x = 0ï¼Œæ‰€ä»¥xÂ²æ˜¯xçš„é«˜é˜¶æ— ç©·å°ã€‚"
                },
                {
                    question: "å‡½æ•° f(x) åœ¨ç‚¹ xâ‚€ è¿ç»­çš„å®šä¹‰æ˜¯ï¼Ÿ",
                    options: ["lim f(x) = f(xâ‚€) (xâ†’xâ‚€)", "f'(xâ‚€) å­˜åœ¨", "f(x) åœ¨ xâ‚€ æœ‰å®šä¹‰", "f(x) åœ¨ xâ‚€ å¯å¯¼"],
                    answer: 0,
                    explanation: "è¿ç»­çš„å®šä¹‰å°±æ˜¯æé™å€¼ç­‰äºå‡½æ•°å€¼ã€‚"
                }
            ];
        }
        
        function startGame() {
            gameActive = true;
            currentGameQuestion = 0;
            gameScore = 0;
            userGameAnswer = null;
            
            // æ˜¾ç¤ºæ¸¸æˆåˆ†æ•°é¢æ¿
            const gameScoreElement = document.getElementById('gameScore');
            if (gameScoreElement) {
                gameScoreElement.style.display = 'block';
            }
            
            // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
            updateGameScore();
            
            // æ˜¾ç¤ºç¬¬ä¸€ä¸ªé—®é¢˜
            showGameQuestion();
            
            // æ˜¾ç¤ºæ¸¸æˆæ¨¡æ€æ¡†
            const gameModal = document.getElementById('gameModal');
            if (gameModal) {
                gameModal.style.display = 'flex';
            }
            
            // æš‚åœå­¦ä¹ è®¡æ—¶å™¨
            pauseTimer();
            
            showFunnyTip("ğŸ® é«˜æ•°å¤§å†’é™©å¼€å§‹ï¼æŒ‘æˆ˜ä½ çš„æ•°å­¦çŸ¥è¯†ï¼");
        }
        
        function showGameQuestion() {
            if (currentGameQuestion >= gameQuestions.length) {
                endGame();
                return;
            }
            
            const question = gameQuestions[currentGameQuestion];
            const gameQuestionElement = document.getElementById('gameQuestion');
            const gameOptionsElement = document.getElementById('gameOptions');
            const gameQuestionNumber = document.getElementById('gameQuestionNumber');
            
            if (gameQuestionNumber) {
                gameQuestionNumber.textContent = currentGameQuestion + 1;
            }
            
            if (gameQuestionElement) {
                gameQuestionElement.textContent = question.question;
            }
            
            if (gameOptionsElement) {
                gameOptionsElement.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.style.cssText = `
                        padding: 15px;
                        margin-bottom: 10px;
                        background: white;
                        border: 2px solid #dee2e6;
                        border-radius: 10px;
                        cursor: pointer;
                        transition: all 0.3s;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    `;
                    optionDiv.onmouseover = () => {
                        optionDiv.style.transform = 'translateY(-2px)';
                        optionDiv.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
                        optionDiv.style.borderColor = 'var(--primary)';
                    };
                    optionDiv.onmouseout = () => {
                        optionDiv.style.transform = 'translateY(0)';
                        optionDiv.style.boxShadow = 'none';
                        if (userGameAnswer !== index) {
                            optionDiv.style.borderColor = '#dee2e6';
                        }
                    };
                    optionDiv.onclick = () => {
                        const allOptions = gameOptionsElement.querySelectorAll('div');
                        allOptions.forEach(opt => {
                            opt.style.background = 'white';
                            opt.style.borderColor = '#dee2e6';
                        });
                        
                        optionDiv.style.background = 'linear-gradient(135deg, var(--primary), var(--fun-purple))';
                        optionDiv.style.color = 'white';
                        optionDiv.style.borderColor = 'var(--primary)';
                        
                        userGameAnswer = index;
                    };
                    
                    const letterSpan = document.createElement('span');
                    letterSpan.style.cssText = `
                        width: 30px;
                        height: 30px;
                        background: var(--primary);
                        color: white;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: bold;
                    `;
                    letterSpan.textContent = String.fromCharCode(65 + index);
                    
                    const textSpan = document.createElement('span');
                    textSpan.textContent = option;
                    
                    optionDiv.appendChild(letterSpan);
                    optionDiv.appendChild(textSpan);
                    gameOptionsElement.appendChild(optionDiv);
                });
            }
        }
        
        function submitGameAnswer() {
            if (userGameAnswer === null) {
                showFunnyTip("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼ğŸ¤”");
                return;
            }
            
            const question = gameQuestions[currentGameQuestion];
            const isCorrect = (userGameAnswer === question.answer);
            
            if (isCorrect) {
                gameScore += 10;
                showFunnyTip("ğŸ‰ é—¯å…³æˆåŠŸï¼+10åˆ†");
            } else {
                const correctAnswer = String.fromCharCode(65 + question.answer);
                showFunnyTip(`ğŸ˜… é—¯å…³å¤±è´¥ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correctAnswer}`);
            }
            
            // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
            updateGameScore();
            
            // ä¸‹ä¸€ä¸ªé—®é¢˜
            currentGameQuestion++;
            userGameAnswer = null;
            
            if (currentGameQuestion < gameQuestions.length) {
                setTimeout(showGameQuestion, 1000);
            } else {
                setTimeout(endGame, 1000);
            }
        }
        
        function updateGameScore() {
            const currentScoreElement = document.getElementById('currentScore');
            if (currentScoreElement) {
                currentScoreElement.textContent = gameScore;
            }
        }
        
        function endGame() {
            gameActive = false;
            
            let message = `ğŸ® å†’é™©ç»“æŸï¼\nä½ çš„æœ€ç»ˆç§¯åˆ†ï¼š${gameScore}/${gameQuestions.length * 10}\n`;
            let title = "å†’é™©ç»“æœ";
            
            if (gameScore === gameQuestions.length * 10) {
                message += "\nğŸ† å¤ªæ£’äº†ï¼ä½ æ˜¯é«˜æ•°ç‹è€…ï¼\næ•°å­¦å¯¹ä½ æ¥è¯´å°±åƒå‘¼å¸ä¸€æ ·è‡ªç„¶ï¼";
                title = "ç‹è€…è£è€€ï¼";
            } else if (gameScore >= gameQuestions.length * 8) {
                message += "\nğŸŒŸ ä¼˜ç§€ï¼ä½ æ˜¯é«˜æ•°å¤§å¸ˆï¼\nç»§ç»­åŠªåŠ›ï¼Œä½ å°±æ˜¯ä¸‹ä¸€ä¸ªæ•°å­¦å¤©æ‰ï¼";
                title = "å¤§å¸ˆé£èŒƒï¼";
            } else if (gameScore >= gameQuestions.length * 6) {
                message += "\nğŸ‘ å¾ˆå¥½ï¼ä½ å¯¹é«˜æ•°æŒæ¡å¾—ä¸é”™ï¼\nå†åŠ æŠŠåŠ²å°±èƒ½æ›´ä¸Šä¸€å±‚æ¥¼ï¼";
                title = "è¿›æ­¥æ˜¾è‘—ï¼";
            } else if (gameScore >= gameQuestions.length * 4) {
                message += "\nğŸ’ª ä¸é”™ï¼åŸºç¡€å·²ç»æ‰“ç‰¢ï¼\nå¤šç»ƒä¹ å‡ æ¬¡ï¼Œä½ ä¸€å®šèƒ½æ›´å¥½ï¼";
                title = "ç»§ç»­åŠ æ²¹ï¼";
            } else {
                message += "\nğŸ“š ç»§ç»­å­¦ä¹ ï¼Œä¸‹æ¬¡ä¸€å®šä¼šæ›´å¥½ï¼\næ¯ä¸ªæ•°å­¦å¤§å¸ˆéƒ½æ›¾æ˜¯åˆå­¦è€…ï¼";
                title = "å­¦ä¹ ä¹‹è·¯";
            }
            
            // ä½¿ç”¨è‡ªå®šä¹‰å¼¹çª—
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10002;
                animation: fadeIn 0.3s ease;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 20px;
                    padding: 40px;
                    max-width: 500px;
                    width: 90%;
                    text-align: center;
                    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
                    animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
                ">
                    <div style="font-size: 2rem; margin-bottom: 20px;">${title}</div>
                    <div style="
                        font-size: 5rem;
                        margin: 20px 0;
                        background: linear-gradient(135deg, var(--primary), var(--fun-purple));
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        font-weight: bold;
                    ">${gameScore}</div>
                    <div style="white-space: pre-line; margin-bottom: 30px; line-height: 1.6;">${message}</div>
                    <button onclick="this.parentNode.parentNode.remove(); startTimer();" style="
                        background: linear-gradient(135deg, var(--primary), var(--fun-purple));
                        color: white;
                        border: none;
                        padding: 15px 40px;
                        border-radius: 10px;
                        font-size: 1.1rem;
                        font-weight: bold;
                        cursor: pointer;
                        transition: all 0.3s;
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        ç»§ç»­æ¢é™©
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // éšè—æ¸¸æˆæ¨¡æ€æ¡†
            const gameModal = document.getElementById('gameModal');
            if (gameModal) {
                gameModal.style.display = 'none';
            }
            
            // éšè—æ¸¸æˆåˆ†æ•°é¢æ¿
            const gameScoreElement = document.getElementById('gameScore');
            if (gameScoreElement) {
                gameScoreElement.style.display = 'none';
            }
        }
        
        function exitGameModal() {
            if (gameActive) {
                if (confirm("ç¡®å®šè¦é€€å‡ºå†’é™©å—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚")) {
                    gameActive = false;
                    const gameModal = document.getElementById('gameModal');
                    if (gameModal) {
                        gameModal.style.display = 'none';
                    }
                    
                    const gameScoreElement = document.getElementById('gameScore');
                    if (gameScoreElement) {
                        gameScoreElement.style.display = 'none';
                    }
                    
                    startTimer();
                }
            } else {
                const gameModal = document.getElementById('gameModal');
                if (gameModal) {
                    gameModal.style.display = 'none';
                }
            }
        }
        
        function exitGame() {
            if (gameActive) {
                if (confirm("ç¡®å®šè¦é€€å‡ºå†’é™©å—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚")) {
                    gameActive = false;
                    
                    const gameScoreElement = document.getElementById('gameScore');
                    if (gameScoreElement) {
                        gameScoreElement.style.display = 'none';
                    }
                    
                    const gameModal = document.getElementById('gameModal');
                    if (gameModal) {
                        gameModal.style.display = 'none';
                    }
                    
                    startTimer();
                }
            }
        }
        
        function continueGame() {
            const gameScoreElement = document.getElementById('gameScore');
            if (gameScoreElement) {
                gameScoreElement.style.display = 'none';
            }
            startGame();
        }
        
        // ==================== å­¦ä¹ èµ„æºåŠŸèƒ½ ====================
        function downloadNotes() {
            showFunnyTip("ğŸ“¥ æ­£åœ¨ç”Ÿæˆç§˜å¢ƒåœ°å›¾PDF...ï¼ˆæ¨¡æ‹Ÿä¸‹è½½ï¼‰");
            setTimeout(() => {
                alert("åœ°å›¾ä¸‹è½½åŠŸèƒ½å³å°†ä¸Šçº¿ï¼ç›®å‰è¯·ä½¿ç”¨æµè§ˆå™¨çš„æ‰“å°åŠŸèƒ½ä¿å­˜é¡µé¢ã€‚\n\nå°è´´å£«ï¼šæŒ‰Ctrl+På¯ä»¥æ‰“å°å½“å‰é¡µé¢ä¸ºPDFï¼");
            }, 1000);
        }
        
        function viewFormulas() {
            const formulas = `
ğŸ¯ é«˜æ•°åå¤§ç§˜å¢ƒé­”æ³•å’’è¯­ï¼ˆå¹½é»˜ç‰ˆï¼‰ï¼š

ç§˜å¢ƒä¸€ï¼šæ˜ å°„ä¸å‡½æ•°ï¼ˆæœ‹å‹åœˆå…³ç³»ç½‘ï¼‰
â€¢ æ˜ å°„å®šä¹‰ï¼šæ¯ä¸ªxåªèƒ½å¯¹åº”ä¸€ä¸ªyï¼ˆä¸èƒ½è„šè¸å¤šæ¡èˆ¹ï¼‰
â€¢ å‡½æ•°å®šä¹‰ï¼šå®šä¹‰åŸŸå’Œå€¼åŸŸéƒ½æ˜¯å®æ•°é›†çš„æ˜ å°„ï¼ˆå®ååˆ¶èŠå¤©ï¼‰
â€¢ é‡è¦å…¬å¼ï¼š$$ f: X \\rightarrow Y, \\quad x \\mapsto y = f(x) $$

ç§˜å¢ƒäºŒï¼šæ•°åˆ—æé™ï¼ˆæ‹çˆ±é•¿è·‘ï¼‰
â€¢ æé™å®šä¹‰ï¼šå½“nâ†’âˆæ—¶ï¼Œaâ‚™æ— é™æ¥è¿‘Aï¼ˆå•æ‹çš„å¿ƒä¸Šäººï¼‰
â€¢ Îµ-Nè¯­è¨€ï¼šæ— è®ºä½ è¦æ±‚å¤šç²¾ç¡®ï¼Œæˆ‘éƒ½èƒ½åœ¨æŸä¸ªæ—¶é—´ä¹‹åæ»¡è¶³
â€¢ é‡è¦å…¬å¼ï¼š$$ \\lim_{n \\to \\infty} a_n = A $$

ç§˜å¢ƒä¸‰ï¼šå‡½æ•°æé™ï¼ˆç²¾å‡†æŠ•å–‚ï¼‰
â€¢ æé™å®šä¹‰ï¼šå½“xâ†’xâ‚€æ—¶ï¼Œf(x)æ— é™æ¥è¿‘Aï¼ˆç„å‡†é¶å¿ƒï¼‰
â€¢ Îµ-Î´è¯­è¨€ï¼šåªè¦xè¶³å¤Ÿæ¥è¿‘xâ‚€ï¼Œf(x)å°±è¶³å¤Ÿæ¥è¿‘A
â€¢ é‡è¦å…¬å¼ï¼š$$ \\lim_{x \\to x_0} f(x) = A $$

ç§˜å¢ƒå››ï¼šæé™å‡†åˆ™ï¼ˆä¸‰æ˜æ²»å®šç†ï¼‰
â€¢ å¤¹é€¼å‡†åˆ™ï¼šfè¢«gå’Œhå¤¹åœ¨ä¸­é—´ï¼Œgå’Œhéƒ½æŒ¤å‘Aï¼Œfä¹Ÿåªèƒ½æŒ¤å‘A
â€¢ é‡è¦å…¬å¼ï¼š$$ g(x) \\le f(x) \\le h(x), \\lim g(x) = \\lim h(x) = A \\Rightarrow \\lim f(x) = A $$

ç§˜å¢ƒäº”ï¼šæé™è¿ç®—ï¼ˆå››åˆ™è¿ç®—å‡çº§ç‰ˆï¼‰
â€¢ åŠ æ³•æ³•åˆ™ï¼šlim(f+g) = lim f + lim g
â€¢ ä¹˜æ³•æ³•åˆ™ï¼šlim(fÂ·g) = lim f Â· lim g
â€¢ é™¤æ³•æ³•åˆ™ï¼šlim(f/g) = lim f / lim gï¼ˆåˆ†æ¯ä¸ä¸º0ï¼‰

ç§˜å¢ƒå…­ï¼šé‡è¦æé™ï¼ˆæ˜æ˜Ÿå…¬å¼ï¼‰
â€¢ æ˜æ˜Ÿ1å·ï¼š$$ \\lim_{x \\to 0} \\frac{\\sin x}{x} = 1 $$
â€¢ æ˜æ˜Ÿ2å·ï¼š$$ \\lim_{x \\to \\infty} \\left(1 + \\frac{1}{x}\\right)^x = e $$

ç§˜å¢ƒä¸ƒï¼šæ— ç©·å°æ¯”è¾ƒï¼ˆè·‘æ­¥æ¯”èµ›ï¼‰
â€¢ é«˜é˜¶æ— ç©·å°ï¼šÎ²è·‘å¾—æ¯”Î±å¿«ï¼ˆlim Î²/Î± = 0ï¼‰
â€¢ ç­‰ä»·æ— ç©·å°ï¼šÎ²å’ŒÎ±å¹¶è‚©è·‘ï¼ˆlim Î²/Î± = 1ï¼‰
â€¢ åŒé˜¶æ— ç©·å°ï¼šÎ²å’ŒÎ±é€Ÿåº¦æˆæ¯”ä¾‹ï¼ˆlim Î²/Î± = c â‰  0ï¼‰

ç§˜å¢ƒå…«ï¼šè¿ç»­æ€§ï¼ˆä¸æ–­çº¿çš„ä¿éšœï¼‰
â€¢ è¿ç»­å®šä¹‰ï¼šæé™å€¼ç­‰äºå‡½æ•°å€¼ï¼ˆä¸€ç¬”ç”»æˆï¼‰
â€¢ é—´æ–­ç‚¹ï¼šå¯å»ï¼ˆèƒ½è¡¥ä¸Šï¼‰ã€è·³è·ƒï¼ˆè·³äº†ä¸€ä¸‹ï¼‰ã€ç¬¬äºŒç±»ï¼ˆæ”¾é£è‡ªæˆ‘ï¼‰

ç§˜å¢ƒä¹ï¼šè¿ç»­è¿ç®—ï¼ˆå®¶æ—é—ä¼ ï¼‰
â€¢ è¿ç»­å‡½æ•°çš„å’Œã€å·®ã€ç§¯ã€å•†ï¼ˆåˆ†æ¯ä¸ä¸º0ï¼‰ä»æ˜¯è¿ç»­å‡½æ•°
â€¢ è¿ç»­å‡½æ•°çš„å¤åˆå‡½æ•°ä»æ˜¯è¿ç»­å‡½æ•°

ç§˜å¢ƒåï¼šé—­åŒºé—´æ€§è´¨ï¼ˆèˆ’é€‚åŒºä¿éšœï¼‰
â€¢ æœ‰ç•Œæ€§ï¼šåœ¨å›´æ å†…ä¸ä¼šæ”¾é£è‡ªæˆ‘
â€¢ æœ€å€¼å®šç†ï¼šä¸€å®šèƒ½æ‰¾åˆ°æœ€é«˜æœ€è‚¥çš„ç¾Š
â€¢ é›¶ç‚¹å®šç†ï¼šä¸€å¤´æ­£ä¸€å¤´è´Ÿï¼Œä¸­é—´å¿…æœ‰ç°ç¾Š

ğŸ’¡ å’’è¯­è®°å¿†æŠ€å·§ï¼šå¤šçœ‹å¤šç©å¤šæ“ä½œï¼Œé­”æ³•è‡ªç„¶å°±è®°ä½ï¼
            `;
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10002;
                animation: fadeIn 0.3s ease;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 20px;
                    padding: 30px;
                    max-width: 600px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
                    animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
                ">
                    <div style="
                        font-size: 1.8rem;
                        color: var(--primary);
                        margin-bottom: 20px;
                        text-align: center;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    ">
                        <i class="fas fa-square-root-alt"></i> é«˜æ•°é­”æ³•å’’è¯­å¤§å…¨
                    </div>
                    <div style="white-space: pre-line; line-height: 1.8; font-family: 'Courier New', monospace;">
                        ${formulas}
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="this.parentNode.parentNode.remove()" style="
                            background: linear-gradient(135deg, var(--primary), var(--fun-purple));
                            color: white;
                            border: none;
                            padding: 12px 30px;
                            border-radius: 10px;
                            font-size: 1rem;
                            font-weight: bold;
                            cursor: pointer;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            å…³é—­
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function showCommonMistakes() {
            const mistakes = `
ğŸ˜… åå¤§ç§˜å¢ƒå¸¸è§é™·é˜±è­¦ç¤ºï¼ˆè¡€æ³ªç»éªŒæ€»ç»“ï¼‰ï¼š

ç§˜å¢ƒä¸€é™·é˜±ï¼šå¿˜è®°æ£€æŸ¥å®šä¹‰åŸŸ
â€¢ âŒ é”™è¯¯ï¼šç›´æ¥è®¡ç®—f(x)=1/(x-3)åœ¨x=3å¤„çš„å€¼
â€¢ âœ… æ­£ç¡®ï¼šå…ˆåˆ¤æ–­xâ‰ 3ï¼Œx=3ä¸åœ¨å®šä¹‰åŸŸå†…

ç§˜å¢ƒäºŒé™·é˜±ï¼šæé™è®¡ç®—é”™è¯¯
â€¢ âŒ é”™è¯¯ï¼šlim(nâ†’âˆ) 1/n = âˆ
â€¢ âœ… æ­£ç¡®ï¼šlim(nâ†’âˆ) 1/n = 0

ç§˜å¢ƒä¸‰é™·é˜±ï¼šé‡è¦æé™è®°é”™
â€¢ âŒ é”™è¯¯ï¼šlim(xâ†’0) sin(x)/x = 0
â€¢ âœ… æ­£ç¡®ï¼šlim(xâ†’0) sin(x)/x = 1ï¼ˆæ˜æ˜Ÿæé™ï¼ï¼‰

ç§˜å¢ƒå››é™·é˜±ï¼šå¤¹é€¼æ¡ä»¶ä¸æ»¡è¶³å°±ä½¿ç”¨
â€¢ âŒ é”™è¯¯ï¼šä¸ç­‰å…³ç³»ä¸æˆç«‹å°±å¤¹é€¼
â€¢ âœ… æ­£ç¡®ï¼šå¿…é¡»ç¡®ä¿g(x)â‰¤f(x)â‰¤h(x)

ç§˜å¢ƒäº”é™·é˜±ï¼šæé™è¿ç®—é¡ºåºé”™è¯¯
â€¢ âŒ é”™è¯¯ï¼šå…ˆæ±‚æé™å†è®¡ç®—
â€¢ âœ… æ­£ç¡®ï¼šå…ˆåŒ–ç®€å†æ±‚æé™

ç§˜å¢ƒå…­é™·é˜±ï¼šeå’Œ1ææ··
â€¢ âŒ é”™è¯¯ï¼šlim(1+1/x)^x = 1
â€¢ âœ… æ­£ç¡®ï¼šlim(1+1/x)^x = e

ç§˜å¢ƒä¸ƒé™·é˜±ï¼šæ— ç©·å°é˜¶åˆ¤æ–­é”™è¯¯
â€¢ âŒ é”™è¯¯ï¼šxÂ²æ˜¯xçš„ä½é˜¶æ— ç©·å°
â€¢ âœ… æ­£ç¡®ï¼šxÂ²æ˜¯xçš„é«˜é˜¶æ— ç©·å°ï¼ˆxâ†’0æ—¶ï¼‰

ç§˜å¢ƒå…«é™·é˜±ï¼šè¿ç»­ä¸å¯å¯¼æ··æ·†
â€¢ âŒ é”™è¯¯ï¼šè¿ç»­ä¸€å®šå¯å¯¼
â€¢ âœ… æ­£ç¡®ï¼šè¿ç»­ä¸ä¸€å®šå¯å¯¼ï¼ˆå¦‚f(x)=|x|åœ¨x=0å¤„ï¼‰

ç§˜å¢ƒä¹é™·é˜±ï¼šé™¤æ³•è¿ç®—å¿½ç•¥åˆ†æ¯
â€¢ âŒ é”™è¯¯ï¼šç›´æ¥è¿›è¡Œé™¤æ³•è¿ç®—
â€¢ âœ… æ­£ç¡®ï¼šå…ˆç¡®ä¿åˆ†æ¯ä¸ä¸ºé›¶

ç§˜å¢ƒåé™·é˜±ï¼šé—­åŒºé—´æ€§è´¨è¯¯ç”¨
â€¢ âŒ é”™è¯¯ï¼šå¼€åŒºé—´ä¸Šä¹Ÿç”¨é›¶ç‚¹å®šç†
â€¢ âœ… æ­£ç¡®ï¼šé›¶ç‚¹å®šç†å¿…é¡»åœ¨é—­åŒºé—´ä¸Š

ğŸ’¡ é¿å‘æŒ‡å—ï¼š
1. å¤šç”»å›¾ï¼šå›¾å½¢æ¯”å…¬å¼æ›´ç›´è§‚
2. å¤šæ£€æŸ¥ï¼šè®¡ç®—åå›å¤´éªŒè¯
3. å¤šç†è§£ï¼šææ‡‚æ¦‚å¿µè€Œä¸æ˜¯æ­»è®°
4. å¤šç»ƒä¹ ï¼šé”™é¢˜æ˜¯æœ€å¥½çš„è€å¸ˆ

è®°ä½ï¼šæ‰å‘ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯åŒä¸€ä¸ªå‘æ‰ä¸¤æ¬¡ï¼ğŸ’ª
            `;
            
            alert(mistakes);
        }
        
        function showExamTips() {
            const tips = `
ğŸ“ åå¤§ç§˜å¢ƒé€šå…³ç§˜ç±ï¼ˆå­¦é•¿å­¦å§çš„è¡€æ³ªç»éªŒï¼‰ï¼š

ğŸ“Š é‡ç‚¹æŒæ¡ï¼ˆé«˜é¢‘è€ƒç‚¹ï¼‰ï¼š
1. ä¸¤ä¸ªé‡è¦æé™åŠå…¶å˜å½¢ï¼ˆå¿…è€ƒï¼ï¼‰
2. Îµ-Î´è¯­è¨€ç†è§£ä¸åº”ç”¨ï¼ˆè¯æ˜é¢˜å¸¸å®¢ï¼‰
3. æ— ç©·å°çš„æ¯”è¾ƒä¸ç­‰ä»·æ›¿æ¢ï¼ˆè®¡ç®—é¢˜å¿…å¤‡ï¼‰
4. è¿ç»­æ€§çš„åˆ¤å®šä¸é—´æ–­ç‚¹åˆ†ç±»ï¼ˆé€‰æ‹©é¢˜æœ€çˆ±ï¼‰
5. é—­åŒºé—´ä¸Šè¿ç»­å‡½æ•°çš„æ€§è´¨ï¼ˆç»¼åˆé¢˜åŸºç¡€ï¼‰

ğŸ’¡ è§£é¢˜æŠ€å·§ï¼ˆè€ƒåœºæ•‘å‘½ï¼‰ï¼š
1. é‡åˆ°å¤æ‚æé™å…ˆå°è¯•ï¼š
   â€¢ å› å¼åˆ†è§£
   â€¢ æœ‰ç†åŒ–
   â€¢ ç­‰ä»·æ— ç©·å°æ›¿æ¢
   â€¢ æ´›å¿…è¾¾æ³•åˆ™ï¼ˆç¬¬äºŒç« å†…å®¹ï¼‰

2. å‡½æ•°æ€§è´¨åˆ¤æ–­é¢˜ï¼š
   â€¢ å…ˆçœ‹å®šä¹‰åŸŸ
   â€¢ å†çœ‹ç‰¹æ®Šç‚¹ï¼ˆç«¯ç‚¹ã€é—´æ–­ç‚¹ï¼‰
   â€¢ æœ€åè€ƒè™‘æ•´ä½“æ€§è´¨

3. è¯æ˜é¢˜å¥—è·¯ï¼š
   â€¢ å¤¹é€¼å‡†åˆ™ï¼šæ‰¾ä¸¤ä¸ªå‡½æ•°"å¤¹ä½"å®ƒ
   â€¢ é›¶ç‚¹å®šç†ï¼šæ‰¾ä¸¤ä¸ªå¼‚å·ç‚¹
   â€¢ å®šä¹‰è¯æ˜ï¼šä¸¥æ ¼æŒ‰ç…§Îµ-Î´è¯­è¨€

â° æ—¶é—´åˆ†é…å»ºè®®ï¼ˆ120åˆ†é’Ÿè€ƒè¯•ï¼‰ï¼š
   â€¢ é€‰æ‹©é¢˜ï¼ˆ40åˆ†ï¼‰ï¼š30-40åˆ†é’Ÿ
   â€¢ å¡«ç©ºé¢˜ï¼ˆ20åˆ†ï¼‰ï¼š15-20åˆ†é’Ÿ  
   â€¢ è®¡ç®—é¢˜ï¼ˆ30åˆ†ï¼‰ï¼š25-30åˆ†é’Ÿ
   â€¢ è¯æ˜é¢˜ï¼ˆ10åˆ†ï¼‰ï¼š15-20åˆ†é’Ÿ
   â€¢ æ£€æŸ¥æ—¶é—´ï¼š10-15åˆ†é’Ÿ

ğŸ“š 21å¤©é€šå…³è®¡åˆ’ï¼š
ç¬¬1-7å¤©ï¼šç§˜å¢ƒæ¢ç´¢ï¼ˆæ¦‚å¿µ+å›¾å½¢æ“ä½œï¼‰
ç¬¬8-14å¤©ï¼šç§˜å¢ƒæŒ‘æˆ˜ï¼ˆç»ƒä¹ +é”™é¢˜åˆ†æï¼‰
ç¬¬15-21å¤©ï¼šç§˜å¢ƒå†²åˆºï¼ˆçœŸé¢˜+æŸ¥æ¼è¡¥ç¼ºï¼‰

ğŸ€ è€ƒåœºå¿ƒæ€è°ƒæ•´ï¼š
1. é‡åˆ°éš¾é¢˜å…ˆè·³è¿‡ï¼Œåšå®Œä¼šçš„å†å›å¤´
2. æ£€æŸ¥æ—¶é‡ç‚¹çœ‹è®¡ç®—æ­¥éª¤ï¼Œé¿å…ç²—å¿ƒ
3. ç›¸ä¿¡è‡ªå·±çš„ç¬¬ä¸€ç›´è§‰ï¼Œä¸è¦è½»æ˜“æ”¹ç­”æ¡ˆ
4. æ·±å‘¼å¸ï¼Œä¿æŒå†·é™ï¼Œä½ å‡†å¤‡å¾—å¾ˆå……åˆ†ï¼

ğŸ¯ æœ€åæé†’ï¼š
â€¢ å¸¦é½è¯ä»¶å’Œæ–‡å…·ï¼ˆé“…ç¬”ã€æ©¡çš®ã€å°ºå­ï¼‰
â€¢ æå‰30åˆ†é’Ÿåˆ°è¾¾è€ƒåœº
â€¢ ä¿æŒè‰¯å¥½çš„ä½œæ¯ï¼ˆè€ƒå‰åˆ«ç†¬å¤œï¼‰
â€¢ è‡ªä¿¡ï¼ä½ å·²ç»æ¢ç´¢å®Œåå¤§ç§˜å¢ƒäº†ï¼

ç¥ä½ è€ƒè¯•é¡ºåˆ©ï¼Œé«˜åˆ†é€šè¿‡ï¼âœ¨
            `;
            
            alert(tips);
        }
        
        function showFunnyMemes() {
            showFunnyTip("ğŸ–¼ï¸ é«˜æ•°è¶£å‘³æ¢—å›¾åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...æ•¬è¯·æœŸå¾…æ›´å¤šæ•°å­¦å¹½é»˜ï¼");
        }
        
        function shareAchievement() {
            const progress = Math.round((learnedSections.size / totalSections) * 100);
            const accuracy = exerciseStats.attempted > 0 ? 
                Math.round((exerciseStats.correct / exerciseStats.attempted) * 100) : 0;
            
            const message = `ğŸ‰ æˆ‘åœ¨é«˜æ•°åå¤§ç§˜å¢ƒæ¢é™©ä¸­å–å¾—äº†ä¸é”™çš„æˆç»©ï¼\n` +
                          `ğŸ—ºï¸ æ¢ç´¢è¿›åº¦ï¼š${progress}%\n` +
                          `âœ… ç§˜å¢ƒé€šå…³ç‡ï¼š${accuracy}%\n` +
                          `â±ï¸ æ¢é™©æ—¶é•¿ï¼š${Math.floor(totalStudyTime/3600)}å°æ—¶\n` +
                          `\nä¸€èµ·åŠ å…¥é«˜æ•°ç§˜å¢ƒæ¢é™©å§ï¼ğŸš€`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'æˆ‘çš„é«˜æ•°ç§˜å¢ƒæ¢é™©æˆå°±',
                    text: message,
                    url: window.location.href
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(message).then(() => {
                    showFunnyTip("ğŸ‰ æ¢é™©æˆå°±å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼å¿«å»åˆ†äº«ç»™æœ‹å‹å§ï¼");
                });
            }
        }
        
        function giveFeedback() {
            const feedback = prompt("è¯·ç•™ä¸‹æ‚¨çš„å®è´µæ„è§æˆ–å»ºè®®ï¼š\nï¼ˆæˆ‘ä»¬ä¼šè®¤çœŸå¬å–å¹¶æ”¹è¿›ç§˜å¢ƒæ¢é™©ä½“éªŒï¼ï¼‰", "");
            if (feedback) {
                showFunnyTip("ğŸ™ æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼æˆ‘ä»¬ä¼šåŠªåŠ›æ”¹è¿›ç§˜å¢ƒæ¢é™©ï¼");
                console.log("ç”¨æˆ·åé¦ˆï¼š", feedback);
            }
        }
        
        // ==================== é¡µé¢åˆå§‹åŒ– ====================
        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            @keyframes slideInRight {
                from { transform: translateX(100px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
        
        // é¡µé¢å¸è½½å‰ä¿å­˜è®°å½•
        window.addEventListener('beforeunload', saveStudyRecords);
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            // Ctrl+S ä¿å­˜è¿›åº¦
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveStudyRecords();
                showFunnyTip("ğŸ’¾ æ¢é™©è¿›åº¦å·²ä¿å­˜ï¼");
            }
            // ESC åœæ­¢æ‰€æœ‰åŠ¨ç”»
            if (e.key === 'Escape') {
                Object.keys(animationIntervals).forEach(key => {
                    stopAnimation(key);
                    updateAnimationButton(key, false);
                });
                showFunnyTip("â¹ï¸ æ‰€æœ‰é­”æ³•åŠ¨ç”»å·²åœæ­¢");
            }
        });
        
        // æ·»åŠ é¡µé¢å¯è§æ€§ç›‘å¬
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                pauseTimer();
            } else {
                startTimer();
            }
        });
    </script>
</body>
</html>